<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <meta name="referrer" content="unsafe-url">
  <title>Современная сборка 2020 для frontend. Gulp4 / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.da6c6b36.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.4de4e95a.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.92df6f6d.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.4de4e95a.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.2822d469ec31a56409ac330bbcf7fcbf.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/484714\/"},"headline":"Современная сборка 2020 для frontend. Gulp4","datePublished":"2020-02-17T05:04:21+03:00","dateModified":"2020-02-25T11:05:28+03:00","author":{"@type":"Person","name":"Денис"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Начало Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разбере...","url":"https:\/\/habr.com\/ru\/post\/484714\/#post-content-body","about":["h_webdev","h_css","h_javascript","h_html5","h_nodejs","f_develop"],"image":["https:\/\/habrastorage.org\/webt\/lj\/g3\/hv\/ljg3hvoy9axohgzzd19rde6ziwo.png","https:\/\/habrastorage.org\/webt\/ia\/ar\/oj\/iaarojs2o_yxufltm0wtwuglmvc.png","https:\/\/habrastorage.org\/webt\/gr\/vw\/jq\/grvwjqqbyh2ntjayjcmo33p4uvm.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/326\/209\/e22\/326209e22685a770c4540a268674fa43.png","https:\/\/habrastorage.org\/webt\/pa\/_j\/g7\/pa_jg7rtrtanxwpv8tvd0s2ftma.jpeg","https:\/\/habrastorage.org\/webt\/sx\/pp\/lz\/sxpplzqdystfm-q9skym2nvr860.jpeg","https:\/\/habrastorage.org\/webt\/jz\/hr\/fh\/jzhrfhh8czcyhetry6o2l9zmale.jpeg","https:\/\/habrastorage.org\/webt\/bu\/uj\/bn\/buujbnhfu4atbiffqueuhj6dfw8.jpeg","https:\/\/habrastorage.org\/webt\/3q\/oc\/pq\/3qocpq4irq54xl73aj-ntmduues.jpeg","https:\/\/habrastorage.org\/webt\/fz\/sc\/vm\/fzscvmvbtb8unlkflcv3dljnsto.jpeg","https:\/\/habrastorage.org\/webt\/7e\/ks\/_i\/7eks_in5xmluxdnr0skrmosk6x0.jpeg","https:\/\/habrastorage.org\/webt\/k1\/u3\/3z\/k1u33z0_89gnnzufrt3djtrfcx0.png","https:\/\/habrastorage.org\/webt\/ld\/58\/yr\/ld58yrcupgcyq7d1wt4rkazzgiu.png","https:\/\/habrastorage.org\/webt\/rq\/7w\/yu\/rq7wyu9-264hjg8vxoqlxoxaz5o.jpeg","https:\/\/habrastorage.org\/webt\/nf\/co\/kw\/nfcokwsfdntczlzy9_ngkebv9_g.png","https:\/\/habrastorage.org\/webt\/l3\/iq\/ss\/l3iqssvcxnlzz9mrezqisvirsxk.png","https:\/\/habrastorage.org\/webt\/sm\/d3\/rd\/smd3rdyqmjbao3xpl9zmy3dkyxo.jpeg","https:\/\/habrastorage.org\/webt\/ql\/gh\/32\/qlgh32ysgiw-v-qi3cwaxoadj60.jpeg","https:\/\/habrastorage.org\/webt\/vs\/mo\/z0\/vsmoz0dz_gy0gxdjrv0enwcjkj0.png","https:\/\/habrastorage.org\/webt\/fm\/yu\/q8\/fmyuq8ggcbkcks5cpc6fhnijupa.png","https:\/\/habrastorage.org\/webt\/rw\/nd\/md\/rwndmdltykxzsgjjg--0dho2moq.png","https:\/\/habrastorage.org\/webt\/wx\/tc\/0o\/wxtc0o201ahjphpgm6osrv_jjos.jpeg","https:\/\/habrastorage.org\/webt\/hw\/mo\/6-\/hwmo6-afrzokestl5bwjdj7jgxw.png","https:\/\/habrastorage.org\/webt\/pt\/6y\/r9\/pt6yr9qvwxwfnqldc8nuv4qogtk.png","https:\/\/habrastorage.org\/webt\/wn\/hi\/mc\/wnhimc3agc9cozu7n54ebiq5-nm.png","https:\/\/habrastorage.org\/webt\/pn\/l5\/mm\/pnl5mmzzrdljesd2hl4-zhpkke4.jpeg","https:\/\/habrastorage.org\/webt\/0_\/3f\/uo\/0_3fuonzaxnhu8fzrdocxxqbrky.png","https:\/\/habrastorage.org\/webt\/kt\/sd\/8j\/ktsd8jvsodx0lo0mowygm6kxmiu.jpeg"]}</script>
  <script src="https://www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.64.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Современная сборка 2020 для frontend. Gulp4" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Современная сборка 2020 для frontend. Gulp4" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Современная сборка 2020 для frontend. Gulp4" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Начало
Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Начало
Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Начало
Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Начало
Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Начало
Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="484714" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2020-02-17T02:04:21.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/post/484714/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="html, gulp, css, javascript, сборка проекта, pug, scss, автоматизация, автоматизация рутины">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/484714/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="index.html.1.169.html" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/484714/bbcd8ab0966cc90efd6414f2dfb7f761/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="https://habr.com/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="https://habr.com/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="https://habr.com/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="https://habr.com/ru/flows/all" class="tm-main-menu__item">
        Все потоки
      </a> <a href="https://habr.com/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="https://habr.com/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="https://habr.com/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="https://habr.com/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="https://habr.com/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="https://habr.com/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="https://habr.com/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/Den-V/" title="Den-V" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.4b679db1.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/Den-V/" class="tm-user-info__username">
      Den-V
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2020-02-17T02:04:21.000Z" title="2020-02-17, 05:04">17  февраля  2020 в 05:04</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Современная сборка 2020 для frontend. Gulp4</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/webdev/" class="tm-article-snippet__hubs-item-link"><span>Разработка веб-сайтов</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/css/" class="tm-article-snippet__hubs-item-link"><span>CSS</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/javascript/" class="tm-article-snippet__hubs-item-link"><span>JavaScript</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/html5/" class="tm-article-snippet__hubs-item-link"><span>HTML</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/nodejs/" class="tm-article-snippet__hubs-item-link"><span>Node.JS</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-tutorial"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><h1 id="nachalo">Начало</h1><br/>
<p>Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины (минимальный набор функционала) и их новые возможности, которые добавились за такое большое время. Мы разберем все моменты, чтобы новичок мог себе скачать эту сборку и начать с ней работать.</p><br/>
<p>Не только древность моей сборки мотивировала на эту статью, но и еще одна причина: мне больно смотреть, когда заходят на онлайн-сервисы для конвертации <code>scss</code>, минификации <code>javascript</code> и других рутинных задач. Самое забавное — когда сделали мелкую правку, снова нужно проходить все круги <del>ада</del> копипаста.</p><br/>
<p>Перед тем, как вы начнете читать, хочу сказать, что материала очень много, поэтому писал только основное. Слишком очевидных вещий старался не писать, но хотел, чтобы смог понять каждый новичок. Если будут непонятные моменты, то смело переходите по ссылкам и читайте более подробную информацию, а потом снова возвращайтесь к статье. Можете задавать вопросы в комментариях, всем постараюсь ответить.</p><a name="habracut"></a><br/>
<h1 id="poehali">Поехали!</h1><br/>
<h2 id="gulp">Gulp</h2><br/>
<p>Начнем с главного в нашей сборке.</p><br/>
<p>Gulp — это наш фундамент, потому что он будет управлять всеми нашими задачами, другими словами, <code>taskmanager</code>. Концепция задач очень проста. Название асинхронной javascript функции равно названию задачи, и работает она по принципу: берет данные, трансформирует их и записывает результат.</p><br/>
<div class="spoiler"><b class="spoiler_title">Пример минификации сss</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/lj/g3/hv/ljg3hvoy9axohgzzd19rde6ziwo.png" data-src="https://habrastorage.org/webt/lj/g3/hv/ljg3hvoy9axohgzzd19rde6ziwo.png"/></p></div></div><br/>
<p>Как видим, все просто: называем нашу задачу <code>css</code>, вызываем функцию <code>src</code>, которая берет данные по определенному шаблону и передает данные по трубе (функция <code>pipe()</code>). Внутри <code>pipe</code> вызываем функцию плагина, которая трансформирует наши данные и результат передает функцию <code>dest</code>. <code>dest</code> — записывает результат по указанному пути.</p><br/>
<p>С <code>pipe</code> можно выстраивать любые цепочки.</p><br/>
<div class="spoiler"><b class="spoiler_title">Пример</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/ia/ar/oj/iaarojs2o_yxufltm0wtwuglmvc.png" data-src="https://habrastorage.org/webt/ia/ar/oj/iaarojs2o_yxufltm0wtwuglmvc.png"/></p></div></div><br/>
<p>В четвертой версии много чего изменилось, но на что нужно точно обратить внимание — это на <code>gulp.series()</code> и <code>gulp.parallel()</code>. Позже мы разберем параллельное выполнение задач.</p><br/>
<p>Как вы заметили, в примерах я экспортировал функции, в старом API использовали <code>gulp.task()</code>:</p><br/>
<pre><code class="javascript">gulp.task('taskName',function() {
    //do somethings
})</code></pre><br/>
<p>Больше не рекомендуется использовать <code>gulp.task()</code>.</p><br/>
<p>Экспортирование функций позволяет разделять на публичные и приватные задачи.</p><br/>
<ul>
<li><code>публичные задачи</code> — экспортируются из вашего gulpfile, что позволяет запускать их командой gulp.</li>
<li><code>приватные задачи</code> — создаются для внутреннего использования, как правило, в составе <code>series()</code> или <code>parallel()</code></li>
</ul><br/>
<p>Пару слов о шаблонах поиска файлов в функции <code>src</code>.</p><br/>
<ul>
<li><code>templates/*.html</code> — ищет файлы с расширением <code>html</code> в папке <code>templates</code></li>
<li><code>templates/**/*.html</code> — ищет файлы с расширением <code>html</code> во всех папках, которые в <code>templates</code></li>
</ul><br/>
<p>Более подробная информация <a href="https://gulpjs.com/docs/en/getting-started/explaining-globs" rel="nofollow">здесь</a>, <a href="https://gulpjs.com/docs/en/api/concepts#globs" rel="nofollow">здесь</a> и <a href="https://github.com/gulpjs/glob-parent" rel="nofollow">здесь</a>.</p><br/>
<h1 id="struktura-proekta">Структура проекта</h1><br/>
<p>После того, как мы разобрались с фундаментом нашего проекта, начнем делать первые шаги. Проверяем, установлены ли <code>node.js</code> и <code>npm</code>.</p><br/>
<div class="spoiler"><b class="spoiler_title">Команды в консоли</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/gr/vw/jq/grvwjqqbyh2ntjayjcmo33p4uvm.png" data-src="https://habrastorage.org/webt/gr/vw/jq/grvwjqqbyh2ntjayjcmo33p4uvm.png"/></p></div></div><br/>
<p>Если они не установлены, следуйте инструкциям <a href="https://nodejs.org/en/" rel="nofollow">здесь</a>.</p><br/>
<p>Создаем папку для нашего проекта. Внутри инициализируем npm <code>npm init --yes</code><br/>
Ключ <code>--yes</code> означает автоматические ответы вопрос по проекту.</p><br/>
<p>Создадим три папки:</p><br/>
<ul>
<li><code>build</code> — оптимизированные файлы для использования на сервере</li>
<li><code>src</code> — рабочая папка, где будут храниться все наши исходники</li>
<li><code>gulp</code> — здесь будут храниться наши tasks</li>
</ul><br/>
<p>Еще добавим файл <code>.gitignore</code>, чтобы системные файлы не попадали в репозиторий.<br/>
Папка <code>/build</code> задокументирована, потому что часто использую <code>GitHub Pages</code> для демонстрации работы.</p><br/>
<p>Не забудьте установить gulp: <code>npm install --save-dev gulp</code></p><br/>
<div class="spoiler"><b class="spoiler_title">.gitignore</b><div class="spoiler_text"><pre><code class="plaintext"># Файлы и папки операционной системы
.DS_Store
Thumbs.db

# Файлы редактора
.idea
*.sublime*
.vscode

# Вспомогательные файлы
*.log*
node_modules/

# Папка с собранными файлами проекта
# build/</code></pre></div></div><br/>
<h1 id="pervye-shagi">Первые шаги</h1><br/>
<h2 id="html">HTML</h2><br/>
<p>У НTML сильно громоздкий синтаксис, и при большой вложенности тегов сложно разобрать код. Еще одна проблема в том, что многие забывают закрывать теги. Можно возразить, что сейчас умные IDE без проблем индицируют эти проблемы, но, как правило, новички не обращают внимания, что там им говорит IDE, и еще грешат форматированием кода.</p><br/>
<div class="spoiler"><b class="spoiler_title">Пример немного не реалистичный, но почти такое делают</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/326/209/e22/326209e22685a770c4540a268674fa43.png" alt="bad format html" data-src="https://habrastorage.org/getpro/habr/post_images/326/209/e22/326209e22685a770c4540a268674fa43.png"/></p></div></div><br/>
<p>Все наши проблемы решает <a href="https://pugjs.org/language/doctype.html" rel="nofollow">Pug</a>. Одного примера будет достаточно, чтобы понять, как его использовать. Не понимаю, почему этот плагин еще повсюду не используют.</p><br/>
<div class="spoiler"><b class="spoiler_title">Пример базового функционала</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/pa/_j/g7/pa_jg7rtrtanxwpv8tvd0s2ftma.jpeg" data-src="https://habrastorage.org/webt/pa/_j/g7/pa_jg7rtrtanxwpv8tvd0s2ftma.jpeg" data-blurred="true"/></p></div></div><br/>
<p>Новичкам советую обратить внимание еще на несколько возможностей:</p><br/>
<ul>
<li><code>Разделение на модули</code> — удобно, когда используешь БЭМ: один блок — один файл. <a href="https://pugjs.org/language/includes.html" rel="nofollow">Подробнее.</a></li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Пример из документации</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/sx/pp/lz/sxpplzqdystfm-q9skym2nvr860.jpeg" data-src="https://habrastorage.org/webt/sx/pp/lz/sxpplzqdystfm-q9skym2nvr860.jpeg" data-blurred="true"/></p></div></div><br/>
<ul>
<li><code>Миксины</code> — удобно использовать для однотипных блоков. Например, карточки товаров или комментариев. <a href="https://pugjs.org/language/mixins.html" rel="nofollow">Подробнее.</a></li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Пример с документации</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/jz/hr/fh/jzhrfhh8czcyhetry6o2l9zmale.jpeg" data-src="https://habrastorage.org/webt/jz/hr/fh/jzhrfhh8czcyhetry6o2l9zmale.jpeg" data-blurred="true"/></p></div></div><br/>
<ul>
<li><code>Циклы</code> для генерации однотипных блоков. <a href="https://pugjs.org/language/iteration.html" rel="nofollow">Подробнее.</a></li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Пример с документации</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/bu/uj/bn/buujbnhfu4atbiffqueuhj6dfw8.jpeg" data-src="https://habrastorage.org/webt/bu/uj/bn/buujbnhfu4atbiffqueuhj6dfw8.jpeg" data-blurred="true"/></p></div></div><br/>
<p>За последнее время сильно ничего не изменилось, только название с <code>Jade</code> на <code>Pug</code>. <a href="https://github.com/pugjs/pug#rename-from-jade" rel="nofollow">Подробнее.</a></p><br/>
<h2 id="razdelyaem-html">Разделяем HTML</h2><br/>
<p>На нашем сайте будут две тестовые страницы <code>about</code> и <code>index</code>. Структура на страницах повторяется: есть блоки <code>&lt;footer></code>, <code>&lt;header></code>, <code>&lt;head></code>. Поэтому все нужно вынести в отдельные <del>файлы</del> модули.</p><br/>
<div class="spoiler"><b class="spoiler_title">Структура проекта</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/3q/oc/pq/3qocpq4irq54xl73aj-ntmduues.jpeg" data-src="https://habrastorage.org/webt/3q/oc/pq/3qocpq4irq54xl73aj-ntmduues.jpeg" data-blurred="true"/></p></div></div><br/>
<p>Разберем все более подробно.</p><br/>
<ul>
<li><code>pages</code> — папка для наших страниц, где в корне хранятся непосредственно страницы</li>
<li><code>common</code> — хранятся общие блоки для всех страниц</li>
<li><code>includes</code> — хранятся модули страниц, где внутри еще одна папка, которая соответствует названию страницы</li>
</ul><br/>
<p>Пройдемся по файлам:</p><br/>
<ul>
<li><code>layout.pug</code> — шаблон, который хранит основную структуру, и от него наследуются все другие страницы</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">layout.pug</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/fz/sc/vm/fzscvmvbtb8unlkflcv3dljnsto.jpeg" data-src="https://habrastorage.org/webt/fz/sc/vm/fzscvmvbtb8unlkflcv3dljnsto.jpeg" data-blurred="true"/></p></div></div><br/>
<ul>
<li><code>index.pug</code> и <code>about.pug</code> — наши страницы, которые наследуются от шаблона и подключают свои контентные модули</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">pages/index.pug и pages/about.pug</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/7e/ks/_i/7eks_in5xmluxdnr0skrmosk6x0.jpeg" data-src="https://habrastorage.org/webt/7e/ks/_i/7eks_in5xmluxdnr0skrmosk6x0.jpeg" data-blurred="true"/></p></div></div><br/>
<p>Еще, обратите внимание, у <code>pug</code> есть комментарии, которые <strong>попадают</strong> в <code>html</code> и которые <strong>нет</strong>. <a href="https://pugjs.org/language/comments.html" rel="nofollow">Подробнее здесь.</a></p><br/>
<h1 id="avtomatiziruem-pervuyu-zadachu">Автоматизируем первую задачу</h1><br/>
<p>Установим плагин <a href="https://www.npmjs.com/package/gulp-pug" rel="nofollow">gulp-pug</a> для компиляции наших шаблонов. Выполните в консоли команду: <code>npm i gulp-pug</code><br/>
Создадим файл <code>pug2html.js</code> в папке <code>gulp/tasks</code>.</p><br/>
<div class="spoiler"><b class="spoiler_title">pug2html.js</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/k1/u3/3z/k1u33z0_89gnnzufrt3djtrfcx0.png" data-src="https://habrastorage.org/webt/k1/u3/3z/k1u33z0_89gnnzufrt3djtrfcx0.png"/></p></div></div><br/>
<p>Здесь все понятно: ищем файлы по указанному пути, компилируем и результат выгружаем в папку <code>build</code>. Еще добавим <a href="https://www.npmjs.com/package/gulp-pug-linter" rel="nofollow">pug-linter</a>, чтобы новички не косячили и сохраняли единый стиль написания кода. Для конфигурации создадим файл <code>.pug-lint.json</code> в корне проекта. Правила для линтера писал на свой вкус. Вы без проблем сможете изменить. <a href="https://github.com/pugjs/pug-lint/blob/master/docs/rules.md" rel="nofollow">Список правил.</a></p><br/>
<p>Теперь подключаем нашу задачу в файле <code>gulpfile.js</code>.</p><br/>
<div class="spoiler"><b class="spoiler_title">gulpfile.js</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/ld/58/yr/ld58yrcupgcyq7d1wt4rkazzgiu.png" data-src="https://habrastorage.org/webt/ld/58/yr/ld58yrcupgcyq7d1wt4rkazzgiu.png"/></p></div></div><br/>
<p>Здесь мы создаем серию с одной таски с названием <code>start</code>; потом мы добавим ещё. Теперь в консоли выполните команду <code>gulp start</code>, и в папке <code>build</code> должны появиться два файла: <code>index.html</code> и <code>about.html</code>.</p><br/>
<p>Еще добавим <a href="https://www.npmjs.com/package/gulp-w3c-html-validator" rel="nofollow">gulp-w3c-html-validator</a>, чтобы не было нелепых ошибок. Вы, наверное, догадались, что порядок подключения плагинов c помощью <code>pipe()</code> очень важен. То есть перед тем, как вызвать плагин <code>pug()</code> для компиляции, нужно сделать валидацию плагином <code>pugLinter()</code>, а плагин <code>gulp-w3c-html-validator</code> подключаем после <code>pug()</code>, потому что нам нужно валидировать скомпилированный <code>html</code>.</p><br/>
<p>Последний плагин <a href="https://www.npmjs.com/package/gulp-html-bem-validator" rel="nofollow">gulp-html-bem-validator</a> — самописный плагин, сделал на скорую руку, потому что не смог найти аналогов. Очень маленький функционал, думаю, со временем буду улучшать.</p><br/>
<div class="spoiler"><b class="spoiler_title">Пример работы плагина</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/rq/7w/yu/rq7wyu9-264hjg8vxoqlxoxaz5o.jpeg" data-src="https://habrastorage.org/webt/rq/7w/yu/rq7wyu9-264hjg8vxoqlxoxaz5o.jpeg" data-blurred="true"/></p></div></div><br/>
<div class="spoiler"><b class="spoiler_title">Финальный код таски pug2html.js</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/nf/co/kw/nfcokwsfdntczlzy9_ngkebv9_g.png" data-src="https://habrastorage.org/webt/nf/co/kw/nfcokwsfdntczlzy9_ngkebv9_g.png"/></p></div></div><br/>
<h1 id="stili">Стили</h1><br/>
<p>Для стилей мы будем использовать <a href="https://sass-lang.com/" rel="nofollow">Scss</a>. Все дается по аналогии с задачей <code>pug2html</code>. Создаем новую папку <code>styles</code> и скачиваем нужные пакеты <code>npm install node-sass gulp-sass --save-dev</code>.<br/>
Дальше пишем задачу, как и делали раньше. Берем файлы, передаем в плагин и потом сохраняем результат.</p><br/>
<div class="spoiler"><b class="spoiler_title">tasks/styles.js</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/l3/iq/ss/l3iqssvcxnlzz9mrezqisvirsxk.png" data-src="https://habrastorage.org/webt/l3/iq/ss/l3iqssvcxnlzz9mrezqisvirsxk.png"/></p></div></div><br/>
<p>Дальше мы добавим вспомогательные плагины: <code>npm i gulp-autoprefixer gulp-shorthand gulp-clean-css gulp-sourcemaps stylelint gulp-stylelint stylelint-scss stylelint-config-standard-scss stylelint-config-standard stylelint-config-htmlacademy</code></p><br/>
<p>Пройдемся по каждому плагину:</p><br/>
<ul>
<li><a href="https://www.npmjs.com/package/gulp-autoprefixer" rel="nofollow">gulp-autoprefixer</a> — автоматическая расстановка префиксов для старых браузеров.</li>
<li><a href="https://www.npmjs.com/package/gulp-shorthand" rel="nofollow">gulp-shorthand</a> — сокращает стили.</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Пример</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/sm/d3/rd/smd3rdyqmjbao3xpl9zmy3dkyxo.jpeg" data-src="https://habrastorage.org/webt/sm/d3/rd/smd3rdyqmjbao3xpl9zmy3dkyxo.jpeg" data-blurred="true"/></p></div></div><br/>
<ul>
<li><a href="https://www.npmjs.com/package/gulp-clean-css" rel="nofollow">gulp-clean-css</a> — минификация стилей</li>
<li><a href="https://www.npmjs.com/package/gulp-sourcemaps" rel="nofollow">gulp-sourcemaps</a> — <a href="https://qna.habr.com/q/284526" rel="nofollow">ответ</a> на вопрос: "Что это такое и зачем нужно?"</li>
<li><a href="https://github.com/stylelint/stylelint" rel="nofollow">stylelint</a> <a href="https://www.npmjs.com/package/gulp-stylelint" rel="nofollow">gulp-stylelint</a> <a href="https://www.npmjs.com/package/stylelint-scss" rel="nofollow">stylelint-scss</a> — плагины для проверки наших стилей</li>
<li><a href="https://github.com/htmlacademy/stylelint-config-htmlacademy" rel="nofollow">stylelint-config-htmlacademy</a> <a href="https://github.com/stylelint/stylelint-config-standard" rel="nofollow">stylelint-config-standard</a> <a href="https://www.npmjs.com/package/stylelint-config-standard-scss" rel="nofollow">stylelint-config-standard-scss</a> — готовые конфиги, которые мы подключили в свой конфиг</li>
</ul><br/>
<p>Файлы styles:</p><br/>
<div class="spoiler"><b class="spoiler_title">Структура папки styles</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/ql/gh/32/qlgh32ysgiw-v-qi3cwaxoadj60.jpeg" data-src="https://habrastorage.org/webt/ql/gh/32/qlgh32ysgiw-v-qi3cwaxoadj60.jpeg" data-blurred="true"/></p></div></div><br/>
<div class="spoiler"><b class="spoiler_title">global.scss</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/vs/mo/z0/vsmoz0dz_gy0gxdjrv0enwcjkj0.png" data-src="https://habrastorage.org/webt/vs/mo/z0/vsmoz0dz_gy0gxdjrv0enwcjkj0.png"/></p></div></div><br/>
<div class="spoiler"><b class="spoiler_title">media.scss</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/fm/yu/q8/fmyuq8ggcbkcks5cpc6fhnijupa.png" data-src="https://habrastorage.org/webt/fm/yu/q8/fmyuq8ggcbkcks5cpc6fhnijupa.png"/></p></div></div><br/>
<p>Немного обсудим файл <code>media.scss</code>. Есть два варианта организации медиа-запросов.</p><br/>
<ol>
<li>Писать медиа-запросы ко всему блоку в конце файла.</li>
<li>Писать медиа-запросы в самом селекторе, используя <code>@mixin</code> и <code>@include</code>.</li>
</ol><br/>
<div class="spoiler"><b class="spoiler_title">Пример второго варианта</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/rw/nd/md/rwndmdltykxzsgjjg--0dho2moq.png" data-src="https://habrastorage.org/webt/rw/nd/md/rwndmdltykxzsgjjg--0dho2moq.png"/></p></div></div><br/>
<p>Я поклонник второго варианта, удобно, когда все стили в одном месте, и не нужно никуда скроллить и ничего искать.</p><br/>
<p>Последний шаг: подключим <a href="http://necolas.github.io/normalize.css/" rel="nofollow">normalize.css</a>. Установим командой <code>npm install normalize.css</code><br/>
и добавим <code>@import "../../../node_modules/normalize.css/normalize";</code> в начале файла <code>global.scss</code><br/>
<a href="https://htmlacademy.ru/blog/useful/css/about-normalize-css" rel="nofollow">Зачем нужен normalize.css?</a></p><br/>
<h1 id="javascript">JavaScript</h1><br/>
<p>Все делаем так же, как и с другими тасками, только подключаем другие плагины.<br/>
Установим сначала все необходимые зависимости <code>npm i gulp-babel @babel/core @babel/preset-env --save-dev</code><br/>
и зависимости для <a href="https://eslint.org/" rel="nofollow">eslint</a> <code>npm install eslint eslint-config-htmlacademy eslint-config-standard eslint-plugin-standard eslint-plugin-promise eslint-plugin-import eslint-plugin-node --save-dev</code></p><br/>
<ul>
<li><a href="https://www.npmjs.com/package/gulp-babel" rel="nofollow">gulp-babel</a> <a href="https://www.npmjs.com/package/@babel/core" rel="nofollow">@babel/core</a> <a href="https://www.npmjs.com/package/@babel/preset-env" rel="nofollow">@babel/preset-env</a> — <a href="https://babeljs.io/" rel="nofollow">babel</a> конвертирует ECMAScript 2015+ код в более старую версию</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Пример</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/wx/tc/0o/wxtc0o201ahjphpgm6osrv_jjos.jpeg" data-src="https://habrastorage.org/webt/wx/tc/0o/wxtc0o201ahjphpgm6osrv_jjos.jpeg" data-blurred="true"/></p></div></div><br/>
<ul>
<li><a href="https://www.npmjs.com/package/gulp-terser" rel="nofollow">gulp-terser</a> — минификация и оптимизация javascript.</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">Задача script</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/hw/mo/6-/hwmo6-afrzokestl5bwjdj7jgxw.png" data-src="https://habrastorage.org/webt/hw/mo/6-/hwmo6-afrzokestl5bwjdj7jgxw.png"/></p></div></div><br/>
<ul>
<li><a href="https://eslint.org/" rel="nofollow">eslint</a> — мы уже знаем, что делают линтеры. Решил подключить готовые конфиги, потому что очень много разных правил, чтобы все настраивать с нуля.</li>
</ul><br/>
<div class="spoiler"><b class="spoiler_title">.eslintrc.json</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/pt/6y/r9/pt6yr9qvwxwfnqldc8nuv4qogtk.png" data-src="https://habrastorage.org/webt/pt/6y/r9/pt6yr9qvwxwfnqldc8nuv4qogtk.png"/></p></div></div><br/>
<h1 id="optimiziruem-kartinki-kopiruem-shrifty-delaem-svg-sprite">Оптимизируем картинки, копируем шрифты, делаем svg-sprite</h1><br/>
<p>Устанавливаем плагины <code>npm i gulp-imageMinify gulp-svgstore</code><br/>
Для картинок используется банальный код, который вы уже на данном этапе без проблем можете понять.</p><br/>
<p>Шрифты мы просто копируем.</p><br/>
<p>Не вижу смысла объяснять, как делать svg спрайты, когда в интернете много статей. <a href="http://glivera-team.github.io/svg/2016/06/13/svg-sprites-2.html" rel="nofollow">Вот одна из них</a>.</p><br/>
<h1 id="ekonomim-vremya">Экономим время</h1><br/>
<p>Чтобы каждый раз не обновлять страницу при изменении файла, подключим <a href="https://www.browsersync.io/" rel="nofollow">browser-sync</a>. У gulp есть встроенная функция, которая следит за изменениями и вызывает нужные нам функции. Советую зайти и почитать о возможностях <a href="https://www.browsersync.io/" rel="nofollow">browsersync</a>. Мне очень нравится возможность открытия сайта и синхронизации прокрутки страницы на нескольких устройствах. Очень удобно верстать адаптивные сайты: открыл на компьютере, открыл на телефоне — и сразу видишь результат.</p><br/>
<div class="spoiler"><b class="spoiler_title">Наш локальный сервер. Задача serve</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/wn/hi/mc/wnhimc3agc9cozu7n54ebiq5-nm.png" data-src="https://habrastorage.org/webt/wn/hi/mc/wnhimc3agc9cozu7n54ebiq5-nm.png"/></p></div></div><br/>
<p>Бывает такое, что сделал опечатку, сохранил код и сборка падает с ошибкой. Нужно снова перезапускать сборку, и со временем это может начать раздражать, поэтому установим <code>npm i gulp-plumber</code>. <a href="https://www.npmjs.com/package/gulp-plumber" rel="nofollow">Plumber</a> будет перехватывать ошибки, и после устранения ошибки сборка восстановит работоспособность. Интегрировать его очень просто, добавляем его первым <code>.pipe(plumber())</code> в наших <del>трубопроводах</del> цепочках <code>pug2html</code> и <code>styles</code>.</p><br/>
<p>Во время разработки мы будем создавать и удалять файлы. Так как у нас <code>live reload</code>, то созданные файлы автоматически попадут в <code>build</code>. Когда чуть позже мы решим удалить файл, то он останется в папке <code>build</code>, поэтому сделаем еще одну задачу <code>clean</code>, которая будет удалять папку. Установим плагин <code>npm install del</code>. <a href="https://www.npmjs.com/package/del" rel="nofollow">Del</a>.</p><br/>
<pre><code class="javascript">const del = require('del')

module.exports = function clean() {
  return del('build')
}</code></pre><br/>
<p><strong>Главное — не забыть вызвать функцию-callback, которая сообщит gulp, что задача выполнена.</strong></p><br/>
<h3 id="lighthouse">Lighthouse</h3><br/>
<blockquote><a href="https://github.com/GoogleChrome/lighthouse" rel="nofollow">Lighthouse</a> — решение для веб-приложений и веб-страниц, которое собирает современные показатели производительности.</blockquote><p>Кстати, некоторые заказчики смотрят на эти показатели, так как не знают других способов оценить качество верстки.</p><br/>
<p>Вы можете возразить, зачем ради одной странички заморачиваться, но в реальных проектах их может быть больше 10.</p><br/>
<div class="spoiler"><b class="spoiler_title">Скрин с реального проекта</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/pn/l5/mm/pnl5mmzzrdljesd2hl4-zhpkke4.jpeg" data-src="https://habrastorage.org/webt/pn/l5/mm/pnl5mmzzrdljesd2hl4-zhpkke4.jpeg" data-blurred="true"/></p></div></div><br/>
<p>Устанавливаем <code>npm i --save-dev gulp-connect lighthouse chrome-launcher</code> и создаём задачу.<br/>
Результат для каждой странички будет генерироваться в папку <code>./reports</code>. Там будут 'html' файлы, они открываются автоматически, но вы сами в любой момент можете их открыть и посмотреть результат.</p><br/>
<p>На первый взгляд может показаться, что лучше запустить несколько страниц на тестирование, но этого нельзя сделать в одном запущенном процессе хрома, а если запустить несколько процессов паралельно, то результаты могут быть очень неточные.</p><br/>
<div class="spoiler"><b class="spoiler_title">lighthouse.js</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w1560/webt/0_/3f/uo/0_3fuonzaxnhu8fzrdocxxqbrky.png" data-src="https://habrastorage.org/webt/0_/3f/uo/0_3fuonzaxnhu8fzrdocxxqbrky.png"/></p></div></div><br/>
<p>Кода многовато, но он простой. Запустили наш локальный сервер с помощью <code>browser-sync</code>, потом хром и в конце <code>lighthouse</code>, где говорим, по какому <code>url</code> искать наш сайт.</p><br/>
<h1 id="kopiruem-zavisimosti">Копируем зависимости</h1><br/>
<p>В нашей команде есть правило, что все <code>dependencies</code> нужно загружать в репозиторий. Это было связано с тем, что иногда может пропасть интернет <del>в стране</del>. Вручную скачивать пакеты с сайтов и загружать их в папку не очень удобно, ещё сложно следить за версиями пакетов, и каждый раз из node_modules обновлять также не очень удобно, поэтому мы должны оптимизировать этот процесс.</p><br/>
<p><a href="https://www.npmjs.com/package/gulp-npm-dist" rel="nofollow">gulp-npm-dist</a> — очень хороший плагин, мне он нравится тем, что он не просто копирует всю папку модуля, а только нужные файлы. <code>README.md</code>, <code>LICENSE</code>, <code>.gitignore</code> и другие конфигурационные файлы не копируются.</p><br/>
<p>Теперь сделаем, чтобы при изменении <code>package.json</code> вызывался плагин. Не вижу смысла сильно заморачиваться и следить только за изменениями объекта <code>dependencies</code>, поэтому будем просто следить за файлом.</p><br/>
<h1 id="npm-skripty">NPM-скрипты</h1><br/>
<p>Последняя оптимизация. Часто сложно и лень запоминать консольные команды, там много параметров, вводить все эти пути занимает время,<br/>
поэтому запишем длинные команды в более краткие команды.</p><br/>
<p>Рассмотрим такую ситуацию: вы скопировали большой кусок кода с постороннего ресурса, и<br/>
он не соответствует вашим правилам форматирования.<br/>
Не будете же вы всё править руками? Можно просто в консоли ввести команду, которая все исправит<br/>
за вас <code>stylelint ./src/styles/**/*.scss --fix --syntax scss</code>, команда длинная, поэтому запишем ее в NPM-скрипт</p><br/>
<div class="spoiler"><b class="spoiler_title">Добавили NPM-скрипт</b><div class="spoiler_text"><p><img src="https://habrastorage.org/r/w780q1/webt/kt/sd/8j/ktsd8jvsodx0lo0mowygm6kxmiu.jpeg" data-src="https://habrastorage.org/webt/kt/sd/8j/ktsd8jvsodx0lo0mowygm6kxmiu.jpeg" data-blurred="true"/></p></div></div><br/>
<p>Как видим на скрине, теперь в консоли можно вводить <code>npm run stylelint-fix</code>.</p><br/>
<p>Напишем еще несколько команд:</p><br/>
<ul>
<li><code>npm run start</code> — вместо <code>gulp</code>, привык, что любой проект у меня запускается этой командой</li>
<li><code>npm run build</code> — вместо <code>gulp build</code>, такая же ситуация, как в прошлом пункте</li>
<li><code>npm run lighthouse</code> — вместо <code>gulp build &amp;&amp; gulp lighthouse</code>, сначала собираем проект, а потом уже тестируем</li>
<li><code>npm run test</code> — запуск разных линтеров, хорошей практикой будет запускать перед комитом</li>
</ul><br/>
<h1 id="pre-commit">PRE-COMMIT</h1><br/>
<p>Не верю я, что вы будете перед комитом запускать <code>npm run test</code>, даже не верю, что я буду. Поэтому скачаем <a href="https://www.npmjs.com/package/husky" rel="nofollow">husky</a> и добавим: </p><br/>
<pre><code class="javascript">"husky": {
    "hooks": {
      "pre-commit": "npm run test"
    }
  }</code></pre><br/>
<p>в <code>package.json</code>. Если <code>npm run test</code> вернет ошибку, то комит не будет сделан.</p><br/>
<h1 id="spasibo">Спасибо</h1><br/>
<p>Очень приятно, если вы прочли всю статью и сумели принять мои мысли. Отвечу на вопросы в комментариях и жду ваших <code>pull requests</code> и <code>issue</code>. Всем приятных сборок.</p><br/>
<p>Ссылка на репозиторий с тем, что у нас получилось: <a href="https://github.com/dDenysS/gulp-template" rel="nofollow">github</a>.</p></div></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bhtml%5D" class="tm-tags-list__link">html</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bgulp%5D" class="tm-tags-list__link">gulp</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcss%5D" class="tm-tags-list__link">css</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjavascript%5D" class="tm-tags-list__link">javascript</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B0%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0%5D" class="tm-tags-list__link">сборка проекта</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpug%5D" class="tm-tags-list__link">pug</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bscss%5D" class="tm-tags-list__link">scss</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%5D" class="tm-tags-list__link">автоматизация</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D1%80%D1%83%D1%82%D0%B8%D0%BD%D1%8B%5D" class="tm-tags-list__link">автоматизация рутины</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/webdev/" class="tm-hubs-list__link">
    Разработка веб-сайтов
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/css/" class="tm-hubs-list__link">
    CSS
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/javascript/" class="tm-hubs-list__link">
    JavaScript
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/html5/" class="tm-hubs-list__link">
    HTML
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/nodejs/" class="tm-hubs-list__link">
    Node.JS
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 16: ↑14 и ↓2</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-rating"></use></svg> <span title="Всего голосов 16: ↑14 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+12</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">81K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    236
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <DIV class="v-portal" style="display:none;"></DIV> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="https://habr.com/ru/users/Den-V/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_lilac"><!----> <use xlink:href="/img/megazord-v25.4b679db1.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 11 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    9
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Денис</span> <a href="https://habr.com/ru/users/Den-V/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @Den-V
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Web-developer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="https://habr.com/ru/post/484714/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 31 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner1494" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner1495" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section data-async-called="true" class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Работа</h2> <!----></header> <div class="tm-block__body"><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/programmist_javascript" target="_blank" class="tm-vacancies-block__vacancy-title">
        JavaScript разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        554
    вакансии
      </div></div><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/react_razrabotchik" target="_blank" class="tm-vacancies-block__vacancy-title">
        React разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        276
    вакансий
      </div></div><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/nodejs_razrabotchik" target="_blank" class="tm-vacancies-block__vacancy-title">
        Node.js разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        185
    вакансий
      </div></div></div> <footer class="tm-block__footer"><a href="https://career.habr.com/catalog" class="tm-block-extralink">
      Все вакансии
    </a></footer></section></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/post/484714/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr-register/?back=/ru/post/484714/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="https://habr.com/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="https://habr.com/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="https://habr.com/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2022 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"484714":{"id":"484714","timePublished":"2020-02-17T02:04:21+00:00","isCorporative":false,"lang":"ru","titleHtml":"Современная сборка 2020 для frontend. Gulp4","leadData":{"textHtml":"\u003Ch1 id=\"nachalo\"\u003EНачало\u003C\u002Fh1\u003E\u003Cbr\u003E\r\n\u003Cp\u003EПосмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины (минимальный набор функционала) и их новые возможности, которые добавились за такое большое время. Мы разберем все моменты, чтобы новичок мог себе скачать эту сборку и начать с ней работать.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EНе только древность моей сборки мотивировала на эту статью, но и еще одна причина: мне больно смотреть, когда заходят на онлайн-сервисы для конвертации \u003Ccode\u003Escss\u003C\u002Fcode\u003E, минификации \u003Ccode\u003Ejavascript\u003C\u002Fcode\u003E и других рутинных задач. Самое забавное — когда сделали мелкую правку, снова нужно проходить все круги \u003Cdel\u003Eада\u003C\u002Fdel\u003E копипаста.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EПеред тем, как вы начнете читать, хочу сказать, что материала очень много, поэтому писал только основное. Слишком очевидных вещий старался не писать, но хотел, чтобы смог понять каждый новичок. Если будут непонятные моменты, то смело переходите по ссылкам и читайте более подробную информацию, а потом снова возвращайтесь к статье. Можете задавать вопросы в комментариях, всем постараюсь ответить.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":9,"votesCount":11},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1393046","alias":"Den-V","fullname":"Денис","avatarUrl":null,"speciality":"Web-developer"},"statistics":{"commentsCount":31,"favoritesCount":236,"readingCount":81057,"score":12,"votesCount":16},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"307","alias":"css","type":"collective","title":"CSS","titleHtml":"CSS","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"17103","alias":"html5","type":"collective","title":"HTML","titleHtml":"HTML","isProfiled":true},{"relatedData":null,"id":"17110","alias":"nodejs","type":"collective","title":"Node.JS","titleHtml":"Node.JS","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ch1 id=\"nachalo\"\u003EНачало\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПосмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины (минимальный набор функционала) и их новые возможности, которые добавились за такое большое время. Мы разберем все моменты, чтобы новичок мог себе скачать эту сборку и начать с ней работать.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНе только древность моей сборки мотивировала на эту статью, но и еще одна причина: мне больно смотреть, когда заходят на онлайн-сервисы для конвертации \u003Ccode\u003Escss\u003C\u002Fcode\u003E, минификации \u003Ccode\u003Ejavascript\u003C\u002Fcode\u003E и других рутинных задач. Самое забавное — когда сделали мелкую правку, снова нужно проходить все круги \u003Cdel\u003Eада\u003C\u002Fdel\u003E копипаста.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПеред тем, как вы начнете читать, хочу сказать, что материала очень много, поэтому писал только основное. Слишком очевидных вещий старался не писать, но хотел, чтобы смог понять каждый новичок. Если будут непонятные моменты, то смело переходите по ссылкам и читайте более подробную информацию, а потом снова возвращайтесь к статье. Можете задавать вопросы в комментариях, всем постараюсь ответить.\u003C\u002Fp\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"poehali\"\u003EПоехали!\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"gulp\"\u003EGulp\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНачнем с главного в нашей сборке.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EGulp — это наш фундамент, потому что он будет управлять всеми нашими задачами, другими словами, \u003Ccode\u003Etaskmanager\u003C\u002Fcode\u003E. Концепция задач очень проста. Название асинхронной javascript функции равно названию задачи, и работает она по принципу: берет данные, трансформирует их и записывает результат.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример минификации сss\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Flj\u002Fg3\u002Fhv\u002Fljg3hvoy9axohgzzd19rde6ziwo.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Flj\u002Fg3\u002Fhv\u002Fljg3hvoy9axohgzzd19rde6ziwo.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак видим, все просто: называем нашу задачу \u003Ccode\u003Ecss\u003C\u002Fcode\u003E, вызываем функцию \u003Ccode\u003Esrc\u003C\u002Fcode\u003E, которая берет данные по определенному шаблону и передает данные по трубе (функция \u003Ccode\u003Epipe()\u003C\u002Fcode\u003E). Внутри \u003Ccode\u003Epipe\u003C\u002Fcode\u003E вызываем функцию плагина, которая трансформирует наши данные и результат передает функцию \u003Ccode\u003Edest\u003C\u002Fcode\u003E. \u003Ccode\u003Edest\u003C\u002Fcode\u003E — записывает результат по указанному пути.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EС \u003Ccode\u003Epipe\u003C\u002Fcode\u003E можно выстраивать любые цепочки.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fia\u002Far\u002Foj\u002Fiaarojs2o_yxufltm0wtwuglmvc.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fia\u002Far\u002Foj\u002Fiaarojs2o_yxufltm0wtwuglmvc.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ четвертой версии много чего изменилось, но на что нужно точно обратить внимание — это на \u003Ccode\u003Egulp.series()\u003C\u002Fcode\u003E и \u003Ccode\u003Egulp.parallel()\u003C\u002Fcode\u003E. Позже мы разберем параллельное выполнение задач.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак вы заметили, в примерах я экспортировал функции, в старом API использовали \u003Ccode\u003Egulp.task()\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Egulp.task('taskName',function() {\n    \u002F\u002Fdo somethings\n})\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EБольше не рекомендуется использовать \u003Ccode\u003Egulp.task()\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭкспортирование функций позволяет разделять на публичные и приватные задачи.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Eпубличные задачи\u003C\u002Fcode\u003E — экспортируются из вашего gulpfile, что позволяет запускать их командой gulp.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Eприватные задачи\u003C\u002Fcode\u003E — создаются для внутреннего использования, как правило, в составе \u003Ccode\u003Eseries()\u003C\u002Fcode\u003E или \u003Ccode\u003Eparallel()\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПару слов о шаблонах поиска файлов в функции \u003Ccode\u003Esrc\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Etemplates\u002F*.html\u003C\u002Fcode\u003E — ищет файлы с расширением \u003Ccode\u003Ehtml\u003C\u002Fcode\u003E в папке \u003Ccode\u003Etemplates\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Etemplates\u002F**\u002F*.html\u003C\u002Fcode\u003E — ищет файлы с расширением \u003Ccode\u003Ehtml\u003C\u002Fcode\u003E во всех папках, которые в \u003Ccode\u003Etemplates\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EБолее подробная информация \u003Ca href=\"https:\u002F\u002Fgulpjs.com\u002Fdocs\u002Fen\u002Fgetting-started\u002Fexplaining-globs\" rel=\"nofollow\"\u003Eздесь\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgulpjs.com\u002Fdocs\u002Fen\u002Fapi\u002Fconcepts#globs\" rel=\"nofollow\"\u003Eздесь\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgulpjs\u002Fglob-parent\" rel=\"nofollow\"\u003Eздесь\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"struktura-proekta\"\u003EСтруктура проекта\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПосле того, как мы разобрались с фундаментом нашего проекта, начнем делать первые шаги. Проверяем, установлены ли \u003Ccode\u003Enode.js\u003C\u002Fcode\u003E и \u003Ccode\u003Enpm\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EКоманды в консоли\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fgr\u002Fvw\u002Fjq\u002Fgrvwjqqbyh2ntjayjcmo33p4uvm.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgr\u002Fvw\u002Fjq\u002Fgrvwjqqbyh2ntjayjcmo33p4uvm.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли они не установлены, следуйте инструкциям \u003Ca href=\"https:\u002F\u002Fnodejs.org\u002Fen\u002F\" rel=\"nofollow\"\u003Eздесь\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздаем папку для нашего проекта. Внутри инициализируем npm \u003Ccode\u003Enpm init --yes\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nКлюч \u003Ccode\u003E--yes\u003C\u002Fcode\u003E означает автоматические ответы вопрос по проекту.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим три папки:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Ebuild\u003C\u002Fcode\u003E — оптимизированные файлы для использования на сервере\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Esrc\u003C\u002Fcode\u003E — рабочая папка, где будут храниться все наши исходники\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Egulp\u003C\u002Fcode\u003E — здесь будут храниться наши tasks\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕще добавим файл \u003Ccode\u003E.gitignore\u003C\u002Fcode\u003E, чтобы системные файлы не попадали в репозиторий.\u003Cbr\u002F\u003E\r\nПапка \u003Ccode\u003E\u002Fbuild\u003C\u002Fcode\u003E задокументирована, потому что часто использую \u003Ccode\u003EGitHub Pages\u003C\u002Fcode\u003E для демонстрации работы.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНе забудьте установить gulp: \u003Ccode\u003Enpm install --save-dev gulp\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003E.gitignore\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003E# Файлы и папки операционной системы\n.DS_Store\nThumbs.db\n\n# Файлы редактора\n.idea\n*.sublime*\n.vscode\n\n# Вспомогательные файлы\n*.log*\nnode_modules\u002F\n\n# Папка с собранными файлами проекта\n# build\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"pervye-shagi\"\u003EПервые шаги\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"html\"\u003EHTML\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУ НTML сильно громоздкий синтаксис, и при большой вложенности тегов сложно разобрать код. Еще одна проблема в том, что многие забывают закрывать теги. Можно возразить, что сейчас умные IDE без проблем индицируют эти проблемы, но, как правило, новички не обращают внимания, что там им говорит IDE, и еще грешат форматированием кода.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример немного не реалистичный, но почти такое делают\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F326\u002F209\u002Fe22\u002F326209e22685a770c4540a268674fa43.png\" alt=\"bad format html\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F326\u002F209\u002Fe22\u002F326209e22685a770c4540a268674fa43.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВсе наши проблемы решает \u003Ca href=\"https:\u002F\u002Fpugjs.org\u002Flanguage\u002Fdoctype.html\" rel=\"nofollow\"\u003EPug\u003C\u002Fa\u003E. Одного примера будет достаточно, чтобы понять, как его использовать. Не понимаю, почему этот плагин еще повсюду не используют.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример базового функционала\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fpa\u002F_j\u002Fg7\u002Fpa_jg7rtrtanxwpv8tvd0s2ftma.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpa\u002F_j\u002Fg7\u002Fpa_jg7rtrtanxwpv8tvd0s2ftma.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНовичкам советую обратить внимание еще на несколько возможностей:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003EРазделение на модули\u003C\u002Fcode\u003E — удобно, когда используешь БЭМ: один блок — один файл. \u003Ca href=\"https:\u002F\u002Fpugjs.org\u002Flanguage\u002Fincludes.html\" rel=\"nofollow\"\u003EПодробнее.\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример из документации\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fsx\u002Fpp\u002Flz\u002Fsxpplzqdystfm-q9skym2nvr860.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsx\u002Fpp\u002Flz\u002Fsxpplzqdystfm-q9skym2nvr860.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003EМиксины\u003C\u002Fcode\u003E — удобно использовать для однотипных блоков. Например, карточки товаров или комментариев. \u003Ca href=\"https:\u002F\u002Fpugjs.org\u002Flanguage\u002Fmixins.html\" rel=\"nofollow\"\u003EПодробнее.\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример с документации\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fjz\u002Fhr\u002Ffh\u002Fjzhrfhh8czcyhetry6o2l9zmale.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fjz\u002Fhr\u002Ffh\u002Fjzhrfhh8czcyhetry6o2l9zmale.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003EЦиклы\u003C\u002Fcode\u003E для генерации однотипных блоков. \u003Ca href=\"https:\u002F\u002Fpugjs.org\u002Flanguage\u002Fiteration.html\" rel=\"nofollow\"\u003EПодробнее.\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример с документации\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fbu\u002Fuj\u002Fbn\u002Fbuujbnhfu4atbiffqueuhj6dfw8.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbu\u002Fuj\u002Fbn\u002Fbuujbnhfu4atbiffqueuhj6dfw8.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЗа последнее время сильно ничего не изменилось, только название с \u003Ccode\u003EJade\u003C\u002Fcode\u003E на \u003Ccode\u003EPug\u003C\u002Fcode\u003E. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fpugjs\u002Fpug#rename-from-jade\" rel=\"nofollow\"\u003EПодробнее.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"razdelyaem-html\"\u003EРазделяем HTML\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНа нашем сайте будут две тестовые страницы \u003Ccode\u003Eabout\u003C\u002Fcode\u003E и \u003Ccode\u003Eindex\u003C\u002Fcode\u003E. Структура на страницах повторяется: есть блоки \u003Ccode\u003E&lt;footer\u003E\u003C\u002Fcode\u003E, \u003Ccode\u003E&lt;header\u003E\u003C\u002Fcode\u003E, \u003Ccode\u003E&lt;head\u003E\u003C\u002Fcode\u003E. Поэтому все нужно вынести в отдельные \u003Cdel\u003Eфайлы\u003C\u002Fdel\u003E модули.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EСтруктура проекта\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F3q\u002Foc\u002Fpq\u002F3qocpq4irq54xl73aj-ntmduues.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F3q\u002Foc\u002Fpq\u002F3qocpq4irq54xl73aj-ntmduues.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EРазберем все более подробно.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Epages\u003C\u002Fcode\u003E — папка для наших страниц, где в корне хранятся непосредственно страницы\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Ecommon\u003C\u002Fcode\u003E — хранятся общие блоки для всех страниц\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Eincludes\u003C\u002Fcode\u003E — хранятся модули страниц, где внутри еще одна папка, которая соответствует названию страницы\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПройдемся по файлам:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Elayout.pug\u003C\u002Fcode\u003E — шаблон, который хранит основную структуру, и от него наследуются все другие страницы\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Elayout.pug\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Ffz\u002Fsc\u002Fvm\u002Ffzscvmvbtb8unlkflcv3dljnsto.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ffz\u002Fsc\u002Fvm\u002Ffzscvmvbtb8unlkflcv3dljnsto.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Eindex.pug\u003C\u002Fcode\u003E и \u003Ccode\u003Eabout.pug\u003C\u002Fcode\u003E — наши страницы, которые наследуются от шаблона и подключают свои контентные модули\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epages\u002Findex.pug и pages\u002Fabout.pug\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F7e\u002Fks\u002F_i\u002F7eks_in5xmluxdnr0skrmosk6x0.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F7e\u002Fks\u002F_i\u002F7eks_in5xmluxdnr0skrmosk6x0.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕще, обратите внимание, у \u003Ccode\u003Epug\u003C\u002Fcode\u003E есть комментарии, которые \u003Cstrong\u003Eпопадают\u003C\u002Fstrong\u003E в \u003Ccode\u003Ehtml\u003C\u002Fcode\u003E и которые \u003Cstrong\u003Eнет\u003C\u002Fstrong\u003E. \u003Ca href=\"https:\u002F\u002Fpugjs.org\u002Flanguage\u002Fcomments.html\" rel=\"nofollow\"\u003EПодробнее здесь.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"avtomatiziruem-pervuyu-zadachu\"\u003EАвтоматизируем первую задачу\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУстановим плагин \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-pug\" rel=\"nofollow\"\u003Egulp-pug\u003C\u002Fa\u003E для компиляции наших шаблонов. Выполните в консоли команду: \u003Ccode\u003Enpm i gulp-pug\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nСоздадим файл \u003Ccode\u003Epug2html.js\u003C\u002Fcode\u003E в папке \u003Ccode\u003Egulp\u002Ftasks\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Epug2html.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fk1\u002Fu3\u002F3z\u002Fk1u33z0_89gnnzufrt3djtrfcx0.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk1\u002Fu3\u002F3z\u002Fk1u33z0_89gnnzufrt3djtrfcx0.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЗдесь все понятно: ищем файлы по указанному пути, компилируем и результат выгружаем в папку \u003Ccode\u003Ebuild\u003C\u002Fcode\u003E. Еще добавим \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-pug-linter\" rel=\"nofollow\"\u003Epug-linter\u003C\u002Fa\u003E, чтобы новички не косячили и сохраняли единый стиль написания кода. Для конфигурации создадим файл \u003Ccode\u003E.pug-lint.json\u003C\u002Fcode\u003E в корне проекта. Правила для линтера писал на свой вкус. Вы без проблем сможете изменить. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fpugjs\u002Fpug-lint\u002Fblob\u002Fmaster\u002Fdocs\u002Frules.md\" rel=\"nofollow\"\u003EСписок правил.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь подключаем нашу задачу в файле \u003Ccode\u003Egulpfile.js\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Egulpfile.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fld\u002F58\u002Fyr\u002Fld58yrcupgcyq7d1wt4rkazzgiu.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fld\u002F58\u002Fyr\u002Fld58yrcupgcyq7d1wt4rkazzgiu.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЗдесь мы создаем серию с одной таски с названием \u003Ccode\u003Estart\u003C\u002Fcode\u003E; потом мы добавим ещё. Теперь в консоли выполните команду \u003Ccode\u003Egulp start\u003C\u002Fcode\u003E, и в папке \u003Ccode\u003Ebuild\u003C\u002Fcode\u003E должны появиться два файла: \u003Ccode\u003Eindex.html\u003C\u002Fcode\u003E и \u003Ccode\u003Eabout.html\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕще добавим \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-w3c-html-validator\" rel=\"nofollow\"\u003Egulp-w3c-html-validator\u003C\u002Fa\u003E, чтобы не было нелепых ошибок. Вы, наверное, догадались, что порядок подключения плагинов c помощью \u003Ccode\u003Epipe()\u003C\u002Fcode\u003E очень важен. То есть перед тем, как вызвать плагин \u003Ccode\u003Epug()\u003C\u002Fcode\u003E для компиляции, нужно сделать валидацию плагином \u003Ccode\u003EpugLinter()\u003C\u002Fcode\u003E, а плагин \u003Ccode\u003Egulp-w3c-html-validator\u003C\u002Fcode\u003E подключаем после \u003Ccode\u003Epug()\u003C\u002Fcode\u003E, потому что нам нужно валидировать скомпилированный \u003Ccode\u003Ehtml\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоследний плагин \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-html-bem-validator\" rel=\"nofollow\"\u003Egulp-html-bem-validator\u003C\u002Fa\u003E — самописный плагин, сделал на скорую руку, потому что не смог найти аналогов. Очень маленький функционал, думаю, со временем буду улучшать.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример работы плагина\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Frq\u002F7w\u002Fyu\u002Frq7wyu9-264hjg8vxoqlxoxaz5o.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Frq\u002F7w\u002Fyu\u002Frq7wyu9-264hjg8vxoqlxoxaz5o.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EФинальный код таски pug2html.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fnf\u002Fco\u002Fkw\u002Fnfcokwsfdntczlzy9_ngkebv9_g.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fnf\u002Fco\u002Fkw\u002Fnfcokwsfdntczlzy9_ngkebv9_g.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"stili\"\u003EСтили\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля стилей мы будем использовать \u003Ca href=\"https:\u002F\u002Fsass-lang.com\u002F\" rel=\"nofollow\"\u003EScss\u003C\u002Fa\u003E. Все дается по аналогии с задачей \u003Ccode\u003Epug2html\u003C\u002Fcode\u003E. Создаем новую папку \u003Ccode\u003Estyles\u003C\u002Fcode\u003E и скачиваем нужные пакеты \u003Ccode\u003Enpm install node-sass gulp-sass --save-dev\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\nДальше пишем задачу, как и делали раньше. Берем файлы, передаем в плагин и потом сохраняем результат.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Etasks\u002Fstyles.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fl3\u002Fiq\u002Fss\u002Fl3iqssvcxnlzz9mrezqisvirsxk.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fl3\u002Fiq\u002Fss\u002Fl3iqssvcxnlzz9mrezqisvirsxk.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДальше мы добавим вспомогательные плагины: \u003Ccode\u003Enpm i gulp-autoprefixer gulp-shorthand gulp-clean-css gulp-sourcemaps stylelint gulp-stylelint stylelint-scss stylelint-config-standard-scss stylelint-config-standard stylelint-config-htmlacademy\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПройдемся по каждому плагину:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-autoprefixer\" rel=\"nofollow\"\u003Egulp-autoprefixer\u003C\u002Fa\u003E — автоматическая расстановка префиксов для старых браузеров.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-shorthand\" rel=\"nofollow\"\u003Egulp-shorthand\u003C\u002Fa\u003E — сокращает стили.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fsm\u002Fd3\u002Frd\u002Fsmd3rdyqmjbao3xpl9zmy3dkyxo.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsm\u002Fd3\u002Frd\u002Fsmd3rdyqmjbao3xpl9zmy3dkyxo.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-clean-css\" rel=\"nofollow\"\u003Egulp-clean-css\u003C\u002Fa\u003E — минификация стилей\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-sourcemaps\" rel=\"nofollow\"\u003Egulp-sourcemaps\u003C\u002Fa\u003E — \u003Ca href=\"https:\u002F\u002Fqna.habr.com\u002Fq\u002F284526\" rel=\"nofollow\"\u003Eответ\u003C\u002Fa\u003E на вопрос: \"Что это такое и зачем нужно?\"\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fstylelint\u002Fstylelint\" rel=\"nofollow\"\u003Estylelint\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-stylelint\" rel=\"nofollow\"\u003Egulp-stylelint\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fstylelint-scss\" rel=\"nofollow\"\u003Estylelint-scss\u003C\u002Fa\u003E — плагины для проверки наших стилей\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhtmlacademy\u002Fstylelint-config-htmlacademy\" rel=\"nofollow\"\u003Estylelint-config-htmlacademy\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fstylelint\u002Fstylelint-config-standard\" rel=\"nofollow\"\u003Estylelint-config-standard\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fstylelint-config-standard-scss\" rel=\"nofollow\"\u003Estylelint-config-standard-scss\u003C\u002Fa\u003E — готовые конфиги, которые мы подключили в свой конфиг\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EФайлы styles:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EСтруктура папки styles\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fql\u002Fgh\u002F32\u002Fqlgh32ysgiw-v-qi3cwaxoadj60.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fql\u002Fgh\u002F32\u002Fqlgh32ysgiw-v-qi3cwaxoadj60.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Eglobal.scss\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fvs\u002Fmo\u002Fz0\u002Fvsmoz0dz_gy0gxdjrv0enwcjkj0.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvs\u002Fmo\u002Fz0\u002Fvsmoz0dz_gy0gxdjrv0enwcjkj0.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Emedia.scss\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Ffm\u002Fyu\u002Fq8\u002Ffmyuq8ggcbkcks5cpc6fhnijupa.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ffm\u002Fyu\u002Fq8\u002Ffmyuq8ggcbkcks5cpc6fhnijupa.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНемного обсудим файл \u003Ccode\u003Emedia.scss\u003C\u002Fcode\u003E. Есть два варианта организации медиа-запросов.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EПисать медиа-запросы ко всему блоку в конце файла.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПисать медиа-запросы в самом селекторе, используя \u003Ccode\u003E@mixin\u003C\u002Fcode\u003E и \u003Ccode\u003E@include\u003C\u002Fcode\u003E.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример второго варианта\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Frw\u002Fnd\u002Fmd\u002Frwndmdltykxzsgjjg--0dho2moq.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Frw\u002Fnd\u002Fmd\u002Frwndmdltykxzsgjjg--0dho2moq.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЯ поклонник второго варианта, удобно, когда все стили в одном месте, и не нужно никуда скроллить и ничего искать.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоследний шаг: подключим \u003Ca href=\"http:\u002F\u002Fnecolas.github.io\u002Fnormalize.css\u002F\" rel=\"nofollow\"\u003Enormalize.css\u003C\u002Fa\u003E. Установим командой \u003Ccode\u003Enpm install normalize.css\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nи добавим \u003Ccode\u003E@import \"..\u002F..\u002F..\u002Fnode_modules\u002Fnormalize.css\u002Fnormalize\";\u003C\u002Fcode\u003E в начале файла \u003Ccode\u003Eglobal.scss\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhtmlacademy.ru\u002Fblog\u002Fuseful\u002Fcss\u002Fabout-normalize-css\" rel=\"nofollow\"\u003EЗачем нужен normalize.css?\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"javascript\"\u003EJavaScript\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВсе делаем так же, как и с другими тасками, только подключаем другие плагины.\u003Cbr\u002F\u003E\r\nУстановим сначала все необходимые зависимости \u003Ccode\u003Enpm i gulp-babel @babel\u002Fcore @babel\u002Fpreset-env --save-dev\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nи зависимости для \u003Ca href=\"https:\u002F\u002Feslint.org\u002F\" rel=\"nofollow\"\u003Eeslint\u003C\u002Fa\u003E \u003Ccode\u003Enpm install eslint eslint-config-htmlacademy eslint-config-standard eslint-plugin-standard eslint-plugin-promise eslint-plugin-import eslint-plugin-node --save-dev\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-babel\" rel=\"nofollow\"\u003Egulp-babel\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002F@babel\u002Fcore\" rel=\"nofollow\"\u003E@babel\u002Fcore\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002F@babel\u002Fpreset-env\" rel=\"nofollow\"\u003E@babel\u002Fpreset-env\u003C\u002Fa\u003E — \u003Ca href=\"https:\u002F\u002Fbabeljs.io\u002F\" rel=\"nofollow\"\u003Ebabel\u003C\u002Fa\u003E конвертирует ECMAScript 2015+ код в более старую версию\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПример\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwx\u002Ftc\u002F0o\u002Fwxtc0o201ahjphpgm6osrv_jjos.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwx\u002Ftc\u002F0o\u002Fwxtc0o201ahjphpgm6osrv_jjos.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-terser\" rel=\"nofollow\"\u003Egulp-terser\u003C\u002Fa\u003E — минификация и оптимизация javascript.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EЗадача script\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fhw\u002Fmo\u002F6-\u002Fhwmo6-afrzokestl5bwjdj7jgxw.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fhw\u002Fmo\u002F6-\u002Fhwmo6-afrzokestl5bwjdj7jgxw.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Feslint.org\u002F\" rel=\"nofollow\"\u003Eeslint\u003C\u002Fa\u003E — мы уже знаем, что делают линтеры. Решил подключить готовые конфиги, потому что очень много разных правил, чтобы все настраивать с нуля.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003E.eslintrc.json\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fpt\u002F6y\u002Fr9\u002Fpt6yr9qvwxwfnqldc8nuv4qogtk.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpt\u002F6y\u002Fr9\u002Fpt6yr9qvwxwfnqldc8nuv4qogtk.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"optimiziruem-kartinki-kopiruem-shrifty-delaem-svg-sprite\"\u003EОптимизируем картинки, копируем шрифты, делаем svg-sprite\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУстанавливаем плагины \u003Ccode\u003Enpm i gulp-imageMinify gulp-svgstore\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\nДля картинок используется банальный код, который вы уже на данном этапе без проблем можете понять.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EШрифты мы просто копируем.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНе вижу смысла объяснять, как делать svg спрайты, когда в интернете много статей. \u003Ca href=\"http:\u002F\u002Fglivera-team.github.io\u002Fsvg\u002F2016\u002F06\u002F13\u002Fsvg-sprites-2.html\" rel=\"nofollow\"\u003EВот одна из них\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"ekonomim-vremya\"\u003EЭкономим время\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЧтобы каждый раз не обновлять страницу при изменении файла, подключим \u003Ca href=\"https:\u002F\u002Fwww.browsersync.io\u002F\" rel=\"nofollow\"\u003Ebrowser-sync\u003C\u002Fa\u003E. У gulp есть встроенная функция, которая следит за изменениями и вызывает нужные нам функции. Советую зайти и почитать о возможностях \u003Ca href=\"https:\u002F\u002Fwww.browsersync.io\u002F\" rel=\"nofollow\"\u003Ebrowsersync\u003C\u002Fa\u003E. Мне очень нравится возможность открытия сайта и синхронизации прокрутки страницы на нескольких устройствах. Очень удобно верстать адаптивные сайты: открыл на компьютере, открыл на телефоне — и сразу видишь результат.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EНаш локальный сервер. Задача serve\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Fwn\u002Fhi\u002Fmc\u002Fwnhimc3agc9cozu7n54ebiq5-nm.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwn\u002Fhi\u002Fmc\u002Fwnhimc3agc9cozu7n54ebiq5-nm.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EБывает такое, что сделал опечатку, сохранил код и сборка падает с ошибкой. Нужно снова перезапускать сборку, и со временем это может начать раздражать, поэтому установим \u003Ccode\u003Enpm i gulp-plumber\u003C\u002Fcode\u003E. \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-plumber\" rel=\"nofollow\"\u003EPlumber\u003C\u002Fa\u003E будет перехватывать ошибки, и после устранения ошибки сборка восстановит работоспособность. Интегрировать его очень просто, добавляем его первым \u003Ccode\u003E.pipe(plumber())\u003C\u002Fcode\u003E в наших \u003Cdel\u003Eтрубопроводах\u003C\u002Fdel\u003E цепочках \u003Ccode\u003Epug2html\u003C\u002Fcode\u003E и \u003Ccode\u003Estyles\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВо время разработки мы будем создавать и удалять файлы. Так как у нас \u003Ccode\u003Elive reload\u003C\u002Fcode\u003E, то созданные файлы автоматически попадут в \u003Ccode\u003Ebuild\u003C\u002Fcode\u003E. Когда чуть позже мы решим удалить файл, то он останется в папке \u003Ccode\u003Ebuild\u003C\u002Fcode\u003E, поэтому сделаем еще одну задачу \u003Ccode\u003Eclean\u003C\u002Fcode\u003E, которая будет удалять папку. Установим плагин \u003Ccode\u003Enpm install del\u003C\u002Fcode\u003E. \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fdel\" rel=\"nofollow\"\u003EDel\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Econst del = require('del')\n\nmodule.exports = function clean() {\n  return del('build')\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cstrong\u003EГлавное — не забыть вызвать функцию-callback, которая сообщит gulp, что задача выполнена.\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"lighthouse\"\u003ELighthouse\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FGoogleChrome\u002Flighthouse\" rel=\"nofollow\"\u003ELighthouse\u003C\u002Fa\u003E — решение для веб-приложений и веб-страниц, которое собирает современные показатели производительности.\u003C\u002Fblockquote\u003E\u003Cp\u003EКстати, некоторые заказчики смотрят на эти показатели, так как не знают других способов оценить качество верстки.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВы можете возразить, зачем ради одной странички заморачиваться, но в реальных проектах их может быть больше 10.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EСкрин с реального проекта\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fpn\u002Fl5\u002Fmm\u002Fpnl5mmzzrdljesd2hl4-zhpkke4.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpn\u002Fl5\u002Fmm\u002Fpnl5mmzzrdljesd2hl4-zhpkke4.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУстанавливаем \u003Ccode\u003Enpm i --save-dev gulp-connect lighthouse chrome-launcher\u003C\u002Fcode\u003E и создаём задачу.\u003Cbr\u002F\u003E\r\nРезультат для каждой странички будет генерироваться в папку \u003Ccode\u003E.\u002Freports\u003C\u002Fcode\u003E. Там будут 'html' файлы, они открываются автоматически, но вы сами в любой момент можете их открыть и посмотреть результат.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНа первый взгляд может показаться, что лучше запустить несколько страниц на тестирование, но этого нельзя сделать в одном запущенном процессе хрома, а если запустить несколько процессов паралельно, то результаты могут быть очень неточные.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Elighthouse.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002F0_\u002F3f\u002Fuo\u002F0_3fuonzaxnhu8fzrdocxxqbrky.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F0_\u002F3f\u002Fuo\u002F0_3fuonzaxnhu8fzrdocxxqbrky.png\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКода многовато, но он простой. Запустили наш локальный сервер с помощью \u003Ccode\u003Ebrowser-sync\u003C\u002Fcode\u003E, потом хром и в конце \u003Ccode\u003Elighthouse\u003C\u002Fcode\u003E, где говорим, по какому \u003Ccode\u003Eurl\u003C\u002Fcode\u003E искать наш сайт.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"kopiruem-zavisimosti\"\u003EКопируем зависимости\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ нашей команде есть правило, что все \u003Ccode\u003Edependencies\u003C\u002Fcode\u003E нужно загружать в репозиторий. Это было связано с тем, что иногда может пропасть интернет \u003Cdel\u003Eв стране\u003C\u002Fdel\u003E. Вручную скачивать пакеты с сайтов и загружать их в папку не очень удобно, ещё сложно следить за версиями пакетов, и каждый раз из node_modules обновлять также не очень удобно, поэтому мы должны оптимизировать этот процесс.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fgulp-npm-dist\" rel=\"nofollow\"\u003Egulp-npm-dist\u003C\u002Fa\u003E — очень хороший плагин, мне он нравится тем, что он не просто копирует всю папку модуля, а только нужные файлы. \u003Ccode\u003EREADME.md\u003C\u002Fcode\u003E, \u003Ccode\u003ELICENSE\u003C\u002Fcode\u003E, \u003Ccode\u003E.gitignore\u003C\u002Fcode\u003E и другие конфигурационные файлы не копируются.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь сделаем, чтобы при изменении \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E вызывался плагин. Не вижу смысла сильно заморачиваться и следить только за изменениями объекта \u003Ccode\u003Edependencies\u003C\u002Fcode\u003E, поэтому будем просто следить за файлом.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"npm-skripty\"\u003ENPM-скрипты\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоследняя оптимизация. Часто сложно и лень запоминать консольные команды, там много параметров, вводить все эти пути занимает время,\u003Cbr\u002F\u003E\r\nпоэтому запишем длинные команды в более краткие команды.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EРассмотрим такую ситуацию: вы скопировали большой кусок кода с постороннего ресурса, и\u003Cbr\u002F\u003E\r\nон не соответствует вашим правилам форматирования.\u003Cbr\u002F\u003E\r\nНе будете же вы всё править руками? Можно просто в консоли ввести команду, которая все исправит\u003Cbr\u002F\u003E\r\nза вас \u003Ccode\u003Estylelint .\u002Fsrc\u002Fstyles\u002F**\u002F*.scss --fix --syntax scss\u003C\u002Fcode\u003E, команда длинная, поэтому запишем ее в NPM-скрипт\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EДобавили NPM-скрипт\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fkt\u002Fsd\u002F8j\u002Fktsd8jvsodx0lo0mowygm6kxmiu.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fkt\u002Fsd\u002F8j\u002Fktsd8jvsodx0lo0mowygm6kxmiu.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак видим на скрине, теперь в консоли можно вводить \u003Ccode\u003Enpm run stylelint-fix\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНапишем еще несколько команд:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ccode\u003Enpm run start\u003C\u002Fcode\u003E — вместо \u003Ccode\u003Egulp\u003C\u002Fcode\u003E, привык, что любой проект у меня запускается этой командой\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Enpm run build\u003C\u002Fcode\u003E — вместо \u003Ccode\u003Egulp build\u003C\u002Fcode\u003E, такая же ситуация, как в прошлом пункте\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Enpm run lighthouse\u003C\u002Fcode\u003E — вместо \u003Ccode\u003Egulp build &amp;&amp; gulp lighthouse\u003C\u002Fcode\u003E, сначала собираем проект, а потом уже тестируем\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ccode\u003Enpm run test\u003C\u002Fcode\u003E — запуск разных линтеров, хорошей практикой будет запускать перед комитом\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"pre-commit\"\u003EPRE-COMMIT\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНе верю я, что вы будете перед комитом запускать \u003Ccode\u003Enpm run test\u003C\u002Fcode\u003E, даже не верю, что я буду. Поэтому скачаем \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fhusky\" rel=\"nofollow\"\u003Ehusky\u003C\u002Fa\u003E и добавим: \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"npm run test\"\n    }\n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003Eв \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E. Если \u003Ccode\u003Enpm run test\u003C\u002Fcode\u003E вернет ошибку, то комит не будет сделан.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"spasibo\"\u003EСпасибо\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОчень приятно, если вы прочли всю статью и сумели принять мои мысли. Отвечу на вопросы в комментариях и жду ваших \u003Ccode\u003Epull requests\u003C\u002Fcode\u003E и \u003Ccode\u003Eissue\u003C\u002Fcode\u003E. Всем приятных сборок.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСсылка на репозиторий с тем, что у нас получилось: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FdDenysS\u002Fgulp-template\" rel=\"nofollow\"\u003Egithub\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"html"},{"titleHtml":"gulp"},{"titleHtml":"css"},{"titleHtml":"javascript"},{"titleHtml":"сборка проекта"},{"titleHtml":"pug"},{"titleHtml":"scss"},{"titleHtml":"автоматизация"},{"titleHtml":"автоматизация рутины"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F484714\u002Fbbcd8ab0966cc90efd6414f2dfb7f761\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F484714\u002Fbbcd8ab0966cc90efd6414f2dfb7f761\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F484714\\\u002F\"},\"headline\":\"Современная сборка 2020 для frontend. Gulp4\",\"datePublished\":\"2020-02-17T05:04:21+03:00\",\"dateModified\":\"2020-02-25T11:05:28+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Денис\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Начало Посмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разбере...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F484714\\\u002F#post-content-body\",\"about\":[\"h_webdev\",\"h_css\",\"h_javascript\",\"h_html5\",\"h_nodejs\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Flj\\\u002Fg3\\\u002Fhv\\\u002Fljg3hvoy9axohgzzd19rde6ziwo.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fia\\\u002Far\\\u002Foj\\\u002Fiaarojs2o_yxufltm0wtwuglmvc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fgr\\\u002Fvw\\\u002Fjq\\\u002Fgrvwjqqbyh2ntjayjcmo33p4uvm.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F326\\\u002F209\\\u002Fe22\\\u002F326209e22685a770c4540a268674fa43.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fpa\\\u002F_j\\\u002Fg7\\\u002Fpa_jg7rtrtanxwpv8tvd0s2ftma.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fsx\\\u002Fpp\\\u002Flz\\\u002Fsxpplzqdystfm-q9skym2nvr860.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fjz\\\u002Fhr\\\u002Ffh\\\u002Fjzhrfhh8czcyhetry6o2l9zmale.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fbu\\\u002Fuj\\\u002Fbn\\\u002Fbuujbnhfu4atbiffqueuhj6dfw8.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F3q\\\u002Foc\\\u002Fpq\\\u002F3qocpq4irq54xl73aj-ntmduues.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Ffz\\\u002Fsc\\\u002Fvm\\\u002Ffzscvmvbtb8unlkflcv3dljnsto.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F7e\\\u002Fks\\\u002F_i\\\u002F7eks_in5xmluxdnr0skrmosk6x0.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fk1\\\u002Fu3\\\u002F3z\\\u002Fk1u33z0_89gnnzufrt3djtrfcx0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fld\\\u002F58\\\u002Fyr\\\u002Fld58yrcupgcyq7d1wt4rkazzgiu.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Frq\\\u002F7w\\\u002Fyu\\\u002Frq7wyu9-264hjg8vxoqlxoxaz5o.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fnf\\\u002Fco\\\u002Fkw\\\u002Fnfcokwsfdntczlzy9_ngkebv9_g.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fl3\\\u002Fiq\\\u002Fss\\\u002Fl3iqssvcxnlzz9mrezqisvirsxk.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fsm\\\u002Fd3\\\u002Frd\\\u002Fsmd3rdyqmjbao3xpl9zmy3dkyxo.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fql\\\u002Fgh\\\u002F32\\\u002Fqlgh32ysgiw-v-qi3cwaxoadj60.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fvs\\\u002Fmo\\\u002Fz0\\\u002Fvsmoz0dz_gy0gxdjrv0enwcjkj0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Ffm\\\u002Fyu\\\u002Fq8\\\u002Ffmyuq8ggcbkcks5cpc6fhnijupa.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Frw\\\u002Fnd\\\u002Fmd\\\u002Frwndmdltykxzsgjjg--0dho2moq.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwx\\\u002Ftc\\\u002F0o\\\u002Fwxtc0o201ahjphpgm6osrv_jjos.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fhw\\\u002Fmo\\\u002F6-\\\u002Fhwmo6-afrzokestl5bwjdj7jgxw.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fpt\\\u002F6y\\\u002Fr9\\\u002Fpt6yr9qvwxwfnqldc8nuv4qogtk.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwn\\\u002Fhi\\\u002Fmc\\\u002Fwnhimc3agc9cozu7n54ebiq5-nm.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fpn\\\u002Fl5\\\u002Fmm\\\u002Fpnl5mmzzrdljesd2hl4-zhpkke4.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F0_\\\u002F3f\\\u002Fuo\\\u002F0_3fuonzaxnhu8fzrdocxxqbrky.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fkt\\\u002Fsd\\\u002F8j\\\u002Fktsd8jvsodx0lo0mowygm6kxmiu.jpeg\"]}","metaDescription":"Начало\r\nПосмотрев на календарь, я понял, что уже 2020, а посмотрев на свою сборку, которая была с 2018 года, я понял, что пора её менять. В этой статье мы разберем структуру проекта, плагины...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"JavaScript разработчик","vacanciesCount":554,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fprogrammist_javascript","itemHubs":["javascript","reactjs","nodejs","typescript","vuejs","angular","sveltejs"]},{"title":"React разработчик","vacanciesCount":276,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Freact_razrabotchik","itemHubs":["javascript","reactjs"]},{"title":"Node.js разработчик","vacanciesCount":185,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fnodejs_razrabotchik","itemHubs":["nodejs"]}],"hubs":"webdev,css,javascript,html5,nodejs"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"technotext":{"nominationsList":[]},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.da6c6b36.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.92df6f6d.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="https://habr.com/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
