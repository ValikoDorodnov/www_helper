<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <link rel="apple-touch-icon" sizes="180x180" href="https://www.yiiframework.com/favico/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://www.yiiframework.com/favico/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://www.yiiframework.com/favico/favicon-16x16.png">
        <link rel="shortcut icon" href="https://www.yiiframework.com/favico/favicon.ico">
        <link rel="manifest" href="https://www.yiiframework.com/favico/manifest.json">
        <link rel="mask-icon" href="https://www.yiiframework.com/favico/safari-pinned-tab.svg" color="#1e6887">
        <meta name="msapplication-config" content="/favico/browserconfig.xml">
        <meta name="theme-color" content="#1e6887">

        <link href="https://www.yiiframework.com/rss.xml" type="application/rss+xml" rel="alternate" title="Lives News for Yii Framework">

        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <meta name="csrf-param" content="_csrf">
<meta name="csrf-token" content="zWZNQeokK2z1RLjLbbxPCPRXzHuOW-qLMO6TgoUz3oG7KntzuAlMO6MA2oo0hHcxvgD6K9wOosZ9j-LG6wWJtQ==">
        
        <title>Работа с базами данных: Миграции | Полное руководство по Yii 2.0 | Yii PHP Framework</title>

        <meta property="og:site_name" content="Yii Framework" />
        <meta property="og:title" content="Работа с базами данных: Миграции" />
        <meta property="og:image" content="https://www.yiiframework.com/image/facebook_cover.png" />
        <meta property="og:url" content="/doc/guide/2.0/ru/db-migrations" />
        <meta property="og:description" content="" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="yiiframework" />
        <meta name="twitter:title" content="Работа с базами данных: Миграции" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:image" content="https://www.yiiframework.com/image/twitter_cover.png" />
        <meta name="twitter:image:width" content="120" />
        <meta name="twitter:image:height" content="120" />

        <link type="application/opensearchdescription+xml" href="https://www.yiiframework.com/opensearch.xml" title="Yii Search" rel="search">
<link href="https://www.yiiframework.com/assets/85247087/css/all.min.css?v=1645275708" rel="stylesheet">
<script>yiiBaseUrl = ""
yiiSearchLanguage = "ru"
yiiSearchVersion = "2.0"</script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-707ZP35KCT"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-707ZP35KCT');
</script>
    </head>
    <body data-spy="scroll" data-target="#scrollnav" data-offset="1">
        
        <div id="page-wrapper" class="">

            <header class="navbar navbar-inverse navbar-static" id="top">
    <div class="container">
        <div id="main-nav-head" class="navbar-header">
            <a href="https://www.yiiframework.com/" class="navbar-brand">
                <img src="https://www.yiiframework.com/image/logo.svg"
                     alt="Yii PHP Framework"
                     width="165" height="35"/>
            </a>
            <button type="button" class="navbar-toggle" data-toggle="collapse" aria-label="Toggle navigation" data-target=".navbar-collapse"><i
                    class="fa fa-inverse fa-bars"></i></button>
        </div>

        <div class="navbar-collapse collapse navbar-right">
            <ul id="main-nav" class="nav navbar-nav navbar-main-menu nav"><li class="active" title="The Definitive Guide to Yii"><a href="https://www.yiiframework.com/doc/guide">Guide</a></li>
<li title="API Documentation"><a href="https://www.yiiframework.com/doc/api">API</a></li>
<li title="Community Wiki"><a href="https://www.yiiframework.com/wiki">Wiki</a></li>
<li title="Community Forum"><a href="https://www.yiiframework.com/forum">Forum</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="db-migrations.html#" data-toggle="dropdown">Community <span class="caret"></span></a><ul id="w16" class="dropdown-menu"><li><a href="https://www.yiiframework.com/chat" tabindex="-1">Live Chat</a></li>
<li title="Extensions"><a href="https://www.yiiframework.com/extensions" tabindex="-1">Extensions</a></li>
<li><a href="https://www.yiiframework.com/community" tabindex="-1">Resources</a></li>
<li title="Community Members"><a href="https://www.yiiframework.com/user" tabindex="-1">Members</a></li>
<li title="Community Hall of Fame"><a href="https://www.yiiframework.com/user/halloffame" tabindex="-1">Hall of Fame</a></li>
<li title="Community Badges"><a href="https://www.yiiframework.com/badges" tabindex="-1">Badges</a></li></ul></li>
<li class="dropdown"><a class="dropdown-toggle" href="db-migrations.html#" data-toggle="dropdown">More <span class="caret"></span></a><ul id="w17" class="dropdown-menu"><li class="separator dropdown-header">Learn</li>
<li><a href="https://www.yiiframework.com/books" tabindex="-1">Books</a></li>
<li><a href="https://www.yiiframework.com/resources" tabindex="-1">Resources</a></li>
<li class="separator dropdown-header">Develop</li>
<li><a href="https://www.yiiframework.com/download" tabindex="-1">Download Yii</a></li>
<li><a href="https://www.yiiframework.com/report-issue" tabindex="-1">Report an Issue</a></li>
<li><a href="https://www.yiiframework.com/security" tabindex="-1">Report a Security Issue</a></li>
<li><a href="https://www.yiiframework.com/contribute" tabindex="-1">Contribute to Yii</a></li>
<li class="separator dropdown-header">About</li>
<li><a href="https://www.yiiframework.com/doc/guide/2.0/en/intro-yii" tabindex="-1">What is Yii?</a></li>
<li><a href="https://www.yiiframework.com/release-cycle" tabindex="-1">Release Cycle</a></li>
<li><a href="https://www.yiiframework.com/news" tabindex="-1">News</a></li>
<li><a href="https://www.yiiframework.com/license" tabindex="-1">License</a></li>
<li><a href="https://www.yiiframework.com/team" tabindex="-1">Team</a></li>
<li><a href="https://www.yiiframework.com/logo" tabindex="-1">Official Logos and Design</a></li></ul></li></ul>
            
            <div class="nav navbar-nav navbar-right">
                <ul id="login-nav" class="nav navbar-nav navbar-main-menu nav"><li><a href="https://www.yiiframework.com/login">Login</a></li></ul>            </div>

            <div class="nav navbar-nav navbar-right">
                        <form id="search-form" class="navbar-form" action="https://www.yiiframework.com/search" method="get">
<input type="hidden" name="language" value="ru">
<input type="hidden" name="version" value="2.0">
<input type="hidden" name="type" value="guide">        <div class="form-group nospace">
            <div class="input-group">
                <input type="text" class="form-control" id="search" name="q" placeholder="Search Guide&hellip;" autocomplete="off" value="">
            </div>
        </div>
        <div id="search-resultbox"></div>
        </form>            </div>

            
        </div>
    </div>
</header>

            <div class="section-header-wrap">
    <div class="container section-header lang-en">
        <div class="row headline-row">
            <div class="col-xs-12 col-md-12">
                <div class="section-headline">Полное руководство по Yii 2.0</div>
            </div>
                    </div>
                <div class="row content-selector-row">
            <div class="col-xs-12 col-md-offset-7 col-md-5">
                <nav class="version-selector">
        <div class="btn-group btn-group-justified btn-group-3-element">
        <div class="btn-group btn-group-sm"><button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Download <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li role="presentation"><a href="https://www.yiiframework.com/doc/download/yii-guide-2.0-ru.pdf" role="menuitem" tabindex="-1">PDF</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/download/yii-docs-2.0-ru.tar.gz" role="menuitem" tabindex="-1">Offline HTML (tar.gz)</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/download/yii-docs-2.0-ru.tar.bz2" role="menuitem" tabindex="-1">Offline HTML (tar.bz2)</a></li></ul></div>                <div class="btn-group btn-group-sm"><button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Русский <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/ar/db-migrations" role="menuitem" tabindex="-1">العربية</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/en/db-migrations" role="menuitem" tabindex="-1">English</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/es/db-migrations" role="menuitem" tabindex="-1">Español</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/fr/db-migrations" role="menuitem" tabindex="-1">Français</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/id/db-migrations" role="menuitem" tabindex="-1">Bahasa Indonesia</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/ja/db-migrations" role="menuitem" tabindex="-1">日本語</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/pl/db-migrations" role="menuitem" tabindex="-1">Polski</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/pt-br/db-migrations" role="menuitem" tabindex="-1">Português brasileiro</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/uk/db-migrations" role="menuitem" tabindex="-1">Українська</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/uz/db-migrations" role="menuitem" tabindex="-1">Oʻzbekcha</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/zh-cn/db-migrations" role="menuitem" tabindex="-1">简体中文</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/2.0/vi/db-migrations" role="menuitem" tabindex="-1">Tiếng Việt</a></li></ul></div>
                <div class="btn-group btn-group-sm"><button class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Version 2.0 <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li role="presentation"><a href="https://www.yiiframework.com/doc/guide/1.1/ru" role="menuitem" tabindex="-1">1.1</a></li>
<li role="presentation"><a href="https://www.yiiframework.com/doc/guide/1.0/ru" role="menuitem" tabindex="-1">1.0</a></li></ul></div>    </div>
</nav>
            </div>
        </div>
            </div>
</div>

                        <div class="visible-huge fixed lang-ru">
    <nav id="scrollnav" data-spy="affix" data-offset-top="120">
        <ul class="nav hidden-xs hidden-sm">
            <li><a href="db-migrations.html#migracii-baz-dannyh">Миграции баз данных</a></li><li><a href="db-migrations.html#creating-migrations">Создание миграций</a></li><li><a href="db-migrations.html#generating-migrations">Генерация миграций</a><ul class="nav"><li class="subheading"><a href="db-migrations.html#sozdanie-tablicy">Создание таблицы</a></li><li class="subheading"><a href="db-migrations.html#vnesnie-kluci">Внешние ключи</a></li><li class="subheading"><a href="db-migrations.html#udalenie-tablicy">Удаление таблицы</a></li><li class="subheading"><a href="db-migrations.html#dobavlenie-stolbca">Добавление столбца</a></li><li class="subheading"><a href="db-migrations.html#udalenie-stolbca">Удаление столбца</a></li><li class="subheading"><a href="db-migrations.html#dobavlenie-promezutocnoj-tablicy">Добавление промежуточной таблицы</a></li><li class="subheading"><a href="db-migrations.html#transactional-migrations">Транзакции Миграций</a></li><li class="subheading"><a href="db-migrations.html#db-accessing-methods">Методы доступа к базе данных</a></li></ul></li><li><a href="db-migrations.html#applying-migrations">Применение Миграций</a></li><li><a href="db-migrations.html#reverting-migrations">Отмена Миграций</a></li><li><a href="db-migrations.html#redoing-migrations">Перезагрузка Миграций</a></li><li><a href="db-migrations.html#listing-migrations">Список Миграций</a></li><li><a href="db-migrations.html#modifying-migration-history">Изменение Истории Миграций</a></li><li><a href="db-migrations.html#customizing-migrations">Настройка Миграций</a><ul class="nav"><li class="subheading"><a href="db-migrations.html#using-command-line-options">Используя параметры командной строки</a></li><li class="subheading"><a href="db-migrations.html#configuring-command-globally">Глобальная настройка команд</a></li><li class="subheading"><a href="db-migrations.html#namespaced-migrations">Миграции с пространством имен</a></li><li class="subheading"><a href="db-migrations.html#separated-migrations">Отдельностоящие Миграции</a></li></ul></li><li><a href="db-migrations.html#migrating-multiple-databases">Миграции в Несколько Баз Данных</a></li><li><a href="db-migrations.html#user-notes">User Contributed Notes</a></li>        </ul>
    </nav>
</div>
<div class="container guide-view" xmlns="http://www.w3.org/1999/xhtml">
    <div class="row visible-xs">
        <div class="col-md-12">
            <p class="pull-right topmost">
                <button type="button" title="Toggle Side-Nav" class="btn btn-primary btn-xs" data-toggle="offcanvas">SideNav</button>
            </p>
        </div>
    </div>
    <div class="row row-offcanvas">
        <div class="col-sm-3 col-md-3 col-lg-3 lang-ru">
            <form class="mini-search-form" action="https://www.yiiframework.com/search" method="get">
<input type="hidden" name="language" value="ru">
<input type="hidden" name="version" value="2.0">
<input type="hidden" name="type" value="guide"><input type="text" class="form-control" name="q" placeholder="Search the Guide…" autocomplete="off" aria-label="Search box"> <button type="submit" class="btn btn-primary sr-only">Search</button></form>            <div id="guide-navigation" class="sidenav-offcanvas"><a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-0">Введение</a><div id="guide-navigation-0" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/intro-yii">О Yii</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/intro-upgrade-from-v1">Обновление с версии 1.1</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-1">Первое знакомство</a><div id="guide-navigation-1" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-installation">Установка Yii</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-workflow">Запуск приложения</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-hello">Говорим «привет»</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-forms">Работа с формами</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-databases">Работа с базами данных</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-gii">Генерация кода при помощи Gii</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/start-looking-ahead">Что дальше?</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-2">Структура приложения</a><div id="guide-navigation-2" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-entry-scripts">Входные скрипты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-applications">Приложения</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-application-components">Компоненты приложения</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-controllers">Контроллеры</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-models">Модели</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-views">Представления</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-modules">Модули</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-filters">Фильтры</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-widgets">Виджеты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-assets">Ресурсы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-extensions">Расширения</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-3">Обработка запросов</a><div id="guide-navigation-3" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-bootstrapping">Bootstrapping</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-routing">Разбор и генерация URL</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-requests">Запросы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-responses">Ответы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-sessions-cookies">Сессии и куки</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-handling-errors">Обработка ошибок</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/runtime-logging">Логирование</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-4">Основные понятия</a><div id="guide-navigation-4" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-components">Компоненты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-properties">Свойства</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-events">События</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-behaviors">Поведения</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-configurations">Конфигурации</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-aliases">Псевдонимы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-autoloading">Автозагрузка классов</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-service-locator">Service Locator</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-di-container">Dependency Injection Container</a></div>
<a class="list-group-item has-children active" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-5">Работа с базами данных</a><div id="guide-navigation-5" class="submenu panel-collapse collapse in active-parent"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/db-dao">Объекты доступа к данным (DAO)</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/db-query-builder">Построитель запросов</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/db-active-record">Active Record</a>
<a class="list-group-item active" href="db-migrations.html">Миграции</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-sphinx/blob/master/docs/guide-ru/README.md">Sphinx</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-redis/blob/master/docs/guide-ru/README.md">Redis</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-mongodb/blob/master/docs/guide-ru/README.md">MongoDB</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-elasticsearch/blob/master/docs/guide-ru/README.md">ElasticSearch</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-6">Получение данных от пользователя</a><div id="guide-navigation-6" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-forms">Создание форм</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-validation">Валидация</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-file-upload">Загрузка файлов</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-tabular-input">Табличный ввод</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-multiple-models">Работа с несколькими моделями</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/input-form-javascript">Расширение ActiveForm на стороне клиента</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-7">Отображение данных</a><div id="guide-navigation-7" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-formatting">Форматирование данных</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-pagination">Постраничная разбивка</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-sorting">Сортировка</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-data-providers">Провайдеры данных</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-data-widgets">Виджеты для данных</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-client-scripts">Работа с клиентскими скриптами</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/output-theming">Темизация</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-8">Безопасность</a><div id="guide-navigation-8" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-authentication">Аутентификация</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-authorization">Авторизация</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-passwords">Работа с паролями</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-cryptography">Криптография</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-authclient/blob/master/docs/guide-ru/README.md">Клиенты авторизации</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/security-best-practices">Лучшие практики</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-9">Кеширование</a><div id="guide-navigation-9" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/caching-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/caching-data">Кэширование данных</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/caching-fragment">Кэширование фрагментов</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/caching-page">Кэширование страниц</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/caching-http">HTTP кэширование</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-10">Веб-сервисы REST</a><div id="guide-navigation-10" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-quick-start">Быстрый старт</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-resources">Ресурсы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-controllers">Контроллеры</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-routing">Роутинг</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-response-formatting">Форматирование ответа</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-authentication">Аутентификация</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-rate-limiting">Ограничение частоты запросов</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-versioning">Версионирование</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/rest-error-handling">Обработка ошибок</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-11">Инструменты разработчика</a><div id="guide-navigation-11" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-debug/blob/master/docs/guide/README.md">Отладочная панель и отладчик</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-gii/blob/master/docs/guide/README.md">Генерация кода с Gii</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-apidoc">Генератор документации API</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-12">Тестирование</a><div id="guide-navigation-12" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-environment-setup">Настройка тестового окружения</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-unit">Модульные тесты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-functional">Функциональные тесты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-acceptance">Приёмочные тесты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/test-fixtures">Фикстуры</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-13">Специальные темы</a><div id="guide-navigation-13" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/yiisoft/yii2-app-advanced/blob/master/docs/guide/README.md">Шаблон приложения advanced</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-start-from-scratch">Создание приложения с нуля</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-console">Консольные команды</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-core-validators">Встроенные валидаторы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-i18n">Интернационализация</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-mailing">Отправка почты</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-performance-tuning">Оптимизация производительности</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-shared-hosting">Окружение виртуального хостинга</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-template-engines">Шаблонизаторы</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-yii-integration">Работа со сторонним кодом</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/tutorial-yii-as-micro-framework">Использование Yii в качестве микро-framework&#039;а</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-14">Виджеты</a><div id="guide-navigation-14" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-grid-gridview.html">GridView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-listview.html">ListView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-detailview.html">DetailView</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/guide-input-forms.html#activerecord-based-forms-activeform">ActiveForm</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-pjax.html">Pjax</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-menu.html">Menu</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-linkpager.html">LinkPager</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc-2.0/yii-widgets-linksorter.html">LinkSorter</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-bootstrap/blob/master/docs/guide-ru/README.md">Виджеты Bootstrap</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2-jui/blob/master/docs/guide-ru/README.md">Виджеты Jquery UI</a></div>
<a class="list-group-item has-children" href="db-migrations.html#" data-toggle="collapse" data-parent="#guide-navigation" data-target="#guide-navigation-15">Хелперы</a><div id="guide-navigation-15" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/helper-overview">Обзор</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/helper-array">ArrayHelper</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/helper-html">Html</a>
<a class="list-group-item" href="https://www.yiiframework.com/doc/guide/2.0/ru/helper-url">Url хелпер</a></div></div>        </div>
        <div class="col-sm-9 col-md-9 col-lg-9" role="main">

            <div class="guide-content content lang-ru">

        <div class="pull-right">
        
<div class="star-wrapper">
    <span class="fa fa-star-o" data-star-url="/ajax/star?type=doc&amp;id=649"></span>            <span class="star-count">3</span> followers    </div>
    </div>

    <h1 id="migracii-baz-dannyh">Миграции баз данных <a href="db-migrations.html#migracii-baz-dannyh" class="hashlink">&para;</a></h1>
<div class="toc hidden-lg"><ol><li><a href="db-migrations.html#creating-migrations">Создание миграций</a></li>
<li><a href="db-migrations.html#generating-migrations">Генерация миграций</a></li>
<li><a href="db-migrations.html#applying-migrations">Применение Миграций</a></li>
<li><a href="db-migrations.html#reverting-migrations">Отмена Миграций</a></li>
<li><a href="db-migrations.html#redoing-migrations">Перезагрузка Миграций</a></li>
<li><a href="db-migrations.html#listing-migrations">Список Миграций</a></li>
<li><a href="db-migrations.html#modifying-migration-history">Изменение Истории Миграций</a></li>
<li><a href="db-migrations.html#customizing-migrations">Настройка Миграций</a></li>
<li><a href="db-migrations.html#migrating-multiple-databases">Миграции в Несколько Баз Данных</a></li></ol></div>
<p>В ходе разработки и ведения баз данных приложений, которые управляют данными, структуры используемых баз данных развиваются, как и исходный код приложений. Например, при разработке приложения, в будущем может оказаться необходимой новая таблица; уже после того, как приложение будет развернуто в рабочем режиме (продакшене), также может быть обнаружено, что для повышения производительности запросов должен быть создан определённый индекс; и так далее.
В связи с тем, что изменение структуры базы данных часто требует изменение исходного кода, yii поддерживает так
называемую возможность <em>миграции баз данных</em>, которая позволяет отслеживать изменения в базах данных при помощи терминов <em>миграции баз данных</em>, которые являются системой контроля версий вместе с исходным кодом.</p>
<p>Следующие шаги показывают, как миграции базы данных могут быть использованы командой разработчиков в процессе разработки:</p>
<ol>
<li>Илья создает новую миграцию (например, создается новая таблица или изменяется определение столбца и т.п.).</li>
<li>Илья фиксирует новую миграцию в системе управления версиями (например, в Git, Mercurial).</li>
<li>Алексей обновляет свой репозиторий из системы контроля версий и получает новую миграцию.</li>
<li>Алексей применяет миграцию к своей локальной базе данных, тем самым синхронизируя свою базу данных, для того чтобы отразить изменения, которые сделал Илья.</li>
</ol>
<p>А следующие шаги показывают, как развернуть новый релиз с миграциями баз данных в рабочем режиме (продакшена):</p>
<ol>
<li>Сергей создаёт новую версию проекта репозитория, которая содержит некоторые новые миграции баз данных.</li>
<li>Сергей обновляет исходный код на рабочем сервере до новой версии.</li>
<li>Сергей применяет любую из накопленных миграций баз данных в рабочую базу данных.</li>
</ol>
<p>Yii предоставляет набор инструментов для миграций из командной строки, которые позволяют:</p>
<ul>
<li>создавать новые миграции;</li>
<li>применять миграции;</li>
<li>отменять миграции;</li>
<li>применять миграции повторно;</li>
<li>показывать историю и статус миграций;</li>
</ul>
<p>Все эти инструменты доступны через команду <code>yii migrate</code>. В этом разделе мы опишем подробно, как выполнять различные задачи, используя эти инструменты. Вы также можете сами посмотреть как использовать каждый отдельный инструмент при помощи команды <code>yii help migrate</code>.</p>
<blockquote class="tip"><p><strong>Подсказка: </strong>Миграции могут не только изменять схему базы данных, но и приводить данные в соответствие с новой схемой, создавать иерархию RBAC или очищать кеш.</p>
</blockquote>
<h2 id="creating-migrations">Создание миграций  <a href="db-migrations.html#creating-migrations" class="hashlink">&para;</a></h2><p>Чтобы создать новую миграцию, выполните следующую команду:</p>
<pre><code class="hljs sql">yii migrate/<span class="hljs-keyword">create</span> &lt;<span class="hljs-keyword">name</span>&gt;
</code></pre>
<p>Требуемый аргумент <code>name</code> даёт краткое описание новой миграции. Например, если миграция о создании новой таблицы с именем <em>news</em>, вы можете использовать имя <code>create_news_table</code> и выполнить следующую команду:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/create create_news_table
</code></pre>
<blockquote class="note"><p><strong>Примечание: </strong>Поскольку аргумент <code>name</code> будет использован как часть имени класса создаваемой миграции, он должен содержать только буквы, цифры и/или символы подчеркивания.</p>
</blockquote>
<p>Приведенная выше команда создаст новый PHP класс с именем файла <code>m150101_185401_create_news_table.php</code> в директории <code>@app/migrations</code>. Файл содержит следующий код, который главным образом декларирует класс миграции <code>m150101_185401_create_news_table</code> со следующим каркасом кода:</p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Migration</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150101_185401_create_news_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{

    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"m101129_185401_create_news_table cannot be reverted.\n"</span>;

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-comment">/*
    // Use safeUp/safeDown to run migration code within a transaction
    public function safeUp()
    {
    }

    public function safeDown()
    {
    }
    */</span>
}
</code></pre>
<p>Каждая миграция базы данных определяется как PHP класс расширяющийся от <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration">yii\db\Migration</a>. Имя класса миграции автоматически создается в формате <code>m&lt;YYMMDD_HHMMSS&gt;_&lt;Name&gt;</code> (<code>m&lt;ГодМесяцДень_ЧасыМинутыСекунды&gt;_&lt;Имя&gt;</code>), где</p>
<ul>
<li><code>&lt;YYMMDD_HHMMSS&gt;</code> относится к UTC дате-времени при котором команда создания миграции была выполнена.</li>
<li><code>&lt;Name&gt;</code> это то же самое значение аргумента <code>name</code> которое вы прописываете в команду.</li>
</ul>
<p>В классе миграции, вы должны прописать код в методе <code>up()</code> когда делаете изменения в структуре базы данных.
Вы также можете написать код в методе <code>down()</code>, чтобы отменить сделанные <code>up()</code> изменения. Метод <code>up</code> вызывается для обновления базы данных с помощью данной миграции, а метод <code>down()</code> вызывается для отката изменений базы данных.
Следующий код показывает как можно реализовать класс миграции, чтобы создать таблицу <code>news</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Schema</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Migration</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150101_185401_create_news_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'news'</span>, [
            <span class="hljs-string">'id'</span> =&gt; Schema::TYPE_PK,
            <span class="hljs-string">'title'</span> =&gt; Schema::TYPE_STRING . <span class="hljs-string">' NOT NULL'</span>,
            <span class="hljs-string">'content'</span> =&gt; Schema::TYPE_TEXT,
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'news'</span>);
    }
}
</code></pre>
<blockquote class="info"><p><strong>Информация: </strong>Не все миграции являются обратимыми. Например, если метод <code>up()</code> удаляет строку из таблицы, возможно что у вас уже не будет возможности вернуть эту строку методом <code>down()</code>. Иногда Вам может быть просто слишком лень реализовывать метод <code>down()</code>, в связи с тем, что это не очень распространено - откатывать миграции базы данных. В этом случае вы должны в методе <code>down()</code> вернуть <code>false</code>, чтобы указать, что миграция не является обратимой.</p>
</blockquote>
<p>Базовый класс миграций <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration">yii\db\Migration</a> предоставляет подключение к базе данных через свойство <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#$db-detail">db</a>. Вы можете использовать его для манипулирования схемой базы данных используя методы описанные в <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-dao#database-schema">работе со схемой базы данных</a>.</p>
<p>Вместо использования физических типов данных, при создании таблицы или столбца, следует использовать <em>абстрактные типы</em> для того, чтобы ваша миграция являлась независимой от конкретной СУБД. Класс <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-schema">yii\db\Schema</a> определяет набор констант для предоставления поддержки абстрактных типов. Эти константы называются в следующем формате <code>TYPE_&lt;Name&gt;</code>. Например,
<code>TYPE_PK</code> относится к типу автоинкремента (AUTO_INCREMENT) первичного ключа;
<code>TYPE_STRING</code> относится к строковому типу.
Когда миграция применяется к конкретной базе данных, абстрактные типы будут переведены в соответствующие физические типы.
В случае с MySQL, <code>TYPE_PK</code> будет превращено в <code>int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY</code>, а <code>TYPE_STRING</code> станет <code>varchar(255)</code>.</p>
<p>Вы можете добавить дополнительные ограничения при использовании абстрактных типов. В приведенном выше примере, <code> NOT NULL</code> добавляется к <code>Schema::TYPE_STRING</code> чтобы указать, что столбец не может быть <code>NULL</code>.</p>
<blockquote class="info"><p><strong>Информация: </strong>Сопоставление абстрактных типов и физических типов определяется свойством <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-querybuilder#$typeMap-detail">$typeMap</a> в каждом конкретном <code>QueryBuilder</code> классе.</p>
</blockquote>
<p>Начиная с версии 2.0.6, появился новый построитель схем, который является более удобным инструментом для описания структуры столбцов.
Теперь, при написании миграций, можно использовать такой код:</p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Migration</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150101_185401_create_news_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'news'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string()-&gt;notNull(),
            <span class="hljs-string">'content'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text(),
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'news'</span>);
    }
}
</code></pre>
<p>Весь список методов описания типов столбцов доступен в API документации <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-schemabuildertrait">yii\db\SchemaBuilderTrait</a>.</p>
<h2 id="generating-migrations">Генерация миграций  <a href="db-migrations.html#generating-migrations" class="hashlink">&para;</a></h2><p>Начиная с версии 2.0.7 появился удобный способ создания миграций из консоли.</p>
<p>В том случае, если миграция названа особым образом, таким как, например, <code>create_xxx_table</code> или <code>drop_xxx_table</code> сгенерированный
файл миграции будет содержать дополнительный код.</p>
<h3 id="sozdanie-tablicy">Создание таблицы <a href="db-migrations.html#sozdanie-tablicy" class="hashlink">&para;</a></h3><pre><code class="hljs php language-php">yii migrate/create create_post_table
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_create_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey()
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post'</span>);
    }
}
</code></pre>
<p>Чтобы сразу создать поля таблицы, укажите их через опцию <code>--fields</code>.</p>
<pre><code class="hljs php language-php">yii migrate/create create_post_table --fields=title:string,body:text
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_create_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string(),
            <span class="hljs-string">'body'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text()
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post'</span>);
    }
}
</code></pre>
<p>Можно указать дополнительные параметры.</p>
<pre><code class="hljs php language-php">yii migrate/create create_post_table --fields=title:string(<span class="hljs-number">12</span>):notNull:unique,body:text
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_create_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string(<span class="hljs-number">12</span>)-&gt;notNull()-&gt;unique(),
            <span class="hljs-string">'body'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text()
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post'</span>);
    }
}
</code></pre>
<blockquote class="note"><p><strong>Примечание: </strong>первичный ключ добавляется автоматически и по умолчанию называется <code>id</code>. Если вам необходимо другое имя,
указать его можно через опцию <code>--fields=name:primaryKey</code>.</p>
</blockquote>
<h3 id="vnesnie-kluci">Внешние ключи <a href="db-migrations.html#vnesnie-kluci" class="hashlink">&para;</a></h3><p>Начиная с версии 2.0.8, генератор поддерживает создание внешних ключей через ключевое слово <code>foreignKey</code>.</p>
<pre><code class="hljs php language-php">yii migrate/create create_post_table --fields=<span class="hljs-string">"author_id:integer:notNull:foreignKey(user),category_id:integer:defaultValue(1):foreignKey,title:string,body:text"</span>
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">/**
 * Handles the creation for table `post`.
 * Has foreign keys to the tables:
 *
 * - `user`
 * - `category`
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m160328_040430_create_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'author_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;integer()-&gt;notNull(),
            <span class="hljs-string">'category_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;integer()-&gt;defaultValue(<span class="hljs-number">1</span>),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string(),
            <span class="hljs-string">'body'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text(),
        ]);

        <span class="hljs-comment">// creates index for column `author_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;createIndex(
            <span class="hljs-string">'idx-post-author_id'</span>,
            <span class="hljs-string">'post'</span>,
            <span class="hljs-string">'author_id'</span>
        );

        <span class="hljs-comment">// add foreign key for table `user`</span>
        <span class="hljs-keyword">$this</span>-&gt;addForeignKey(
            <span class="hljs-string">'fk-post-author_id'</span>,
            <span class="hljs-string">'post'</span>,
            <span class="hljs-string">'author_id'</span>,
            <span class="hljs-string">'user'</span>,
            <span class="hljs-string">'id'</span>,
            <span class="hljs-string">'CASCADE'</span>
        );

        <span class="hljs-comment">// creates index for column `category_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;createIndex(
            <span class="hljs-string">'idx-post-category_id'</span>,
            <span class="hljs-string">'post'</span>,
            <span class="hljs-string">'category_id'</span>
        );

        <span class="hljs-comment">// add foreign key for table `category`</span>
        <span class="hljs-keyword">$this</span>-&gt;addForeignKey(
            <span class="hljs-string">'fk-post-category_id'</span>,
            <span class="hljs-string">'post'</span>,
            <span class="hljs-string">'category_id'</span>,
            <span class="hljs-string">'category'</span>,
            <span class="hljs-string">'id'</span>,
            <span class="hljs-string">'CASCADE'</span>
        );
    }

    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// drops foreign key for table `user`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropForeignKey(
            <span class="hljs-string">'fk-post-author_id'</span>,
            <span class="hljs-string">'post'</span>
        );

        <span class="hljs-comment">// drops index for column `author_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropIndex(
            <span class="hljs-string">'idx-post-author_id'</span>,
            <span class="hljs-string">'post'</span>
        );

        <span class="hljs-comment">// drops foreign key for table `category`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropForeignKey(
            <span class="hljs-string">'fk-post-category_id'</span>,
            <span class="hljs-string">'post'</span>
        );

        <span class="hljs-comment">// drops index for column `category_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropIndex(
            <span class="hljs-string">'idx-post-category_id'</span>,
            <span class="hljs-string">'post'</span>
        );

        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post'</span>);
    }
}
</code></pre>
<p>Положение ключевого слова <code>foreignKey</code> в описании поля не изменяет сгенерированный код. Это значит, что:</p>
<ul>
<li><code>author_id:integer:notNull:foreignKey(user)</code></li>
<li><code>author_id:integer:foreignKey(user):notNull</code></li>
<li><code>author_id:foreignKey(user):integer:notNull</code></li>
</ul>
<p>Генерируют один и тот же код.</p>
<p>Ключевое слово <code>foreignKey</code> может принимать в скобках параметр, который будет использован в качестве имени таблицы для внешнего ключа. Если параметр не был передан, то имя таблицы будет извлечено из названия поля.</p>
<p>В приведенном выше примере <code>author_id:integer:notNull:foreignKey(user)</code> будет генерировать поле <code>author_id</code> с внешним ключом на таблицу <code>user</code>, а <code>category_id:integer:defaultValue(1):foreignKey</code> сгенерирует поле <code>category_id</code> с внешним ключом на таблицу <code>category</code>.</p>
<p>Начиная с версии 2.0.11, ключевое слово <code>foreignKey</code> может принимать второй параметр, который следует указывать через пробел.
Этот параметр будет использован в качестве имени поля внешнего ключа.
В случае, если второй параметр не будет передан, то поле для внешнего ключа будет извлечено из схемы таблицы.
Тем не менее, это справедливо только в тех случаях, когда таблица имеется в базе данных, первичный ключ задан и не является составным.
В иных случаях будет использоваться имя по умолчанию <code>id</code>.</p>
<h3 id="udalenie-tablicy">Удаление таблицы <a href="db-migrations.html#udalenie-tablicy" class="hashlink">&para;</a></h3><pre><code class="hljs php language-php">yii migrate/create drop_post_table --fields=title:string(<span class="hljs-number">12</span>):notNull:unique,body:text
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_drop_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post'</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string(<span class="hljs-number">12</span>)-&gt;notNull()-&gt;unique(),
            <span class="hljs-string">'body'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text()
        ]);
    }
}
</code></pre>
<h3 id="dobavlenie-stolbca">Добавление столбца <a href="db-migrations.html#dobavlenie-stolbca" class="hashlink">&para;</a></h3><p>Если имя миграции задано как <code>add_xxx_column_to_yyy_table</code>, файл будет содержать необходимые методы <code>addColumn</code> и <code>dropColumn</code>.</p>
<p>Для добавления столбца:</p>
<pre><code class="hljs php language-php">yii migrate/create add_position_column_to_post_table --fields=position:integer
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_add_position_column_to_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;addColumn(<span class="hljs-string">'post'</span>, <span class="hljs-string">'position'</span>, <span class="hljs-keyword">$this</span>-&gt;integer());
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropColumn(<span class="hljs-string">'post'</span>, <span class="hljs-string">'position'</span>);
    }
}
</code></pre>
<h3 id="udalenie-stolbca">Удаление столбца <a href="db-migrations.html#udalenie-stolbca" class="hashlink">&para;</a></h3><p>Если имя миграции задано как <code>drop_xxx_column_from_yyy_table</code>, файл будет содержать необходимые методы <code>addColumn</code> и <code>dropColumn</code>.</p>
<pre><code class="hljs php language-php">yii migrate/create drop_position_column_from_post_table --fields=position:integer
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150811_220037_drop_position_column_from_post_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;dropColumn(<span class="hljs-string">'post'</span>, <span class="hljs-string">'position'</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;addColumn(<span class="hljs-string">'post'</span>, <span class="hljs-string">'position'</span>, <span class="hljs-keyword">$this</span>-&gt;integer());
    }
}
</code></pre>
<h3 id="dobavlenie-promezutocnoj-tablicy">Добавление промежуточной таблицы <a href="db-migrations.html#dobavlenie-promezutocnoj-tablicy" class="hashlink">&para;</a></h3><p>Если имя миграции задано как <code>create_junction_table_for_xxx_and_yyy_tables</code>, файл будет содержать код для создания промежуточной таблицы.</p>
<pre><code class="hljs php language-php">yii migrate/create create_junction_table_for_post_and_tag_tables
</code></pre>
<p>сгенерирует</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">/**
 * Handles the creation for table `post_tag`.
 * Has foreign keys to the tables:
 *
 * - `post`
 * - `tag`
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m160328_041642_create_junction_table_for_post_and_tag_tables</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">up</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'post_tag'</span>, [
            <span class="hljs-string">'post_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;integer(),
            <span class="hljs-string">'tag_id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;integer(),
            <span class="hljs-string">'created_at'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;dateTime(),
            <span class="hljs-string">'PRIMARY KEY(post_id, tag_id)'</span>,
        ]);

        <span class="hljs-comment">// creates index for column `post_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;createIndex(
            <span class="hljs-string">'idx-post_tag-post_id'</span>,
            <span class="hljs-string">'post_tag'</span>,
            <span class="hljs-string">'post_id'</span>
        );

        <span class="hljs-comment">// add foreign key for table `post`</span>
        <span class="hljs-keyword">$this</span>-&gt;addForeignKey(
            <span class="hljs-string">'fk-post_tag-post_id'</span>,
            <span class="hljs-string">'post_tag'</span>,
            <span class="hljs-string">'post_id'</span>,
            <span class="hljs-string">'post'</span>,
            <span class="hljs-string">'id'</span>,
            <span class="hljs-string">'CASCADE'</span>
        );

        <span class="hljs-comment">// creates index for column `tag_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;createIndex(
            <span class="hljs-string">'idx-post_tag-tag_id'</span>,
            <span class="hljs-string">'post_tag'</span>,
            <span class="hljs-string">'tag_id'</span>
        );

        <span class="hljs-comment">// add foreign key for table `tag`</span>
        <span class="hljs-keyword">$this</span>-&gt;addForeignKey(
            <span class="hljs-string">'fk-post_tag-tag_id'</span>,
            <span class="hljs-string">'post_tag'</span>,
            <span class="hljs-string">'tag_id'</span>,
            <span class="hljs-string">'tag'</span>,
            <span class="hljs-string">'id'</span>,
            <span class="hljs-string">'CASCADE'</span>
        );
    }

    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">down</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-comment">// drops foreign key for table `post`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropForeignKey(
            <span class="hljs-string">'fk-post_tag-post_id'</span>,
            <span class="hljs-string">'post_tag'</span>
        );

        <span class="hljs-comment">// drops index for column `post_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropIndex(
            <span class="hljs-string">'idx-post_tag-post_id'</span>,
            <span class="hljs-string">'post_tag'</span>
        );

        <span class="hljs-comment">// drops foreign key for table `tag`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropForeignKey(
            <span class="hljs-string">'fk-post_tag-tag_id'</span>,
            <span class="hljs-string">'post_tag'</span>
        );

        <span class="hljs-comment">// drops index for column `tag_id`</span>
        <span class="hljs-keyword">$this</span>-&gt;dropIndex(
            <span class="hljs-string">'idx-post_tag-tag_id'</span>,
            <span class="hljs-string">'post_tag'</span>
        );

        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'post_tag'</span>);
    }
}
</code></pre>
<p>Начиная с версии 2.0.11, имена полей для внешних ключей промежуточной таблицы будут извлечены из объединяемых таблиц.
Тем не менее, это справедливо только в тех случаях, когда таблица имеется в базе данных, первичный ключ задан и не является составным.
В других иных случаях для поля будет сгенерировано значение по умолчанию <code>id</code>.</p>
<h3 id="transactional-migrations">Транзакции Миграций  <a href="db-migrations.html#transactional-migrations" class="hashlink">&para;</a></h3><p>При выполнении сложных миграций баз данных, важно обеспечить каждую миграцию либо успехом, либо ошибкой, в целом так, чтобы база данных могла поддерживать целостность и непротиворечивость. Для достижения данной цели рекомендуется, заключить операции каждой миграции базы данных в <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-dao#performing-transactions">транзакции</a>.</p>
<p>Самый простой способ реализации транзакций миграций это прописать код миграций в методы <code>safeUp()</code> и <code>safeDown()</code>. Эти два метода отличаются от методов <code>up()</code> и <code>down()</code> тем, что они неявно заключены в транзакции. В результате если какая-либо операция в этих методах не удается, все предыдущие операции будут отменены автоматически.</p>
<p>В следующем примере, помимо создания таблицы <code>news</code> мы также вставляем в этой таблице начальную строку.</p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Migration</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150101_185401_create_news_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeUp</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;createTable(<span class="hljs-string">'news'</span>, [
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;primaryKey(),
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;string()-&gt;notNull(),
            <span class="hljs-string">'content'</span> =&gt; <span class="hljs-keyword">$this</span>-&gt;text(),
        ]);

        <span class="hljs-keyword">$this</span>-&gt;insert(<span class="hljs-string">'news'</span>, [
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'test 1'</span>,
            <span class="hljs-string">'content'</span> =&gt; <span class="hljs-string">'content 1'</span>,
        ]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeDown</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;delete(<span class="hljs-string">'news'</span>, [<span class="hljs-string">'id'</span> =&gt; <span class="hljs-number">1</span>]);
        <span class="hljs-keyword">$this</span>-&gt;dropTable(<span class="hljs-string">'news'</span>);
    }
}
</code></pre>
<p>Обратите внимание, что обычно при выполнении нескольких операций в базе данных при помощи метода <code>safeUp()</code>, вы должны
реализовать обратный порядок исполнения в методе <code>safeDown()</code>. В приведенном выше примере мы сначала создали таблицу,
а затем вставили строку в <code>safeUp()</code>; а в <code>safeDown()</code> мы сначала удаляем строку и затем удаляем таблицу.</p>
<blockquote class="note"><p><strong>Примечание: </strong>Не все СУБД поддерживают транзакции. И некоторые запросы к базам данных не могут быть введены в транзакции.
Для различных примеров, пожалуйста, обратитесь к <a href="http://dev.mysql.com/doc/refman/5.7/en/implicit-commit.html">негласным обязательствам</a>.
В этом случае вместо этих методов вы должны реализовать методы <code>up()</code> и <code>down()</code>.</p>
</blockquote>
<h3 id="db-accessing-methods">Методы доступа к базе данных  <a href="db-migrations.html#db-accessing-methods" class="hashlink">&para;</a></h3><p>Базовый класс миграции <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration">yii\db\Migration</a> предоставляет набор методов, которые позволяют Вам получить доступ и управлять
базами данных. Вы можете найти эти методы, их названия аналогичны <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-dao">методам DAO</a>, предоставленным в классе <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-command">yii\db\Command</a>.
Например, метод <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#createTable()-detail">yii\db\Migration::createTable()</a> позволяет создать новую таблицу, подобно методу <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-command#createTable()-detail">yii\db\Command::createTable()</a>.</p>
<p>Преимущество методов, описанных при помощи <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration">yii\db\Migration</a> заключается в том, что Вам не нужно явно создавать
экземпляр/копию <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-command">yii\db\Command</a> и исполнение каждого метода будет автоматически отображать полезные сообщения
говорящие вам, что операции с базой данных выполняются и сколько они идут.</p>
<p>Ниже представлен список всех этих методов доступа к базам данных:</p>
<ul>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#execute()-detail">execute()</a>: выполнение SQL инструкции</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#insert()-detail">insert()</a>: вставка одной строки</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#batchInsert()-detail">batchInsert()</a>: вставка нескольких строк</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#update()-detail">update()</a>: обновление строк</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#delete()-detail">delete()</a>: удаление строк</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#createTable()-detail">createTable()</a>: создание таблицы</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#renameTable()-detail">renameTable()</a>: переименование таблицы</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#dropTable()-detail">dropTable()</a>: удаление таблицы</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#truncateTable()-detail">truncateTable()</a>: удаление всех строк в таблице</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#addColumn()-detail">addColumn()</a>: добавление столбца</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#renameColumn()-detail">renameColumn()</a>: переименование столбца</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#dropColumn()-detail">dropColumn()</a>: удаление столбца</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#alterColumn()-detail">alterColumn()</a>: изменения столбца</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#addPrimaryKey()-detail">addPrimaryKey()</a>: добавление первичного ключа</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#dropPrimaryKey()-detail">dropPrimaryKey()</a>: удаление первичного ключа</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#addForeignKey()-detail">addForeignKey()</a>: добавление внешнего ключа</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#dropForeignKey()-detail">dropForeignKey()</a>: удаление внешнего ключа</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#createIndex()-detail">createIndex()</a>: создание индекса</li>
<li><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#dropIndex()-detail">dropIndex()</a>: удаление индекса</li>
</ul>
<blockquote class="info"><p><strong>Информация: </strong><a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration">yii\db\Migration</a> не предоставляет методы запросов к базе данных. Это потому, что обычно не требуется отображать дополнительные сообщения об извлечении данных из базы данных. Это также, потому, что можно использовать более мощный <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-query-builder">Построитель Запросов</a> для построения и выполнения сложных запросов.</p>
</blockquote>
<blockquote class="note"><p><strong>Примечание: </strong>при обработке данных внутри миграции, может показаться, что использование существующих классов <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-active-record">Active Record</a>, со всей их готовой бизнес логикой, будет разумным решением и упросит код миграции. Однако следует помнить, что код миграций не должен меняться, по определению. В отличие от миграций, бизнес логика приложений часто изменяется. Это может привести к нарушению работы миграции при определённых изменениях на уровне Active Record. Поэтому рекомендуется делать миграции независимыми от других частей приложения, таких как классы Active Record.</p>
</blockquote>
<h2 id="applying-migrations">Применение Миграций  <a href="db-migrations.html#applying-migrations" class="hashlink">&para;</a></h2><p>Для обновления базы данных до последней структуры, вы должны применить все новые миграции, используя следующую команду:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate
</code></pre>
<p>Эта команда выведет список всех миграций, которые не применялись до сих пор. Если вы подтвердите, что вы хотите применить эти миграций, то этим самым запустите метод <code>up()</code> или <code>safeUp()</code> в каждом новом классе миграции, один за другим, в порядке их временного значения timestamp.</p>
<p>Для каждой миграции которая была успешно проведена, эта команда будет вставлять строку в таблицу базы данных с именем
<code>migration</code> записав успешное проведение миграции. Это позволяет инструменту миграции выявлять какие миграции были применены, а какие - нет.</p>
<blockquote class="note"><p><strong>Примечание: </strong>Инструмент миграции автоматически создаст таблицу <code>migration</code> в базе данных указанной в параметре <a href="https://www.yiiframework.com/doc/api/2.0/yii-console-controllers-migratecontroller#$db-detail">db</a>. По умолчанию база данных определяется как <a href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-application-components">компонент приложения</a> <code>db</code>.</p>
</blockquote>
<p>Иногда, необходимо применить одну или несколько новых миграций, вместо всех доступных миграций. Это возможно сделать, указав, при выполнении команды, количество миграций, которые необходимо применить. Например, следующая команда будет пытаться применить следующие три доступные миграции:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate <span class="hljs-number">3</span>
</code></pre>
<p>Также можно явно указать конкретную миграцию, которая должна быть применена к базе данных, это можно сделать при помощи команды <code>migrate/to</code> в одном из следующих форматов:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/to 150101_185401                      <span class="hljs-comment"># используя временную метку определяющую миграцию</span>
yii migrate/to <span class="hljs-string">"2015-01-01 18:54:01"</span>              <span class="hljs-comment"># используя строку, которая может быть получена путем использования функции strtotime()</span>
yii migrate/to m150101_185401_create_news_table   <span class="hljs-comment"># используя полное имя</span>
yii migrate/to <span class="hljs-number">1392853618</span>                         <span class="hljs-comment"># используя временную метку UNIX</span>
</code></pre>
<p>Если раньше имелись какие-либо не применённые миграции, до указанной конкретной миграции, то все они будут применены до данной миграции.
А если указанная миграция уже применялась ранее, то любые более поздние версии данной прикладной миграции будут отменены.</p>
<h2 id="reverting-migrations">Отмена Миграций  <a href="db-migrations.html#reverting-migrations" class="hashlink">&para;</a></h2><p>Чтобы отменить (откатить) одну или несколько миграций, которые применялись ранее, нужно запустить следующую команду:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/down     <span class="hljs-comment"># отменяет самую последнюю применённую миграцию</span>
yii migrate/down <span class="hljs-number">3</span>   <span class="hljs-comment"># отменяет 3 последних применённых миграции</span>
</code></pre>
<blockquote class="note"><p><strong>Примечание: </strong>Не все миграции являются обратимыми. При попытке отката таких миграций произойдёт ошибка и остановится весь процесс отката.</p>
</blockquote>
<h2 id="redoing-migrations">Перезагрузка Миграций  <a href="db-migrations.html#redoing-migrations" class="hashlink">&para;</a></h2><p>Под перезагрузкой миграций подразумевается, сначала последовательный откат определённых миграций, а потом применение их снова. Это может быть сделано следующим образом:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/redo        <span class="hljs-comment"># перезагрузить последнюю применённую миграцию</span>
yii migrate/redo <span class="hljs-number">3</span>      <span class="hljs-comment"># перезагрузить 3 последние применённые миграции</span>
</code></pre>
<blockquote class="note"><p><strong>Примечание: </strong>Если миграция не является обратимой, вы не сможете её перезагрузить.</p>
</blockquote>
<h2 id="listing-migrations">Список Миграций  <a href="db-migrations.html#listing-migrations" class="hashlink">&para;</a></h2><p>Чтобы посмотреть какие миграции были применены, а какие нет, используйте следующие команды:</p>
<pre><code class="hljs bash">yii migrate/<span class="hljs-built_in">history</span>     <span class="hljs-comment"># показать последних 10 применённых миграций</span>
yii migrate/<span class="hljs-built_in">history</span> 5   <span class="hljs-comment"># показать последних 5 применённых миграций</span>
yii migrate/<span class="hljs-built_in">history</span> all <span class="hljs-comment"># показать все применённые миграции</span>

yii migrate/new         <span class="hljs-comment"># показать первых 10 новых миграций</span>
yii migrate/new 5       <span class="hljs-comment"># показать первых 5 новых миграций</span>
yii migrate/new all     <span class="hljs-comment"># показать все новые миграции</span>
</code></pre>
<h2 id="modifying-migration-history">Изменение Истории Миграций  <a href="db-migrations.html#modifying-migration-history" class="hashlink">&para;</a></h2><p>Вместо применения или отката миграций, есть возможность просто <b>отметить</b>, что база данных была обновлена до определенной миграции. Это часто используется при ручном изменении базы данных в конкретное состояние и Вам не нужно применять миграции для того, чтобы это изменение было повторно применено позже. Этой цели можно добиться с помощью следующей команды:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/mark 150101_185401                      <span class="hljs-comment"># используя временную метку определённой миграции</span>
yii migrate/mark <span class="hljs-string">"2015-01-01 18:54:01"</span>              <span class="hljs-comment"># используя строку, которая может быть получена путем использования функции strtotime()</span>
yii migrate/mark m150101_185401_create_news_table   <span class="hljs-comment"># используя полное имя</span>
yii migrate/mark <span class="hljs-number">1392853618</span>                         <span class="hljs-comment"># используя временную метку UNIX</span>
</code></pre>
<p>Эта команда изменит таблицу <code>migration</code> добавив или удалив определенные строки, тем самым указав, что к базе данных была применена указанная миграция. Никаких миграций не будет применяться или отменяться по этой команде.</p>
<h2 id="customizing-migrations">Настройка Миграций  <a href="db-migrations.html#customizing-migrations" class="hashlink">&para;</a></h2><p>Есть несколько способов настроить команду миграции.</p>
<h3 id="using-command-line-options">Используя параметры командной строки <a href="db-migrations.html#using-command-line-options" class="hashlink">&para;</a></h3><p>В команду миграций входит несколько параметров командной строки, которые могут использоваться, для того, чтобы настроить
поведение миграции:</p>
<ul>
<li><p><code>interactive</code>: логический тип - boolean (по умолчанию <code>true</code>). Указывает, следует ли выполнять миграцию в интерактивном
режиме. Если это значение является - <code>true</code>, то пользователю будет выдан запрос, перед выполнением командой определенных
действий. Вы можете установить это значение в <code>false</code> если команда используется в фоновом режиме.</p>
</li>
<li><p><code>migrationPath</code>: строка - string (по умолчанию <code>@app/migrations</code>). Указывает каталог для хранения всех файлов классов
миграций. Этот параметр может быть определён либо как путь до директории, либо как <a href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-aliases">псевдоним</a> пути.
Обратите внимание, что данный каталог должен существовать, иначе команда будет выдавать ошибку.</p>
</li>
<li><p><code>migrationTable</code>: строка - string (по умолчанию <code>migration</code>). Определяет имя таблицы в базе данных в которой хранится
информация об истории миграций. Эта таблица будет автоматически создана командой миграции, если её не существует.
Вы также можете создать её вручную, используя структуру <code>version varchar(255) primary key, apply_time integer</code>.</p>
</li>
<li><p><code>db</code>: строка - string (по умолчанию <code>db</code>). Определяет ID базы данных <a href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-application-components">компонента приложения</a>.
Этот параметр представляет собой базу данных, которая подвергается миграциям при помощи команды миграций.</p>
</li>
<li><p><code>templateFile</code>: строка - string (по умолчанию <code>@yii/views/migration.php</code>). Указывает путь до файла шаблона, который
используется для формирования скелета класса файлов миграции. Этот параметр может быть определён либо как путь до файла,
либо как <a href="https://www.yiiframework.com/doc/guide/2.0/ru/concept-aliases">псевдоним</a> пути. Файл шаблона - это PHP скрипт, в котором можно использовать
предопределенную переменную с именем <code>$className</code> для того, чтобы получить имя класса миграции.</p>
</li>
<li><p><code>generatorTemplateFiles</code>: массив (по умолчанию `[</p>
<pre><code class="hljs php">  <span class="hljs-string">'create_table'</span> =&gt; <span class="hljs-string">'@yii/views/createTableMigration.php'</span>,
  <span class="hljs-string">'drop_table'</span> =&gt; <span class="hljs-string">'@yii/views/dropTableMigration.php'</span>,
  <span class="hljs-string">'add_column'</span> =&gt; <span class="hljs-string">'@yii/views/addColumnMigration.php'</span>,
  <span class="hljs-string">'drop_column'</span> =&gt; <span class="hljs-string">'@yii/views/dropColumnMigration.php'</span>,
  <span class="hljs-string">'create_junction'</span> =&gt; <span class="hljs-string">'@yii/views/createTableMigration.php'</span>
</code></pre>
<p>]`), в котором указаны файлы шаблонов для генерации миграций. Подробнее в разделе «<a href="db-migrations.html#generating-migrations">Генерация миграций</a>».</p>
</li>
<li><p><code>fields</code>: массив конфигураций столбцов, который используется для генерации кода миграции. По умолчанию пуст. Формат
каждой конфигурации <code>ИМЯ_СТОЛБЦА:ТИП_СТОЛБЦА:ДЕКОРАТОР_СТОЛБЦА</code>. Например, <code>--fields=name:string(12):notNull</code> даст нам
столбец типа строка размера 12 с ограничением <code>not null</code>.</p>
</li>
</ul>
<p>В следующем примере показано, как можно использовать эти параметры.</p>
<p>Например, если мы хотим перенести модуль <code>forum</code>, чьи файлы миграций расположены в каталоге <code>migrations</code> данного модуля,
для этого мы можем использовать следующую команду:</p>
<pre><code class="hljs nginx"><span class="hljs-comment"># не интерактивная миграция модуля форума</span>
<span class="hljs-attribute">yii</span> migrate --migrationPath=<span class="hljs-variable">@app</span>/modules/forum/migrations --interactive=<span class="hljs-number">0</span>
</code></pre>
<h3 id="configuring-command-globally">Глобальная настройка команд  <a href="db-migrations.html#configuring-command-globally" class="hashlink">&para;</a></h3><p>Вместо того, чтобы каждый раз вводить одинаковые значения параметров миграции, когда вы запускаете команду миграции,
можно настроить её раз и навсегда в конфигурации приложения, как показано ниже:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'controllerMap'</span> =&gt; [
        <span class="hljs-string">'migrate'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\console\controllers\MigrateController'</span>,
            <span class="hljs-string">'migrationTable'</span> =&gt; <span class="hljs-string">'backend_migration'</span>,
        ],
    ],
];
</code></pre>
<p>С приведённой выше конфигурацией, каждый раз при запуске команды миграции, таблица <code>backend_migration</code> будет использована для записи истории миграций. И Вам больше не нужно указывать её через параметр <code>migrationTable</code> в командной строке.</p>
<h3 id="namespaced-migrations">Миграции с пространством имен  <a href="db-migrations.html#namespaced-migrations" class="hashlink">&para;</a></h3><p>Начиная с версии 2.0.10 вы можете использовать пространства имен при объявлении класса миграции. Вы можете указать список пространств
имен миграций через <a href="https://www.yiiframework.com/doc/api/2.0/yii-console-controllers-basemigratecontroller#$migrationNamespaces-detail">migrationNamespaces</a>. Использование пространств
имен для классов миграции позволяет сочетать несколько источников миграций. Например:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'controllerMap'</span> =&gt; [
        <span class="hljs-string">'migrate'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\console\controllers\MigrateController'</span>,
            <span class="hljs-string">'migrationNamespaces'</span> =&gt; [
                <span class="hljs-string">'app\migrations'</span>, <span class="hljs-comment">// Общие миграции приложения</span>
                <span class="hljs-string">'module\migrations'</span>, <span class="hljs-comment">// Миграции одного из модулей проекта</span>
                <span class="hljs-string">'some\extension\migrations'</span>, <span class="hljs-comment">// Миграции одного из расширений</span>
            ],
        ],
    ],
];
</code></pre>
<blockquote><p>Замечание: миграции из различных пространств имен образуют <strong>единую</strong> историю, т.е. вы не сможете
  применить или откатить миграции из одного конкретного пространства имен.</p>
</blockquote>
<p>Работая с миграциями по пространствам имен: при создании, отмене и т.д., следует указывать полное имя пространства имен
перед именем миграции. Имейте в виду, что символ обратного слеша (<code>\</code>), как правило, является специальным символом в консоли,
так что вам придется экранировать его соответствующим образом во избежание ошибок или неверного поведения. Например:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate/create <span class="hljs-string">'app\\migrations\\createUserTable'</span>
</code></pre>
<blockquote><p>Замечание: миграции заданные через <a href="https://www.yiiframework.com/doc/api/2.0/yii-console-controllers-basemigratecontroller#$migrationPath-detail">migrationPath</a> не могут содержать
  пространство имен, миграции, объявленные с пространством имен, могут быть применены только используя свойство <a href="https://www.yiiframework.com/doc/api/2.0/yii-console-controllers-basemigratecontroller#$migrationNamespaces-detail">yii\console\controllers\MigrateController::$migrationNamespaces</a>.</p>
</blockquote>
<h3 id="separated-migrations">Отдельностоящие Миграции  <a href="db-migrations.html#separated-migrations" class="hashlink">&para;</a></h3><p>Иногда использование единой истории для всех миграций проекта не желательно. Например: вы можете установить расширение
'blog', которое содержит полностью независимый функционал и содержит собственные миграции, которые не должны затрагивать
миграции связанные с основной функциональностью проекта.</p>
<p>Если необходимо, чтобы миграции из разных источников были независимы друг от друга, вы можете сконфигурировать
несколько команд миграции, которые будут использовать разные пространства имён и разные таблицы для хранения истории
миграций:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">return</span> [
    <span class="hljs-string">'controllerMap'</span> =&gt; [
        <span class="hljs-comment">// Общие миграции приложения</span>
        <span class="hljs-string">'migrate-app'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\console\controllers\MigrateController'</span>,
            <span class="hljs-string">'migrationNamespaces'</span> =&gt; [<span class="hljs-string">'app\migrations'</span>],
            <span class="hljs-string">'migrationTable'</span> =&gt; <span class="hljs-string">'migration_app'</span>,
        ],
        <span class="hljs-comment">// Миграции одного из модулей проекта</span>
        <span class="hljs-string">'migrate-module'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\console\controllers\MigrateController'</span>,
            <span class="hljs-string">'migrationNamespaces'</span> =&gt; [<span class="hljs-string">'module\migrations'</span>],
            <span class="hljs-string">'migrationTable'</span> =&gt; <span class="hljs-string">'migration_module'</span>,
        ],
        <span class="hljs-comment">// Миграции одного из расширений</span>
        <span class="hljs-string">'migrate-rbac'</span> =&gt; [
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\console\controllers\MigrateController'</span>,
            <span class="hljs-string">'migrationPath'</span> =&gt; <span class="hljs-string">'@yii/rbac/migrations'</span>,
            <span class="hljs-string">'migrationTable'</span> =&gt; <span class="hljs-string">'migration_rbac'</span>,
        ],
    ],
];
</code></pre>
<p>Учтите, что для синхронизации базы данных при такой конфигурации потребуется вызвать несколько команд вместо одной:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate-app
yii migrate-module
yii migrate-rbac
</code></pre>
<h2 id="migrating-multiple-databases">Миграции в Несколько Баз Данных  <a href="db-migrations.html#migrating-multiple-databases" class="hashlink">&para;</a></h2><p>По умолчанию, миграции применяются для базы данных, указанной в <code>db</code> <a href="https://www.yiiframework.com/doc/guide/2.0/ru/structure-application-components">компоненте приложения</a>.
Если вы хотите применить миграцию к другой базе данных, вы можете определить параметр <code>db</code> в командной строке как показано ниже,</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate --db=db2
</code></pre>
<p>Приведенная выше команда применит миграции к базе данных <code>db2</code>.</p>
<p>Иногда может случиться так, что вы захотите применить <em>некоторые</em> из миграций к одной базе данных, а некоторые другие к другой базе данных. Для достижения этой цели, при реализации класса миграции, необходимо явно указать идентификатор ID компонента базы данных, который миграция будет использовать, следующим образом:</p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">db</span>\<span class="hljs-title">Migration</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">m150101_185401_create_news_table</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Migration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">$this</span>-&gt;db = <span class="hljs-string">'db2'</span>;
        <span class="hljs-keyword">parent</span>::init();
    }
}
</code></pre>
<p>Вышеуказанная миграция будет применена к <code>db2</code> даже если указать другую базу данных через параметр <code>db</code> командной строки. Обратите внимание, что история миграций в этом случае будет записана в базу данных, указанную в параметре <code>db</code> командной строки.</p>
<p>Если у вас есть несколько миграций, которые используют ту же другую базу данных, то рекомендуется создать базовый класс миграций выше кода <code>init()</code>. Затем каждый класс миграции может расширяться от этого базового класса.</p>
<blockquote><p>Совет: Кроме установки свойства <a href="https://www.yiiframework.com/doc/api/2.0/yii-db-migration#$db-detail">db</a>, вы также можете работать с разными базами данных путем создания нового соединения с конкретной базой данных в классе Вашей миграции. Можно использовать <a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-dao">DAO методы</a> с этими соединениями для манипулирования различными базами данных.</p>
</blockquote>
<p>Другая стратегия, которую вы можете выбрать, чтобы перенести (мигрировать) несколько баз данных - это сохранить миграции различных баз данных в разные директории. Затем вы можете перенести эти базы данных в нужные базы следующими командами:</p>
<pre><code class="hljs nginx"><span class="hljs-attribute">yii</span> migrate --migrationPath=<span class="hljs-variable">@app</span>/migrations/db1 --db=db1
yii migrate --migrationPath=<span class="hljs-variable">@app</span>/migrations/db2 --db=db2
...
</code></pre>
<p>Первая команда применит миграции в директории <code>@app/migrations/db1</code> к базе данных <code>db1</code>, а вторая команда применит миграции в директории <code>@app/migrations/db2</code> к базе данных <code>db2</code> и так далее.</p>

    <div class="prev-next">
        <div class="prev-next__left"><a href="https://www.yiiframework.com/doc/guide/2.0/ru/db-active-record"><span class="chevron-left" aria-hidden="true"></span> Active Record</a></div><div class="prev-next__center"><a href="db-migrations.html#top">Go to Top <span class="chevron-up" aria-hidden="true"></span></a></div><div class="prev-next__right"><a href="https://www.yiiframework.com/doc/guide/2.0/ru/input-forms">Получение данных от пользователя: Создание форм <span class="chevron-right" aria-hidden="true"></span></a></div>    </div>

        <div class="edit-box">
        <div class="edit-icon"><i class="fa fa-github"></i></div>
        <p class="lang-en">
            Found a typo or you think this page needs improvement?<br />
                <a href="https://github.com/yiisoft/yii2/edit/master/docs/guide-ru/db-migrations.md">Edit it on github</a> !
        </p>
    </div>
    
</div>
        </div>
    </div>
</div>

    <div class="comments-wrapper">
        <div class="container comments">
            
<div class="row" id="user-notes">
    <div class="col-md-offset-2 col-md-9">
                    <span class="heading">User Contributed Notes</span>
            </div>
</div>
<div class="row">
    <div class="col-md-offset-2 col-md-9">
        <div class="component-comments lang-en" id="comments">
                    </div>
    </div>
</div>
<div class="row">
    <div class="col-md-offset-2 col-md-9">
        <span class="heading">Leave a comment</span>
    </div>
</div>
<div class="row">
    <div class="col-md-offset-2 col-md-9">
                    <p><a href="https://www.yiiframework.com/signup">Signup</a> or <a href="https://www.yiiframework.com/login">Login</a> in order to comment.</p>
            </div>
</div>
        </div>
    </div>

            <div class="footer-wrapper">
    <footer>
        <div class="container">
            <div class="footer-inner">
                <div class="row">
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
  <li class="footerList_item">
    <div>About</div>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/doc/guide/2.0/en/intro-yii">About Yii</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/news">News</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/license">License</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/contact">Contact Us</a>  </li>
</ul>
                    </div>
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
  <li class="footerList_item">
    <div>Downloads</div>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/download">Framework</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/download#offline-documentation">Documentation</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/extensions">Extensions</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/logo">Logo</a>  </li>
</ul>
                    </div>
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
  <li class="footerList_item">
    <div>Documentation</div>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/doc/guide">Guide</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/doc/api">API</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/wiki">Wiki</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/resources">Resources</a>  </li>
</ul>
                    </div>
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
  <li class="footerList_item">
    <div>Development</div>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/contribute">Contribute</a>  </li>
  <li class="footerList_item">
    <a href="https://github.com/yiisoft/yii2/commits/master" rel="noopener noreferrer" target="_blank">Latest Updates</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/report-issue">Report a Bug</a>  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/security">Report Security Issue</a>  </li>
</ul>
                    </div>
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
    <li class="footerList_item">
        <div>Community</div>
    </li>
    <li class="footerList_item">
        <a href="https://www.yiiframework.com/forum">Forum</a>    </li>
    <li class="footerList_item">
        <a href="https://www.yiiframework.com/chat">Live Chat</a>    </li>
    <li class="footerList_item">
        <a href="https://www.facebook.com/groups/yiitalk/" target="_blank" rel="noopener noreferrer">Facebook Group</a>
    </li>
    <li class="footerList_item">
        <a href="https://www.yiiframework.com/user/halloffame">Hall of Fame</a>    </li>
    <li class="footerList_item">
        <a href="https://www.yiiframework.com/badges">Badges</a>    </li>
</ul>
                    </div>
                    <div class="col-md-2 col-sm-4 hidden-xs">
                        <ul class="footerList">
  <li class="footerList_item">
      <span class="social">
          <a href="https://github.com/yiisoft" aria-label="GitHub Account" target="_blank" rel="noopener noreferrer"><i class="fa fa-github"></i></a>
          <a href="https://twitter.com/yiiframework" aria-label="Twitter Account" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter"></i></a>
          <a href="https://www.facebook.com/groups/yiitalk/" aria-label="Facebook Group" target="_blank" rel="noopener noreferrer"><i class="fa fa-facebook"></i></a>
          <a href="https://www.yiiframework.com/rss.xml" aria-label="RSS Feed"><i class="fa fa-rss"></i></a>      </span>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/tos">Terms of service</a>  </li>
  <li class="footerList_item">
      <a href="https://www.yiiframework.com/license">License</a>  </li>
  <li class="footerList_item">
      <a href="https://github.com/yiisoft-contrib/yiiframework.com" target="_blank" rel="noopener noreferrer">Website Source Code</a>
  </li>
  <li class="footerList_item">
      &nbsp;
  </li>
  <li class="footerList_item">
    &copy; 2008 - 2022 Yii
  </li>
  <li class="footerList_item">
      Design: <a href="https://www.eshill.ru/" target="_blank" rel="noopener noreferrer">Eshill</a>
  </li>
</ul>
                    </div>
                    <div class="col-xs-12 hidden-sm hidden-md hidden-lg">
                        <div class="center-block">
                            <div>
                                <ul class="footerList">
  <li class="footerList_item">
      <span class="social">
          <a href="https://github.com/yiisoft" aria-label="GitHub Account" target="_blank" rel="noopener noreferrer"><i class="fa fa-github"></i></a>
          <a href="https://twitter.com/yiiframework" aria-label="Twitter Account" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter"></i></a>
          <a href="https://www.facebook.com/groups/yiitalk/" aria-label="Facebook Group" target="_blank" rel="noopener noreferrer"><i class="fa fa-facebook"></i></a>
          <a href="https://www.yiiframework.com/rss.xml" aria-label="RSS Feed"><i class="fa fa-rss"></i></a>      </span>
  </li>
  <li class="footerList_item">
    <a href="https://www.yiiframework.com/tos">Terms of service</a>  </li>
  <li class="footerList_item">
      <a href="https://www.yiiframework.com/license">License</a>  </li>
  <li class="footerList_item">
      <a href="https://github.com/yiisoft-contrib/yiiframework.com" target="_blank" rel="noopener noreferrer">Website Source Code</a>
  </li>
  <li class="footerList_item">
      &nbsp;
  </li>
  <li class="footerList_item">
    &copy; 2008 - 2022 Yii
  </li>
  <li class="footerList_item">
      Design: <a href="https://www.eshill.ru/" target="_blank" rel="noopener noreferrer">Eshill</a>
  </li>
</ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12 text-center">
                        <ul class="footerList">
    <li class="footerList_item">
        <div>Supported by</div>
    </li>
    <li class="footerList_item">
            <a href="https://opencollective.com/yiisoft" aria-label="OpenCollective" target="_blank" rel="noopener
            noreferrer"><img
                    alt="OpenCollective" height="40" src="https://www.yiiframework.com/image/collective.png"/></a>
    </li>
    <li class="footerList_item">
        <a href="https://www.jetbrains.com/?from=yii" aria-label="JetBrains website" target="_blank" rel="noopener
        noreferrer"><img
                alt="JetBrains logo" width="80" src="https://www.yiiframework.com/image/jetbrains.svg"/></a>
    </li>
</ul>




                    </div>
                </div>
            </div>
        </div>
    </footer>
</div>

        </div> <!-- close the id="page-wrapper" -->

        <script src="https://www.yiiframework.com/assets/85247087/js/all.min.js?v=1645275708"></script>
<script>jQuery(function ($) {

  $('[data-toggle="offcanvas"]').click(function () {
    $('.row-offcanvas').toggleClass('active')
  });

});</script>    </body>
</html>
