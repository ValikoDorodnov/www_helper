<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: Магические методы - Manual </title>

 <link rel="shortcut icon" href="https://www.php.net/favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="language.oop5.magic.php.html">
 <link rel="shorturl" href="https://www.php.net/oop5.magic">
 <link rel="alternate" href="https://www.php.net/oop5.magic" hreflang="x-default">

 <link rel="contents" href="https://www.php.net/manual/ru/index.php">
 <link rel="index" href="https://www.php.net/manual/ru/language.oop5.php">
 <link rel="prev" href="https://www.php.net/manual/ru/language.oop5.iterations.php">
 <link rel="next" href="https://www.php.net/manual/ru/language.oop5.final.php">

 <link rel="alternate" href="https://www.php.net/manual/en/language.oop5.magic.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/language.oop5.magic.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/language.oop5.magic.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/language.oop5.magic.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/language.oop5.magic.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/language.oop5.magic.php" hreflang="ja">
 <link rel="alternate" href="language.oop5.magic.php.html" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/language.oop5.magic.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/language.oop5.magic.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="https://www.php.net/cached.php?t=1639034403&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="https://www.php.net/cached.php?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="https://www.php.net/cached.php?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="https://www.php.net/cached.php?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base href="">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="https://www.php.net/" class="brand"><img src="https://www.php.net/images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="https://www.php.net/downloads">Downloads</a></li>
      <li class="active"><a href="https://www.php.net/docs.php">Documentation</a></li>
      <li class=""><a href="https://www.php.net/get-involved" >Get Involved</a></li>
      <li class=""><a href="https://www.php.net/support">Help</a></li>
      <li class="">
        <a href="https://www.php.net/releases/8.1/index.php">
          <img src="https://www.php.net/images/php8/logo_php8_1.svg" alt="php8.1" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="https://www.php.net/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<nav id="trick"><div><dl>
<dt><a href='https://www.php.net/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='https://www.php.net/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='https://www.php.net/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='https://www.php.net/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='https://www.php.net/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='https://www.php.net/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='https://www.php.net/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/security.php'>Security</a></dt>
	<dd><a href='https://www.php.net/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='https://www.php.net/manual/en/features.php'>Features</a></dt>
	<dd><a href='https://www.php.net/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='https://www.php.net/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='https://www.php.net/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='https://www.php.net/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='https://www.php.net/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="https://www.php.net/manual/ru/language.oop5.final.php">
          Ключевое слово final &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="https://www.php.net/manual/ru/language.oop5.iterations.php">
          &laquo; Итераторы объектов        </a>
      </div>
          <ul>
            <li><a href='https://www.php.net/manual/ru/index.php'>Руководство по PHP</a></li>      <li><a href='https://www.php.net/manual/ru/langref.php'>Справочник языка</a></li>      <li><a href='https://www.php.net/manual/ru/language.oop5.php'>Классы и объекты</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="https://www.php.net/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/language.oop5.magic.php'>English</option>
            <option value='pt_BR/language.oop5.magic.php'>Brazilian Portuguese</option>
            <option value='zh/language.oop5.magic.php'>Chinese (Simplified)</option>
            <option value='fr/language.oop5.magic.php'>French</option>
            <option value='de/language.oop5.magic.php'>German</option>
            <option value='ja/language.oop5.magic.php'>Japanese</option>
            <option value='ru/language.oop5.magic.php' selected="selected">Russian</option>
            <option value='es/language.oop5.magic.php'>Spanish</option>
            <option value='tr/language.oop5.magic.php'>Turkish</option>
            <option value="help-translate.php">Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-ru/blob/master/language/oop5/magic.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-ru/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Flanguage.oop5.magic%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="language.oop5.magic" class="sect1">
 <h2 class="title">Магические методы</h2>
 <p class="para">
  Магические методы - это специальные методы, которые переопределяют действие PHP по умолчанию, когда над объектом выполняются определённые действия.
 </p>
 <div class="caution"><strong class="caution">Предостережение</strong>
  <p class="simpara">
   Все имена методов, начинающиеся с <code class="literal">__</code>, зарезервированы PHP.
   Не рекомендуется использовать имена методов с __ в PHP, если вы не хотите использовать соответствующую
   магическую функциональность.
  </p>
 </div>
 <p class="para">
  Следующие названия методов считаются магическими:
  <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.construct" class="link">__construct()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.destruct" class="link">__destruct()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.call" class="link">__call()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.callstatic" class="link">__callStatic()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.get" class="link">__get()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.set" class="link">__set()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.isset" class="link">__isset()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.overloading.php#object.unset" class="link">__unset()</a>,
  <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>,
  <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>,
  <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>,
  <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a>,
  <a href="language.oop5.magic.php.html#object.tostring" class="link">__toString()</a>,
  <a href="language.oop5.magic.php.html#object.invoke" class="link">__invoke()</a>,
  <a href="language.oop5.magic.php.html#object.set-state" class="link">__set_state()</a>,
  <a href="https://www.php.net/manual/ru/language.oop5.cloning.php#object.clone" class="link">__clone()</a> и
  <a href="language.oop5.magic.php.html#object.debuginfo" class="link">__debugInfo()</a>
 </p>

 <div class="warning"><strong class="warning">Внимание</strong>
  <p class="simpara">
   Все магические методы, за исключением
   <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.construct" class="link">__construct()</a>,
   <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.destruct" class="link">__destruct()</a> и
   <a href="https://www.php.net/manual/ru/language.oop5.cloning.php#object.clone" class="link">__clone()</a>,
   <em class="emphasis">ДОЛЖНЫ</em> быть объявлены как <code class="literal">public</code>,
   в противном случае будет вызвана ошибка уровня <strong><code>E_WARNING</code></strong>.
   До PHP 8.0.0 для магических методов
   <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>,
   <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>,
   <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>,
   <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a> и
   <a href="language.oop5.magic.php.html#object.set-state" class="link">__set_state()</a>
   не выполнялась проверка.
  </p>
 </div>
 <div class="warning"><strong class="warning">Внимание</strong>
  <p class="para">
   Если объявления типа используются в определении магического метода, они должны быть идентичны сигнатуре, описанной в этом документе.
   В противном случае выдаётся фатальная ошибка.
   До PHP 8.0.0 диагностические сообщения не отправлялись.
   Однако <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.construct" class="link">__construct()</a> и
    <a href="https://www.php.net/manual/ru/language.oop5.decon.php#object.destruct" class="link">__destruct()</a> не должны объявлять возвращаемый тип; в противном случае выдаётся фатальная ошибка.
  </p>
 </div>

 <div class="sect2" id="language.oop5.magic.sleep">
  <h3 class="title">
   <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a> и
   <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>
  </h3>

  <div class="methodsynopsis dc-description" id="object.sleep">
   <span class="modifier">public</span> <span class="methodname"><strong>__sleep</strong></span>(): <span class="type">array</span></div>

  <div class="methodsynopsis dc-description" id="object.wakeup"><span class="modifier">public</span> <span class="methodname"><strong>__wakeup</strong></span>(): <span class="type"><span class="type void">void</span></span></div>


  <p class="para">
   Функция <span class="function"><a href="https://www.php.net/manual/ru/function.serialize.php" class="function">serialize()</a></span> проверяет, присутствует ли в
   классе метод с магическим именем <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>.
   Если это так, то этот метод выполняется до любой операции сериализации. Он может
   очистить объект и должен возвращать массив с именами
   всех переменных этого объекта, которые должны быть сериализованы.
   Если метод ничего не возвращает, то сериализуется <strong><code>null</code></strong> и
   выдаётся предупреждение <strong><code>E_NOTICE</code></strong>.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Недопустимо возвращать в <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>
    имена закрытых свойств в родительском классе. Это
    приведёт к ошибке уровня <strong><code>E_NOTICE</code></strong>.
    Вместо этого вы можете использовать
    <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>.
   </p>
  </p></blockquote>
  <p class="para">
   Предполагаемое использование <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>
   состоит в завершении работы над данными, ждущими обработки или
   других подобных задач очистки. Кроме того, этот метод может быть полезен,
   когда есть очень большие объекты, которые
   нет необходимости полностью сохранять.
  </p>
  <p class="para">
   С другой стороны, функция <span class="function"><a href="https://www.php.net/manual/ru/function.unserialize.php" class="function">unserialize()</a></span> проверяет
   наличие метода с магическим именем
   <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>.
   Если она имеется, эта функция может восстанавливать любые ресурсы,
   которые может иметь объект.
  </p>
  <p class="para">
   Предполагаемое использование <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>
   заключается в восстановлении любых соединений с базой данных,
   которые могли быть потеряны во время операции сериализации и
   выполнения других операций повторной инициализации.
  </p>
  <div class="example" id="example-267">
   <p><strong>Пример #1 Сериализация и десериализация</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">Connection<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;</span><span style="color: #0000BB">connect</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">link&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__sleep</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array(</span><span style="color: #DD0000">'dsn'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__wakeup</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>

 <div class="sect2" id="language.oop5.magic.serialize">
  <h3 class="title">
   <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a> и
   <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a>
  </h3>

  <div class="methodsynopsis dc-description" id="object.serialize">
   <span class="modifier">public</span> <span class="methodname"><strong>__serialize</strong></span>(): <span class="type">array</span></div>

  <div class="methodsynopsis dc-description" id="object.unserialize"><span class="modifier">public</span> <span class="methodname"><strong>__unserialize</strong></span>(<span class="methodparam"><span class="type">array</span> <code class="parameter">$data</code></span>): <span class="type"><span class="type void">void</span></span></div>


  <p class="para">
   <span class="function"><a href="https://www.php.net/manual/ru/function.serialize.php" class="function">serialize()</a></span> проверяет, есть ли в классе функция с
   магическим именем <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>. Если да, функция
   выполняется перед любой сериализацией. Она должна создать и вернуть ассоциативный массив пар ключ/значение,
   которые представляют сериализованную форму объекта.
   Если массив не возвращён, будет выдано <span class="classname"><a href="https://www.php.net/manual/ru/class.typeerror.php" class="classname">TypeError</a></span>.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Если и <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a> и <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a>
    определены в одном и том же объекте, будет вызван только метод <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>.
    <a href="language.oop5.magic.php.html#object.sleep" class="link">__sleep()</a> будет игнорироваться. Если объект реализует интерфейс <a href="https://www.php.net/manual/ru/class.serializable.php" class="link">Serializable</a>,
    метод <code class="literal">serialize()</code> интерфейса будет игнорироваться, а вместо него будет использован <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>.
   </p>
  </p></blockquote>
  <p class="para">
   Предполагаемое использование <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a> заключается в определении удобного для сериализации
   произвольного представления объекта. Элементы массива могут соответствовать свойствам объекта, но это не обязательно.
  </p>
  <p class="para">
   И наоборот, <span class="function"><a href="https://www.php.net/manual/ru/function.unserialize.php" class="function">unserialize()</a></span> проверяет
   наличие магической функции <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a>.
   Если функция присутствует, ей будет передан
   восстановленный массив, который был возвращён из <a href="language.oop5.magic.php.html#object.serialize" class="link">__serialize()</a>. Затем
   он может восстановить свойства объекта из этого массива соответствующим образом.
  </p>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Если и <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a> и <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a>
    определены в одном и том же объекте, будет вызван только метод <a href="language.oop5.magic.php.html#object.unserialize" class="link">__unserialize()</a>.
    <a href="language.oop5.magic.php.html#object.wakeup" class="link">__wakeup()</a> будет игнорироваться.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <p class="para">
    Функция доступна с PHP 7.4.0.
   </p>
  </p></blockquote>
  <div class="example" id="example-268">
   <p><strong>Пример #2 Сериализация и десериализация</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">Connection<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$username</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;</span><span style="color: #0000BB">connect</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">link&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__serialize</span><span style="color: #007700">():&nbsp;array<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'dsn'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'user'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'pass'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__unserialize</span><span style="color: #007700">(array&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">):&nbsp;</span><span style="color: #0000BB">void<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">dsn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'dsn'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">];<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>

 <div class="sect2" id="language.oop5.magic.tostring">
  <h3 class="title"><a href="language.oop5.magic.php.html#object.tostring" class="link">__toString()</a></h3>
  <div class="methodsynopsis dc-description" id="object.tostring">
   <span class="modifier">public</span> <span class="methodname"><strong>__toString</strong></span>(): <span class="type">string</span></div>

  <p class="para">
   Метод <a href="language.oop5.magic.php.html#object.tostring" class="link">__toString()</a> позволяет классу решать,
   как он должен реагировать при преобразовании в
   строку. Например, что вывести при выполнении <code class="literal">echo $obj;</code>.
  </p>
  <div class="warning"><strong class="warning">Внимание</strong>
   <p class="para">
    Начиная с PHP 8.0.0, возвращаемое значение следует стандартной семантике типа PHP,
    что означает, что оно будет преобразовано в строку (<span class="type">string</span>), если возможно,
    и если <a href="https://www.php.net/manual/ru/language.types.declarations.php#language.types.declarations.strict" class="link">strict typing</a> отключён.
   </p>
   <p class="para">
    Начиная с PHP 8.0.0, любой класс, содержащий метод <a href="language.oop5.magic.php.html#object.tostring" class="link">__toString()</a>,
    также будет неявно реализовывать интерфейс <span class="interfacename"><a href="https://www.php.net/manual/ru/class.stringable.php" class="interfacename">Stringable</a></span> и, таким образом,
    будет проходить проверку типа для этого интерфейса В любом случае рекомендуется явно реализовать интерфейс.
    </p>
   <p class="para">
    В PHP 7.4 возвращаемое значение <em class="emphasis">ДОЛЖНО</em> быть строкой (<span class="type">string</span>), иначе выдаётся <span class="classname"><a href="https://www.php.net/manual/ru/class.error.php" class="classname">Error</a></span>.
   </p>
   <p class="para">
    До PHP 7.4.0 возвращаемое значение <em class="emphasis">должно</em> быть
    строкой (<span class="type">string</span>), в противном случае выдаётся фатальная ошибка <strong><code>E_RECOVERABLE_ERROR</code></strong>.
    is emitted.
   </p>
  </div>
  <div class="warning"><strong class="warning">Внимание</strong>
   <p class="simpara">
    Нельзя выбросить исключение из метода <a href="language.oop5.magic.php.html#object.tostring" class="link">__toString()</a> до PHP 7.4.0. Это приведёт к фатальной ошибке.
   </p>
  </div>
  <div class="example" id="example-269">
   <p><strong>Пример #3 Простой пример</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Объявление&nbsp;простого&nbsp;класса<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">TestClass<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$foo</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__toString</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$class&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">TestClass</span><span style="color: #007700">(</span><span style="color: #DD0000">'Привет'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$class</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
Привет
</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="language.oop5.magic.invoke">
  <h3 class="title"><a href="language.oop5.magic.php.html#object.invoke" class="link">__invoke()</a></h3>
  <div class="methodsynopsis dc-description" id="object.invoke">
   <span class="methodname"><strong>__invoke</strong></span>(<span class="methodparam"> <code class="parameter">...$values</code></span>): <span class="type"><a href="https://www.php.net/manual/ru/language.types.declarations.php#language.types.declarations.mixed" class="type mixed">mixed</a></span></div>

  <p class="para">
   Метод <a href="language.oop5.magic.php.html#object.invoke" class="link">__invoke()</a>
   вызывается, когда скрипт пытается выполнить объект как функцию.
  </p>
  <div class="example" id="example-270">
   <p><strong>Пример #4 Использование <a href="language.oop5.magic.php.html#object.invoke" class="link">__invoke()</a></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">CallableClass<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__invoke</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">CallableClass</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$obj</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">is_callable</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
int(5)
bool(true)
</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="language.oop5.magic.set-state">
  <h3 class="title"><a href="language.oop5.magic.php.html#object.set-state" class="link">__set_state()</a></h3>
  <div class="methodsynopsis dc-description" id="object.set-state">
   <span class="modifier">static</span> <span class="methodname"><strong>__set_state</strong></span>(<span class="methodparam"><span class="type">array</span> <code class="parameter">$properties</code></span>): <span class="type">object</span></div>

  <p class="para">
   Этот <a href="https://www.php.net/manual/ru/language.oop5.static.php" class="link">статический</a> метод
   вызывается для тех классов, которые экспортируются функцией
   <span class="function"><a href="https://www.php.net/manual/ru/function.var-export.php" class="function">var_export()</a></span>.
  </p>
  <p class="para">
   Единственным параметром этого метода является массив, содержащий экспортируемые
   свойства в виде <code class="literal">[&#039;property&#039; =&gt; value, ...]</code>.
  </p>
  <div class="example" id="example-271">
   <p><strong>Пример #5 Использование <a href="language.oop5.magic.php.html#object.set-state" class="link">__set_state()</a></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">A<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$var1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$var2</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;function&nbsp;</span><span style="color: #0000BB">__set_state</span><span style="color: #007700">(</span><span style="color: #0000BB">$an_array</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">A</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">var1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$an_array</span><span style="color: #007700">[</span><span style="color: #DD0000">'var1'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">var2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$an_array</span><span style="color: #007700">[</span><span style="color: #DD0000">'var2'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$obj</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">A</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">var1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">var2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'foo'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">var_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">);<br />eval(</span><span style="color: #DD0000">'$c&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">';'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
string(60) &quot;A::__set_state(array(
   &#039;var1&#039; =&gt; 5,
   &#039;var2&#039; =&gt; &#039;foo&#039;,
))&quot;
object(A)#2 (2) {
  [&quot;var1&quot;]=&gt;
  int(5)
  [&quot;var2&quot;]=&gt;
  string(3) &quot;foo&quot;
}
</pre></div>
   </div>
  </div>
  <blockquote class="note"><p><strong class="note">Замечание</strong>: 
   <span class="simpara">
    При экспорте объекта <span class="function"><a href="https://www.php.net/manual/ru/function.var-export.php" class="function">var_export()</a></span> не проверяет,
    реализует ли класс объекта метод <a href="language.oop5.magic.php.html#object.set-state" class="link">__set_state()</a>,
    поэтому повторный импорт объектов приведёт к исключению <span class="classname"><a href="https://www.php.net/manual/ru/class.error.php" class="classname">Error</a></span>, если метод
    __set_state() не реализован. В частности, это относится к некоторым внутренним классам.
   </span>
   <span class="simpara">
    Необходимость проверки, реализует ли импортируемый класс метод __set_state(), полностью
    лежит на разработчике.
   </span>
  </p></blockquote>
 </div>

 <div class="sect2" id="language.oop5.magic.debuginfo">
  <h3 class="title"><a href="language.oop5.magic.php.html#object.debuginfo" class="link">__debugInfo()</a></h3>
  <div class="methodsynopsis dc-description" id="object.debuginfo">
   <span class="methodname"><strong>__debugInfo</strong></span>(): <span class="type">array</span></div>

  <p class="para">
   Этот метод вызывается функцией <span class="function"><a href="https://www.php.net/manual/ru/function.var-dump.php" class="function">var_dump()</a></span>, когда
   необходимо вывести список свойств объекта. Если этот метод не определён,
   тогда будут выведены все свойства объекта c модификаторами public, protected и private.
  </p>
  <div class="example" id="example-272">
   <p><strong>Пример #6 Использование <a href="language.oop5.magic.php.html#object.debuginfo" class="link">__debugInfo()</a></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</span><span style="color: #0000BB">$prop</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$val</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__debugInfo</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'propSquared'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prop&nbsp;</span><span style="color: #007700">**&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(new&nbsp;</span><span style="color: #0000BB">C</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
object(C)#1 (1) {
  [&quot;propSquared&quot;]=&gt;
  int(1764)
}
</pre></div>
   </div>
  </div>
 </div>
</div>
<section id="usernotes">
 <div class="head">
  <span class="action"><a href="https://www.php.net/manual/add-note.php?sect=language.oop5.magic&amp;redirect=https://www.php.net/manual/ru/language.oop5.magic.php"><img src='https://www.php.net/images/notes-add@2x.png' alt='add a note' width='12' height='12'> <small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">30 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="86111">  <div class="votes">
    <div id="Vu86111">
    <a href="https://www.php.net/manual/vote-note.php?id=86111&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd86111">
    <a href="https://www.php.net/manual/vote-note.php?id=86111&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V86111" title="64% like this...">
    42
    </div>
  </div>
  <a href="language.oop5.magic.php.html#86111" class="name">
  <strong class="user"><em>jon at webignition dot net</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#86111"> &para;</a><div class="date" title="2008-10-03 07:26"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom86111">
<div class="phpcode"><code><span class="html">
The __toString() method is extremely useful for converting class attribute names and values into common string representations of data (of which there are many choices). I mention this as previous references to __toString() refer only to debugging uses.<br /><br />I have previously used the __toString() method in the following ways:<br /><br /> - representing a data-holding object as:<br />&nbsp;&nbsp; - XML<br />&nbsp;&nbsp; - raw POST data<br />&nbsp;&nbsp; - a GET query string<br />&nbsp;&nbsp; - header name:value pairs<br /><br /> - representing a custom mail object as an actual email (headers then body, all correctly represented)<br /><br />When creating a class, consider what possible standard string representations are available and, of those, which would be the most relevant with respect to the purpose of the class.<br /><br />Being able to represent data-holding objects in standardised string forms makes it much easier for your internal representations of data to be shared in an interoperable way with other applications.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87404">  <div class="votes">
    <div id="Vu87404">
    <a href="https://www.php.net/manual/vote-note.php?id=87404&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd87404">
    <a href="https://www.php.net/manual/vote-note.php?id=87404&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V87404" title="63% like this...">
    18
    </div>
  </div>
  <a href="language.oop5.magic.php.html#87404" class="name">
  <strong class="user"><em>jsnell at e-normous dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#87404"> &para;</a><div class="date" title="2008-12-03 02:01"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom87404">
<div class="phpcode"><code><span class="html">
Be very careful to define __set_state() in classes which inherit from a parent using it, as the static __set_state() call will be called for any children.&nbsp; If you are not careful, you will end up with an object of the wrong type.&nbsp; Here is an example:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">A<br /></span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$var1</span><span class="keyword">; <br /><br />&nbsp; &nbsp; public static function </span><span class="default">__set_state</span><span class="keyword">(</span><span class="default">$an_array</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$obj </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">var1 </span><span class="keyword">= </span><span class="default">$an_array</span><span class="keyword">[</span><span class="string">'var1'</span><span class="keyword">];&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$obj</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />}<br /><br /></span><span class="default">$b </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">;<br /></span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">var1 </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">;<br /><br />eval(</span><span class="string">'$new_b = ' </span><span class="keyword">. </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">';'</span><span class="keyword">); <br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$new_b</span><span class="keyword">);<br /></span><span class="comment">/*<br />object(A)#2 (1) {<br />&nbsp; ["var1"]=&gt;<br />&nbsp; int(5)<br />}<br />*/<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125282">  <div class="votes">
    <div id="Vu125282">
    <a href="https://www.php.net/manual/vote-note.php?id=125282&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125282">
    <a href="https://www.php.net/manual/vote-note.php?id=125282&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125282" title="71% like this...">
    6
    </div>
  </div>
  <a href="language.oop5.magic.php.html#125282" class="name">
  <strong class="user"><em>ctamayo at sitecrafting dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#125282"> &para;</a><div class="date" title="2020-08-18 06:10"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125282">
<div class="phpcode"><code><span class="html">
Due to a bug in PHP &lt;= 7.3, overriding the __debugInfo() method from SPL classes is silently ignored.<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">Debuggable </span><span class="keyword">extends </span><span class="default">ArrayObject </span><span class="keyword">{<br />&nbsp; public function </span><span class="default">__debugInfo</span><span class="keyword">() {<br />&nbsp; &nbsp; return [</span><span class="string">'special' </span><span class="keyword">=&gt; </span><span class="string">'This should show up'</span><span class="keyword">];<br />&nbsp; }<br />}<br /><br /></span><span class="default">var_dump</span><span class="keyword">(new </span><span class="default">Debuggable</span><span class="keyword">());<br /><br /></span><span class="comment">// Expected output:<br />// object(Debuggable)#1 (1) {<br />//&nbsp;&nbsp; ["special"]=&gt;<br />//&nbsp;&nbsp; string(19) "This should show up"<br />// }<br /><br />// Actual output:<br />// object(Debuggable)#1 (1) {<br />//&nbsp;&nbsp; ["storage":"ArrayObject":private]=&gt;<br />//&nbsp;&nbsp; array(0) {<br />//&nbsp;&nbsp; }<br />// }<br /><br /></span><span class="default">?&gt;<br /></span><br />Bug report: <a href="https://bugs.php.net/bug.php?id=69264" rel="nofollow" target="_blank">https://bugs.php.net/bug.php?id=69264</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="125769">  <div class="votes">
    <div id="Vu125769">
    <a href="https://www.php.net/manual/vote-note.php?id=125769&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125769">
    <a href="https://www.php.net/manual/vote-note.php?id=125769&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125769" title="75% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.magic.php.html#125769" class="name">
  <strong class="user"><em>vali dot dr at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#125769"> &para;</a><div class="date" title="2021-02-03 07:18"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125769">
<div class="phpcode"><code><span class="html">
It should be noted that if you unset a class typed property and then try to access it,&nbsp; __get will be called. But it MUST return the original type.<br /><br /><a href="https://wiki.php.net/rfc/typed_properties_v2#overloaded_properties" rel="nofollow" target="_blank">https://wiki.php.net/rfc/typed_properties_v2#overloaded_properties</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="121158">  <div class="votes">
    <div id="Vu121158">
    <a href="https://www.php.net/manual/vote-note.php?id=121158&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd121158">
    <a href="https://www.php.net/manual/vote-note.php?id=121158&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V121158" title="64% like this...">
    12
    </div>
  </div>
  <a href="language.oop5.magic.php.html#121158" class="name">
  <strong class="user"><em>kguest at php dot net</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#121158"> &para;</a><div class="date" title="2017-05-30 01:27"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom121158">
<div class="phpcode"><code><span class="html">
__debugInfo&nbsp; is also utilised when calling print_r on an object:<br /><br />$ cat test.php<br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">FooQ </span><span class="keyword">{<br /><br />&nbsp; &nbsp;&nbsp; private </span><span class="default">$bar </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br /><br />&nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />&nbsp; &nbsp;&nbsp; }<br /><br />&nbsp; &nbsp;&nbsp; public function </span><span class="default">__debugInfo</span><span class="keyword">()<br />&nbsp; &nbsp;&nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return [</span><span class="string">'_bar' </span><span class="keyword">=&gt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">];<br />&nbsp; &nbsp;&nbsp; }<br />}<br /></span><span class="default">$fooq </span><span class="keyword">= new </span><span class="default">FooQ</span><span class="keyword">(</span><span class="string">"q"</span><span class="keyword">);<br /></span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$fooq</span><span class="keyword">);<br /><br />$ </span><span class="default">php test</span><span class="keyword">.</span><span class="default">php<br />FooQ Object<br /></span><span class="keyword">(<br />&nbsp; &nbsp; [</span><span class="default">_bar</span><span class="keyword">] =&gt; </span><span class="default">q<br /></span><span class="keyword">)<br />$</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118617">  <div class="votes">
    <div id="Vu118617">
    <a href="https://www.php.net/manual/vote-note.php?id=118617&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118617">
    <a href="https://www.php.net/manual/vote-note.php?id=118617&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118617" title="62% like this...">
    9
    </div>
  </div>
  <a href="language.oop5.magic.php.html#118617" class="name">
  <strong class="user"><em>smiley at HELLOSPAMBOT dot chillerlan dot net</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#118617"> &para;</a><div class="date" title="2016-01-09 04:30"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom118617">
<div class="phpcode"><code><span class="html">
A simple API wrapper, using __call() and the PHP 5.6 "..." token.<br /><a href="http://php.net/manual/functions.arguments.php#functions.variable-arg-list" rel="nofollow" target="_blank">http://php.net/manual/functions.arguments.php#functions.variable-arg-list</a><br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">namespace </span><span class="default">Example</span><span class="keyword">;<br /><br />use </span><span class="default">Exception</span><span class="keyword">;<br />use </span><span class="default">ReflectionClass</span><span class="keyword">;<br />use </span><span class="default">SomeApiInterface</span><span class="keyword">;<br />use </span><span class="default">SomeHttpClient</span><span class="keyword">;<br />use </span><span class="default">SomeEndpointHandler</span><span class="keyword">;<br /><br /></span><span class="comment">/**<br /> * Class SomeApiWrapper<br /> * <br /> * @method SomeEndpointHandler method1(MethodParams $param1)<br /> * @method SomeEndpointHandler method2(MethodParams $param1, AuthParams $param2 = null)<br /> * ...<br /> * @method SomeEndpointHandler method42()<br /> */<br /></span><span class="keyword">class </span><span class="default">SomeApiWrapper</span><span class="keyword">{<br /><br />&nbsp; &nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp;&nbsp; * @var \SomeHttpClient<br />&nbsp; &nbsp;&nbsp; */<br />&nbsp; &nbsp; </span><span class="keyword">private </span><span class="default">$httpClient</span><span class="keyword">;<br /><br />&nbsp; &nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp;&nbsp; * @var array<br />&nbsp; &nbsp;&nbsp; */<br />&nbsp; &nbsp; </span><span class="keyword">private </span><span class="default">$methodMap </span><span class="keyword">= [];<br /><br />&nbsp; &nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp;&nbsp; * SomeApiWrapper constructor.<br />&nbsp; &nbsp;&nbsp; */<br />&nbsp; &nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(){<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mapApiMethods</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">httpClient </span><span class="keyword">= new </span><span class="default">SomeHttpClient</span><span class="keyword">();<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp;&nbsp; * The API is flat and has ~ 150 endpoints, all of which take optional parameters<br />&nbsp; &nbsp;&nbsp; * from up to 3 groups (method params, authentication, filters). Instead of<br />&nbsp; &nbsp;&nbsp; * implementing the interface and adding countless stubs that have basically<br />&nbsp; &nbsp;&nbsp; * the same signature, i just map its methods here and use __call().<br />&nbsp; &nbsp;&nbsp; */<br />&nbsp; &nbsp; </span><span class="keyword">private function </span><span class="default">mapApiMethods</span><span class="keyword">(){<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$reflectionClass </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="default">SomeApiInterface</span><span class="keyword">::class);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$reflectionClass</span><span class="keyword">-&gt;</span><span class="default">getMethods</span><span class="keyword">() as </span><span class="default">$m</span><span class="keyword">){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">methodMap</span><span class="keyword">[] = </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp;&nbsp; * Thanks to the PHP 5.6+ "..." token, there's no hassle with the arguments anymore<br />&nbsp; &nbsp;&nbsp; * (ugh, bad pun). Just hand the method parameters into the endpoint handler,<br />&nbsp; &nbsp;&nbsp; * along with other mandatory params - type hints are your friends.<br />&nbsp; &nbsp;&nbsp; * <br />&nbsp; &nbsp;&nbsp; * It's magic!<br />&nbsp; &nbsp;&nbsp; * <br />&nbsp; &nbsp;&nbsp; * @param string $method<br />&nbsp; &nbsp;&nbsp; * @param array&nbsp; $arguments<br />&nbsp; &nbsp;&nbsp; *<br />&nbsp; &nbsp;&nbsp; * @return \SomeEndpointHandler<br />&nbsp; &nbsp;&nbsp; * @throws \Exception<br />&nbsp; &nbsp;&nbsp; */<br />&nbsp; &nbsp; </span><span class="keyword">public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">){<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">methodMap</span><span class="keyword">)){<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return new </span><span class="default">SomeEndpointHandler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">httpClient</span><span class="keyword">, </span><span class="default">$method</span><span class="keyword">, ...</span><span class="default">$arguments</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Endpoint "'</span><span class="keyword">.</span><span class="default">$method</span><span class="keyword">.</span><span class="string">'" does not exist'</span><span class="keyword">);<br />&nbsp; &nbsp; }<br /><br />}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107509">  <div class="votes">
    <div id="Vu107509">
    <a href="https://www.php.net/manual/vote-note.php?id=107509&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd107509">
    <a href="https://www.php.net/manual/vote-note.php?id=107509&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V107509" title="56% like this...">
    12
    </div>
  </div>
  <a href="language.oop5.magic.php.html#107509" class="name">
  <strong class="user"><em>daan dot broekhof at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#107509"> &para;</a><div class="date" title="2012-02-14 10:54"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom107509">
<div class="phpcode"><code><span class="html">
Ever wondered why you can't throw exceptions from __toString()? Yeah me too. <br /><br />Well now you can! This trick allows you to throw any type of exception from within a __toString(), with a full &amp; correct backtrace.<br /><br />How does it work? Well PHP __toString() handling is not as strict in every case: throwing an Exception from __toString() triggers a fatal E_ERROR, but returning a non-string value from a __toString() triggers a non-fatal E_RECOVERABLE_ERROR. <br />Add a little bookkeeping, and can circumvented this PHP deficiency!<br />(tested to work PHP 5.3+)<br /><br /><span class="default">&lt;?php<br /><br />set_error_handler</span><span class="keyword">(array(</span><span class="string">'My_ToStringFixer'</span><span class="keyword">, </span><span class="string">'errorHandler'</span><span class="keyword">));<br /></span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL </span><span class="keyword">| </span><span class="default">E_STRICT</span><span class="keyword">);<br /><br />class </span><span class="default">My_ToStringFixer<br /></span><span class="keyword">{<br />&nbsp; &nbsp; protected static </span><span class="default">$_toStringException</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public static function </span><span class="default">errorHandler</span><span class="keyword">(</span><span class="default">$errorNumber</span><span class="keyword">, </span><span class="default">$errorMessage</span><span class="keyword">, </span><span class="default">$errorFile</span><span class="keyword">, </span><span class="default">$errorLine</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$exception </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Always unset '_toStringException', we don't want a straggler to be found later if something came between the setting and the error<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'~^Method .*::__toString\(\) must return a string value$~'</span><span class="keyword">, </span><span class="default">$errorMessage</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw </span><span class="default">$exception</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; public static function </span><span class="default">throwToStringException</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Should not occur with prescribed usage, but in case of recursion: clean out exception, return a valid string, and weep<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">''</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$_toStringException </span><span class="keyword">= </span><span class="default">$exception</span><span class="keyword">;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">null</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">My_Class<br /></span><span class="keyword">{<br />&nbsp; &nbsp; public function </span><span class="default">doComplexStuff</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Oh noes!'</span><span class="keyword">);<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; public function </span><span class="default">__toString</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; try<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// do your complex thing which might trigger an exception<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">doComplexStuff</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; catch (</span><span class="default">Exception $e</span><span class="keyword">)<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// The 'return' is required to trigger the trick<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">My_ToStringFixer</span><span class="keyword">::</span><span class="default">throwToStringException</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">My_Class</span><span class="keyword">();<br /><br />try<br />{<br />&nbsp; &nbsp; echo </span><span class="default">$x</span><span class="keyword">;<br />}<br />catch (</span><span class="default">Exception $e</span><span class="keyword">)<br />{<br />&nbsp; &nbsp; echo </span><span class="string">'Caught Exception! : '</span><span class="keyword">. </span><span class="default">$e</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55806">  <div class="votes">
    <div id="Vu55806">
    <a href="https://www.php.net/manual/vote-note.php?id=55806&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55806">
    <a href="https://www.php.net/manual/vote-note.php?id=55806&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55806" title="60% like this...">
    5
    </div>
  </div>
  <a href="language.oop5.magic.php.html#55806" class="name">
  <strong class="user"><em>jeffxlevy at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#55806"> &para;</a><div class="date" title="2005-08-13 06:26"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom55806">
<div class="phpcode"><code><span class="html">
Intriguing what happens when __sleep() and __wakeup() and sessions() are mixed. I had a hunch that, as session data is serialized, __sleep would be called when an object, or whatever, is stored in _SESSION. true. The same hunch applied when session_start() was called. Would __wakeup() be called? True. Very helpful, specifically as I'm building massive objects (well, lots of simple objects stored in sessions), and need lots of automated tasks (potentially) reloaded at "wakeup" time. (for instance, restarting a database session/connection).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81492">  <div class="votes">
    <div id="Vu81492">
    <a href="https://www.php.net/manual/vote-note.php?id=81492&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd81492">
    <a href="https://www.php.net/manual/vote-note.php?id=81492&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V81492" title="56% like this...">
    9
    </div>
  </div>
  <a href="language.oop5.magic.php.html#81492" class="name">
  <strong class="user"><em>dhuseby domain getback tld com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#81492"> &para;</a><div class="date" title="2008-02-29 06:22"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom81492">
<div class="phpcode"><code><span class="html">
The above hint for using array_keys((array)$obj) got me investigating how to get __sleep to really work with object hierarchies.<br /><br />With PHP 5.2.3, If you want to serialize an object that is part of an object hierarchy and you want to selectively serialize members (public, private, and protected) by manually specifying the array of members, there are a few simple rules for naming members that you must follow:<br /><br />1. public members should be named using just their member name, like so:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$bar</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; return array(</span><span class="string">"bar"</span><span class="keyword">);<br />&nbsp; &nbsp; }<br />}<br /></span><span class="default">?&gt;<br /></span><br />2. protected members should be named using "\0" . "*" . "\0" . member name, like so:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{<br />&nbsp; &nbsp; protected </span><span class="default">$bar</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; return array(</span><span class="string">"\0*\0bar"</span><span class="keyword">);<br />&nbsp; &nbsp; }<br />}<br /></span><span class="default">?&gt;<br /></span><br />3. private members should be named using "\0" . class name . "\0" . member name, like so:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{<br />&nbsp; &nbsp; private </span><span class="default">$bar</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; return array(</span><span class="string">"\0Foo\0bar"</span><span class="keyword">);<br />&nbsp; &nbsp; }<br />}<br /></span><span class="default">?&gt;<br /></span><br />So with this information let us serialize a class hierarchy correctly:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">Base </span><span class="keyword">{<br />&nbsp; &nbsp; private </span><span class="default">$foo </span><span class="keyword">= </span><span class="string">"foo_value"</span><span class="keyword">;<br />&nbsp; &nbsp; protected </span><span class="default">$bar </span><span class="keyword">= </span><span class="string">"bar_value"</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; return array(</span><span class="string">"\0Base\0foo"</span><span class="keyword">, </span><span class="string">"\0*\0bar"</span><span class="keyword">);<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">Derived </span><span class="keyword">extends </span><span class="default">Base </span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$baz </span><span class="keyword">= </span><span class="string">"baz_value"</span><span class="keyword">;<br />&nbsp; &nbsp; private </span><span class="default">$boo </span><span class="keyword">= </span><span class="string">"boo_value"</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// we have to merge our members with our parent's<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">array_merge</span><span class="keyword">(array(</span><span class="string">"baz"</span><span class="keyword">, </span><span class="string">"\0Derived\0boo"</span><span class="keyword">), </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__sleep</span><span class="keyword">());<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">Leaf </span><span class="keyword">extends </span><span class="default">Derived </span><span class="keyword">{<br />&nbsp; &nbsp; private </span><span class="default">$qux </span><span class="keyword">= </span><span class="string">"qux_value"</span><span class="keyword">;<br />&nbsp; &nbsp; protected </span><span class="default">$zaz </span><span class="keyword">= </span><span class="string">"zaz_value"</span><span class="keyword">;<br />&nbsp; &nbsp; public </span><span class="default">$blah </span><span class="keyword">= </span><span class="string">"blah_value"</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// again, merge our members with our parent's<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">array_merge</span><span class="keyword">(array(</span><span class="string">"\0Leaf\0qux"</span><span class="keyword">, </span><span class="string">"\0*\0zaz"</span><span class="keyword">, </span><span class="string">"blah"</span><span class="keyword">), </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__sleep</span><span class="keyword">());<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="comment">// test it<br /></span><span class="default">$test </span><span class="keyword">= new </span><span class="default">Leaf</span><span class="keyword">();<br /></span><span class="default">$s </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br /></span><span class="default">$test2 </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br />echo </span><span class="default">$s</span><span class="keyword">;<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test2</span><span class="keyword">);<br /><br /></span><span class="default">?&gt;<br /></span><br />Now if you comment out all of the __sleep() functions and output the serialized string, you will see that the output doesn't change.&nbsp; The most important part of course is that with the proper __sleep() functions, we can unserialize the string and get a properly set up object.<br /><br />I hope this solves the mystery for everybody.&nbsp; __sleep() does work, if you use it correctly :-)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122684">  <div class="votes">
    <div id="Vu122684">
    <a href="https://www.php.net/manual/vote-note.php?id=122684&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd122684">
    <a href="https://www.php.net/manual/vote-note.php?id=122684&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V122684" title="57% like this...">
    4
    </div>
  </div>
  <a href="language.oop5.magic.php.html#122684" class="name">
  <strong class="user"><em>daniel dot peder at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#122684"> &para;</a><div class="date" title="2018-04-30 09:29"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122684">
<div class="phpcode"><code><span class="html">
<a href="http://sandbox.onlinephpfunctions.com/code/4d2cc3648aed58c0dad90c7868173a4775e5ba0c" rel="nofollow" target="_blank">http://sandbox.onlinephpfunctions.com/code/4d2cc3648aed58c0dad90c7868173a4775e5ba0c</a><br /><br />IMHO a bug or need feature change<br /><br />providing a object as a array index doesn't try to us __toString() method so some volatile object identifier is used to index the array, which is breaking any persistency. Type hinting solves that, but while other than "string" type hinting doesn't work on ob jects, the automatic conversion to string should be very intuitive.<br /><br />PS: tried to submit bug, but withot patch the bugs are ignored, unfortunately, I don't C coding<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">shop_product_id </span><span class="keyword">{<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; protected </span><span class="default">$shop_name</span><span class="keyword">;<br />&nbsp; &nbsp; protected </span><span class="default">$product_id</span><span class="keyword">;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$shop_name</span><span class="keyword">,</span><span class="default">$product_id</span><span class="keyword">){<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">shop_name </span><span class="keyword">= </span><span class="default">$shop_name</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">product_id </span><span class="keyword">= </span><span class="default">$product_id</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__toString</span><span class="keyword">(){<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">shop_name </span><span class="keyword">. </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">product_id</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="default">$shop_name </span><span class="keyword">= </span><span class="string">'Shop_A'</span><span class="keyword">;<br /></span><span class="default">$product_id </span><span class="keyword">= </span><span class="default">123</span><span class="keyword">;<br /></span><span class="default">$demo_id </span><span class="keyword">= </span><span class="default">$shop_name </span><span class="keyword">. </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$product_id</span><span class="keyword">;<br /></span><span class="default">$demo_name </span><span class="keyword">= </span><span class="string">'Some product in shop A'</span><span class="keyword">;<br /><br /></span><span class="default">$all_products </span><span class="keyword">= [ </span><span class="default">$demo_id </span><span class="keyword">=&gt; </span><span class="default">$demo_name </span><span class="keyword">];<br /></span><span class="default">$pid </span><span class="keyword">= new </span><span class="default">shop_product_id</span><span class="keyword">( </span><span class="default">$shop_name</span><span class="keyword">, </span><span class="default">$product_id </span><span class="keyword">);<br /><br />echo </span><span class="string">"with type hinting: "</span><span class="keyword">;<br />echo (</span><span class="default">$demo_name </span><span class="keyword">=== </span><span class="default">$all_products</span><span class="keyword">[(string)</span><span class="default">$pid</span><span class="keyword">]) ? </span><span class="string">"ok" </span><span class="keyword">: </span><span class="string">"fail"</span><span class="keyword">;<br />echo </span><span class="string">"\n"</span><span class="keyword">;<br /><br />echo </span><span class="string">"without type hinting: "</span><span class="keyword">;<br />echo (</span><span class="default">$demo_name </span><span class="keyword">=== </span><span class="default">$all_products</span><span class="keyword">[</span><span class="default">$pid</span><span class="keyword">]) ?&nbsp; </span><span class="string">"ok" </span><span class="keyword">: </span><span class="string">"fail"</span><span class="keyword">;<br />echo </span><span class="string">"\n"</span><span class="keyword">;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49413">  <div class="votes">
    <div id="Vu49413">
    <a href="https://www.php.net/manual/vote-note.php?id=49413&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd49413">
    <a href="https://www.php.net/manual/vote-note.php?id=49413&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V49413" title="56% like this...">
    7
    </div>
  </div>
  <a href="language.oop5.magic.php.html#49413" class="name">
  <strong class="user"><em>ddavenport at newagedigital dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#49413"> &para;</a><div class="date" title="2005-01-26 11:09"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom49413">
<div class="phpcode"><code><span class="html">
One of the principles of OOP is encapsulation--the idea that an object should handle its own data and no others'.&nbsp; Asking base classes to take care of subclasses' data, esp considering that a class can't possibly know how many dozens of ways it will be extended, is irresponsible and dangerous.<br /><br />Consider the following...<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">SomeStupidStorageClass<br /></span><span class="keyword">{<br />&nbsp; public function </span><span class="default">getContents</span><span class="keyword">(</span><span class="default">$pos</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">) { ...</span><span class="default">stuff</span><span class="keyword">... }<br />}<br /><br />class </span><span class="default">CryptedStorageClass </span><span class="keyword">extends </span><span class="default">SomeStupidStorageClass<br /></span><span class="keyword">{<br />&nbsp; private </span><span class="default">$decrypted_block</span><span class="keyword">;<br />&nbsp; public function </span><span class="default">getContents</span><span class="keyword">(</span><span class="default">$pos</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">) { ...</span><span class="default">decrypt</span><span class="keyword">... }<br />}<br /></span><span class="default">?&gt;<br /></span><br />If SomeStupidStorageClass decided to serialize its subclasses' data as well as its own, a portion of what was once an encrypted thingie could be stored, in the clear, wherever the thingie was stored.&nbsp; Obviously, CryptedStorageClass would never have chosen this...but it had to either know how to serialize its parent class's data without calling parent::_sleep(), or let the base class do what it wanted to.<br /><br />Considering encapsulation again, no class should have to know how the parent handles its own private data.&nbsp; And it certainly shouldn't have to worry that users will find a way to break access controls in the name of convenience.<br /><br />If a class wants both to have private/protected data and to survive serialization, it should have its own __sleep() method which asks the parent to report its own fields and then adds to the list if applicable.&nbsp; Like so....<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">BetterClass<br /></span><span class="keyword">{<br />&nbsp; private </span><span class="default">$content</span><span class="keyword">;<br /><br />&nbsp; public function </span><span class="default">__sleep</span><span class="keyword">()<br />&nbsp; {<br />&nbsp; &nbsp; return array(</span><span class="string">'basedata1'</span><span class="keyword">, </span><span class="string">'basedata2'</span><span class="keyword">);<br />&nbsp; }<br /><br />&nbsp; public function </span><span class="default">getContents</span><span class="keyword">() { ...</span><span class="default">stuff</span><span class="keyword">... }<br />}<br /><br />class </span><span class="default">BetterDerivedClass </span><span class="keyword">extends </span><span class="default">BetterClass<br /></span><span class="keyword">{<br />&nbsp; private </span><span class="default">$decrypted_block</span><span class="keyword">;<br /><br />&nbsp; public function </span><span class="default">__sleep</span><span class="keyword">()<br />&nbsp; {<br />&nbsp; &nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__sleep</span><span class="keyword">();<br />&nbsp; }<br /><br />&nbsp; public function </span><span class="default">getContents</span><span class="keyword">() { ...</span><span class="default">decrypt</span><span class="keyword">... }<br />}<br /><br /></span><span class="default">?&gt;<br /></span><br />The derived class has better control over its data, and we don't have to worry about something being stored that shouldn't be.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125590">  <div class="votes">
    <div id="Vu125590">
    <a href="https://www.php.net/manual/vote-note.php?id=125590&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125590">
    <a href="https://www.php.net/manual/vote-note.php?id=125590&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125590" title="57% like this...">
    1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#125590" class="name">
  <strong class="user"><em>ricasiano at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#125590"> &para;</a><div class="date" title="2020-12-10 09:59"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125590">
<div class="phpcode"><code><span class="html">
Objects with __toString() passed within methods with type declarations(either from function arguments or return types) automagically converts it to string.<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">Foo<br /></span><span class="keyword">{<br />&nbsp; &nbsp; public function </span><span class="default">__toString</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'foo'</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">Bar<br /></span><span class="keyword">{<br />&nbsp; &nbsp; public function </span><span class="default">setAndGetFoo</span><span class="keyword">(</span><span class="default">string $foo</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$foo</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; public function </span><span class="default">getFoo</span><span class="keyword">(): </span><span class="default">string<br />&nbsp; &nbsp; </span><span class="keyword">{<br />&nbsp; &nbsp; &nbsp; &nbsp; return new </span><span class="default">Foo</span><span class="keyword">();<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br /></span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Bar</span><span class="keyword">();<br /></span><span class="comment">// string(3) "foo"<br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">setAndGetFoo</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">));<br /></span><span class="comment">// string(3) "foo"<br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">getFoo</span><span class="keyword">());</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="63863">  <div class="votes">
    <div id="Vu63863">
    <a href="https://www.php.net/manual/vote-note.php?id=63863&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd63863">
    <a href="https://www.php.net/manual/vote-note.php?id=63863&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V63863" title="57% like this...">
    4
    </div>
  </div>
  <a href="language.oop5.magic.php.html#63863" class="name">
  <strong class="user"><em>rayRO</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#63863"> &para;</a><div class="date" title="2006-04-02 09:55"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom63863">
<div class="phpcode"><code><span class="html">
If you use the Magical Method '__set()', be shure that the call of<br /><span class="default">&lt;?php<br />$myobject</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">[</span><span class="string">'myarray'</span><span class="keyword">] = </span><span class="string">'data'</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span>will not appear!<br /><br />For that u have to do it the fine way if you want to use __set Method ;)<br /><span class="default">&lt;?php<br />$myobject</span><span class="keyword">-&gt;</span><span class="default">test </span><span class="keyword">= array(</span><span class="string">'myarray' </span><span class="keyword">=&gt; </span><span class="string">'data'</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />If a Variable is already set, the __set Magic Method already wont appear!<br /><br />My first solution was to use a Caller Class.<br />With that, i ever knew which Module i currently use!<br />But who needs it... :]<br />There are quiet better solutions for this...<br />Here's the Code:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">Caller </span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$caller</span><span class="keyword">;<br />&nbsp; &nbsp; public </span><span class="default">$module</span><span class="keyword">;<br /><br />&nbsp; &nbsp; function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$funcname</span><span class="keyword">, </span><span class="default">$args </span><span class="keyword">= array()) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">) &amp;&amp; </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'call_user_func_array'</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">call_user_func_array</span><span class="keyword">(array(&amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">, </span><span class="default">$funcname</span><span class="keyword">), </span><span class="default">$args</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"Call to Function with call_user_func_array failed"</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$callerClassName </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$callerModuleName </span><span class="keyword">= </span><span class="string">'Webboard'</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$callerClassName </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'No Classname'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">module </span><span class="keyword">= </span><span class="default">$callerModuleName</span><span class="keyword">;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">class_exists</span><span class="keyword">(</span><span class="default">$callerClassName</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller </span><span class="keyword">= new </span><span class="default">$callerClassName</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Class not exists: \''</span><span class="keyword">.</span><span class="default">$callerClassName</span><span class="keyword">.</span><span class="string">'\''</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">, </span><span class="string">'__init'</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;</span><span class="default">__init</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Caller is no object!'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">, </span><span class="string">'__deinit'</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;</span><span class="default">__deinit</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__isset</span><span class="keyword">(</span><span class="default">$isset</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$return </span><span class="keyword">= isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$isset</span><span class="keyword">});<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Caller is no object!'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__unset</span><span class="keyword">(</span><span class="default">$unset</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$unset</span><span class="keyword">}))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$unset</span><span class="keyword">});<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Caller is no object!'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__set</span><span class="keyword">(</span><span class="default">$set</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$set</span><span class="keyword">} = </span><span class="default">$val</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Caller is no object!'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$get</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$get</span><span class="keyword">}))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;{</span><span class="default">$get</span><span class="keyword">};<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Caller is no object!'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">unsetModuleInformation</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">setModuleInformation</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;</span><span class="default">module </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">module</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; function </span><span class="default">unsetModuleInformation</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">caller</span><span class="keyword">-&gt;</span><span class="default">module </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="comment">// Well this can be a Config Class?<br /></span><span class="keyword">class </span><span class="default">Config </span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$module</span><span class="keyword">;<br /><br />&nbsp; &nbsp; public </span><span class="default">$test</span><span class="keyword">;<br /><br />&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'Constructor will have no Module Information... Use __init() instead!&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'--&gt; '</span><span class="keyword">.</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">module</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">).</span><span class="string">' &lt;--'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test </span><span class="keyword">= </span><span class="string">'123'</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__init</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'Using of __init()!&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'--&gt; '</span><span class="keyword">.</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">module</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">).</span><span class="string">' &lt;--'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">testFunction</span><span class="keyword">(</span><span class="default">$test </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$test </span><span class="keyword">!= </span><span class="default">false</span><span class="keyword">)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test </span><span class="keyword">= </span><span class="default">$test</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br />echo(</span><span class="string">'&lt;pre&gt;'</span><span class="keyword">);<br /></span><span class="default">$wow </span><span class="keyword">= new </span><span class="default">Caller</span><span class="keyword">(</span><span class="string">'Config'</span><span class="keyword">, </span><span class="string">'Guestbook'</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br /></span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">test </span><span class="keyword">= </span><span class="string">'456'</span><span class="keyword">;<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br /></span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">testFunction</span><span class="keyword">(</span><span class="string">'789'</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br />print(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);<br /></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$wow</span><span class="keyword">-&gt;</span><span class="default">module</span><span class="keyword">);<br />echo(</span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />Outputs something Like:<br /><br />Constructor will have no Module Information... Use __init() instead!<br />--&gt;&nbsp; &lt;--<br /><br />Using of __init()!<br />--&gt; Guestbook &lt;--<br /><br />123<br /><br />456<br /><br />789<br /><br />Guestbook</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55844">  <div class="votes">
    <div id="Vu55844">
    <a href="https://www.php.net/manual/vote-note.php?id=55844&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55844">
    <a href="https://www.php.net/manual/vote-note.php?id=55844&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55844" title="55% like this...">
    3
    </div>
  </div>
  <a href="language.oop5.magic.php.html#55844" class="name">
  <strong class="user"><em>martin dot goldinger at netserver dot ch</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#55844"> &para;</a><div class="date" title="2005-08-15 04:47"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom55844">
<div class="phpcode"><code><span class="html">
When you use sessions, its very important to keep the sessiondata small, due to low performance with unserialize. Every class shoud extend from this class. The result will be, that no null Values are written to the sessiondata. It will increase performance.<br /><br />&lt;?<br />class BaseObject<br />{<br />&nbsp; &nbsp; function __sleep()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; $vars = (array)$this;<br />&nbsp; &nbsp; &nbsp; &nbsp; foreach ($vars as $key =&gt; $val)<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (is_null($val))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset($vars[$key]);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; return array_keys($vars);<br />&nbsp; &nbsp; }<br />};<br />?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104138">  <div class="votes">
    <div id="Vu104138">
    <a href="https://www.php.net/manual/vote-note.php?id=104138&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd104138">
    <a href="https://www.php.net/manual/vote-note.php?id=104138&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V104138" title="55% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.magic.php.html#104138" class="name">
  <strong class="user"><em>Wesley</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#104138"> &para;</a><div class="date" title="2011-05-25 12:10"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom104138">
<div class="phpcode"><code><span class="html">
Warning __toString can be triggerd more then one time<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">if(</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1024</span><span class="keyword">), </span><span class="string">'somestuff'</span><span class="keyword">)<br />&nbsp; &nbsp; echo </span><span class="default">$obj</span><span class="keyword">;<br />return </span><span class="string">'missing somestuff at the start, create container!'</span><span class="keyword">;<br /><br /></span><span class="default">substr</span><span class="keyword">() </span><span class="default">will trigger a __toString aswell </span><span class="keyword">as echo </span><span class="default">$obj</span><span class="keyword">;<br /></span><span class="default">?&gt;<br /></span><br />wich cause a performance issue since it will gather all data twice.<br /><br />what i used as a hotfix:<br /><br /><span class="default">&lt;?php<br />__toString</span><span class="keyword">(){<br />&nbsp; if(</span><span class="default">null </span><span class="keyword">=== </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sToString</span><span class="keyword">)<br />&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sToString </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_show</span><span class="keyword">();<br />&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sToString</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90194">  <div class="votes">
    <div id="Vu90194">
    <a href="https://www.php.net/manual/vote-note.php?id=90194&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd90194">
    <a href="https://www.php.net/manual/vote-note.php?id=90194&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V90194" title="55% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.magic.php.html#90194" class="name">
  <strong class="user"><em>rudie-de-hotblocks at osu1 dot php dot net</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#90194"> &para;</a><div class="date" title="2009-04-09 06:35"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom90194">
<div class="phpcode"><code><span class="html">
Note also that the constructor is executed also, and before __set_state(), making this magic function less magic, imho, (except for the ability to assign private members).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82629">  <div class="votes">
    <div id="Vu82629">
    <a href="https://www.php.net/manual/vote-note.php?id=82629&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd82629">
    <a href="https://www.php.net/manual/vote-note.php?id=82629&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V82629" title="54% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.magic.php.html#82629" class="name">
  <strong class="user"><em>michal dot kocarek at seznam dot cz</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#82629"> &para;</a><div class="date" title="2008-04-18 02:34"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom82629">
<div class="phpcode"><code><span class="html">
Remember that setters and getters (__set, __get) will work in your class as long as you NOT SET the property with given name.<br /><br />If you still want to have the public property definition in the class source code (phpDocumentor, editor code completition, or any other reason) when using these magic methods, simply unset() your public properties inside the constructor.<br />__set/__get function will be called and code reader will see at first sight, which public properties are available.<br /><br />Example:<br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">user </span><span class="keyword">{<br />&nbsp;&nbsp; </span><span class="comment">/**<br />&nbsp; &nbsp; * @var int Gets and sets the user ID<br />&nbsp; &nbsp; */<br />&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$UserID</span><span class="keyword">;<br />&nbsp;&nbsp; private </span><span class="default">$_userID</span><span class="keyword">;<br /><br />&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br /><br />&nbsp; &nbsp; &nbsp; </span><span class="comment">// All the magic is in single line:<br />&nbsp; &nbsp; &nbsp; // We unset public property, so our setters and getters<br />&nbsp; &nbsp; &nbsp; // are used and phpDoc and editors with code completition are happy<br />&nbsp; &nbsp; &nbsp; </span><span class="keyword">unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">UserID</span><span class="keyword">);<br /><br />&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp; public function </span><span class="default">__set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; </span><span class="comment">// assign value for key UserID to _userID property<br />&nbsp;&nbsp; </span><span class="keyword">}<br /><br />&nbsp;&nbsp; public function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; </span><span class="comment">// return value of _userID for UserID property<br />&nbsp;&nbsp; </span><span class="keyword">}<br />}<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112193">  <div class="votes">
    <div id="Vu112193">
    <a href="https://www.php.net/manual/vote-note.php?id=112193&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112193">
    <a href="https://www.php.net/manual/vote-note.php?id=112193&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112193" title="52% like this...">
    2
    </div>
  </div>
  <a href="language.oop5.magic.php.html#112193" class="name">
  <strong class="user"><em>staff at pro-unreal dot de</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#112193"> &para;</a><div class="date" title="2013-05-16 06:08"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112193">
<div class="phpcode"><code><span class="html">
To avoid instanciating the parent instead of the inherited class for __set_state() as reported by jsnell, you could use late static binding introduced in PHP 5.3:<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />&nbsp; &nbsp; public static function </span><span class="default">__set_state</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; return new static();<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />}<br /><br /></span><span class="default">$instance </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br />eval(</span><span class="string">'$test = ' </span><span class="keyword">. </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$instance</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">';'</span><span class="keyword">);<br /></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br /></span><span class="comment">// -&gt; object(B)#2 (0) {<br />// }<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83110">  <div class="votes">
    <div id="Vu83110">
    <a href="https://www.php.net/manual/vote-note.php?id=83110&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83110">
    <a href="https://www.php.net/manual/vote-note.php?id=83110&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83110" title="52% like this...">
    1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#83110" class="name">
  <strong class="user"><em>yanleech at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#83110"> &para;</a><div class="date" title="2008-05-10 06:24"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom83110">
<div class="phpcode"><code><span class="html">
Maybe we can using unserialize() &amp; __wakeup() instead "new" when creating a new instance of class.<br /><br />Consider following codes:<br /><br />class foo<br />{<br />&nbsp; &nbsp; static public $WAKEUP_STR = 'O:3:"foo":0:{}';<br />&nbsp; &nbsp; public function foo(){}<br />&nbsp; &nbsp; public function bar(){}<br />}<br /><br />$foo = unserialize(foo::$WAKEUP_STR);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55783">  <div class="votes">
    <div id="Vu55783">
    <a href="https://www.php.net/manual/vote-note.php?id=55783&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd55783">
    <a href="https://www.php.net/manual/vote-note.php?id=55783&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V55783" title="52% like this...">
    1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#55783" class="name">
  <strong class="user"><em>mastabog at hotmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#55783"> &para;</a><div class="date" title="2005-08-12 05:06"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom55783">
<div class="phpcode"><code><span class="html">
In reply to krisj1010 at gmail.com below:<br /><br />__sleep() handles protected/private properties very well. You should never rely on get_class_vars() to retrieve property names since this function only returns the public properties. Use the Reflection API instead for that purpose. Better yet, if you know which ones you want to save it is always faster to specify the return array manually.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72532">  <div class="votes">
    <div id="Vu72532">
    <a href="https://www.php.net/manual/vote-note.php?id=72532&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd72532">
    <a href="https://www.php.net/manual/vote-note.php?id=72532&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V72532" title="51% like this...">
    1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#72532" class="name">
  <strong class="user"><em>Dérico Filho</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#72532"> &para;</a><div class="date" title="2007-01-23 07:33"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom72532">
<div class="phpcode"><code><span class="html">
Since PHP 5.2.0, you'll always get an error like this:<br />"Object of class foo could not be converted to string"<br /><br />When one tries to use an object as string, for instance:<br /><br />class Test{}<br />echo new Test();<br /><br />Thus, one way to avoid this problem is to programme the magic method __toString.<br /><br />However, in the older versions, it would output a string saying that it was an object together a unique obj id. Therefore, the __toString() method must comply with this behaviour.<br /><br />My suggestion:<br /><br />class Test{<br />&nbsp; &nbsp; function __toString(){<br />&nbsp; &nbsp; &nbsp; &nbsp; if(!isset($this-&gt;__uniqid))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;__uniqid = md5(uniqid(rand(), true));<br />&nbsp; &nbsp; &nbsp; &nbsp; return(get_class($this)."@".$this-&gt;__uniqid);<br />&nbsp; &nbsp; }<br /><br />}<br /><br />echo new Test();<br /><br />would output something like this:<br /><br />Test@6006ba04f5569544c10a588b04849cf7</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99058">  <div class="votes">
    <div id="Vu99058">
    <a href="https://www.php.net/manual/vote-note.php?id=99058&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd99058">
    <a href="https://www.php.net/manual/vote-note.php?id=99058&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V99058" title="50% like this...">
    0
    </div>
  </div>
  <a href="language.oop5.magic.php.html#99058" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#99058"> &para;</a><div class="date" title="2010-07-24 07:41"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom99058">
<div class="phpcode"><code><span class="html">
Concerning __set() with protected/private/overloaded properties, the behavior might not be so intuitive without knowing some underlying rules.&nbsp; Consider this test object for the following examples...<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />&nbsp; &nbsp; protected </span><span class="default">$test_int </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />&nbsp; &nbsp; protected </span><span class="default">$test_array </span><span class="keyword">= array(</span><span class="string">'key' </span><span class="keyword">=&gt; </span><span class="string">'test'</span><span class="keyword">);<br />&nbsp; &nbsp; protected </span><span class="default">$test_obj</span><span class="keyword">;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test_obj </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__get</span><span class="keyword">(</span><span class="default">$prop</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">$prop</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__set</span><span class="keyword">(</span><span class="default">$prop</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">$prop </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br /><br /></span><span class="default">$a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />Combined Operators (.=, +=, *=, etc): you must also define a companion __get() method to grant write -and- read access to the property.&nbsp; Remember, "$x += $y" is shorthand for "$x = $x + $y".&nbsp; In other words, "__set($x, (__get($x) + $y))".<br /><br />Properties that are Arrays: attempting to set array values like "$a-&gt;test_array[] = 'asdf';" from outside this object will result in an "Indirect modification of overloaded property" notice and the operation completely ignored.&nbsp; You can't use '[]' for array value assignment in this context (with the exception only if you made __get() return by reference, in which case, it would work fine and bypass the __set() method altogether).&nbsp; You can work around this doing something like unioning the array instead:<br /><br /><span class="default">&lt;?php<br /><br />$a</span><span class="keyword">-&gt;</span><span class="default">test_array</span><span class="keyword">[] = </span><span class="string">'asdf'</span><span class="keyword">; </span><span class="comment">// notice given and ignored unless __get() was declared to return by reference<br /></span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">test_array </span><span class="keyword">+= array(</span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'asdf'</span><span class="keyword">); </span><span class="comment">// to add a key/value<br /></span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">test_array </span><span class="keyword">= array(</span><span class="string">"key" </span><span class="keyword">=&gt; </span><span class="string">'asdf'</span><span class="keyword">) + </span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">test_array</span><span class="keyword">; </span><span class="comment">// to overwrite a&nbsp; key/value.<br /><br /></span><span class="default">?&gt;<br /></span><br />Properties that are Objects: as long as you have that __get() method, you can freely access and alter that sub object's own properties, bypassing __set() entirely.&nbsp; Remember, objects are assigned and passed by reference naturally. <br /><br /><span class="default">&lt;?php<br /><br />$a</span><span class="keyword">-&gt;</span><span class="default">test_obj</span><span class="keyword">-&gt;</span><span class="default">prop </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="comment">// fine if $a did not have a set method declared.<br /><br /></span><span class="default">?&gt;<br /></span><br />All above tested in 5.3.2.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98691">  <div class="votes">
    <div id="Vu98691">
    <a href="https://www.php.net/manual/vote-note.php?id=98691&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98691">
    <a href="https://www.php.net/manual/vote-note.php?id=98691&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98691" title="50% like this...">
    0
    </div>
  </div>
  <a href="language.oop5.magic.php.html#98691" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#98691"> &para;</a><div class="date" title="2010-06-30 09:29"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom98691">
<div class="phpcode"><code><span class="html">
C++-style operator overloading finally makes an appearance with the introduction to __invoke().&nbsp; Unfortunately, with just '()'.&nbsp; In that sense, it is no more useful than having a default class method (probably quite useful actually) and not having to type out an entire method name.&nbsp; Complimenting wbcarts at juno dot com's point class below, the following allows calculating distance between one or more graph points...<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">point </span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$x</span><span class="keyword">;<br />&nbsp; &nbsp; public </span><span class="default">$y</span><span class="keyword">;<br /><br />&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= (int) </span><span class="default">$x</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y </span><span class="keyword">= (int) </span><span class="default">$y</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; function </span><span class="default">__invoke</span><span class="keyword">() {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$total_distance </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current_loc </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$args </span><span class="keyword">as </span><span class="default">$arg</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">) and (</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">) === </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">))) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$total_distance </span><span class="keyword">+= </span><span class="default">sqrt</span><span class="keyword">(</span><span class="default">pow</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">- </span><span class="default">$current_loc</span><span class="keyword">-&gt;</span><span class="default">x</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) + </span><span class="default">pow</span><span class="keyword">((int) </span><span class="default">$arg</span><span class="keyword">-&gt;</span><span class="default">y </span><span class="keyword">- </span><span class="default">$current_loc</span><span class="keyword">-&gt;</span><span class="default">y</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current_loc </span><span class="keyword">= </span><span class="default">$arg</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"Arguments must be objects of this class."</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$total_distance</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; }<br /><br /></span><span class="default">$p1 </span><span class="keyword">= new </span><span class="default">point</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br /></span><span class="default">$p2 </span><span class="keyword">= new </span><span class="default">point</span><span class="keyword">(</span><span class="default">23</span><span class="keyword">,-</span><span class="default">6</span><span class="keyword">);<br /></span><span class="default">$p3 </span><span class="keyword">= new </span><span class="default">point</span><span class="keyword">(</span><span class="default">15</span><span class="keyword">,</span><span class="default">20</span><span class="keyword">);<br />echo </span><span class="default">$p1</span><span class="keyword">(</span><span class="default">$p2</span><span class="keyword">,</span><span class="default">$p3</span><span class="keyword">,</span><span class="default">$p1</span><span class="keyword">); </span><span class="comment">// round trip 73.89<br /><br /></span><span class="default">?&gt;<br /></span><br />Functionally, __invoke() can also be used to mimic the use of variable functions.&nbsp; Sadly, attempting any calling of __invoke() on a static level will produce a fatal error.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83556">  <div class="votes">
    <div id="Vu83556">
    <a href="https://www.php.net/manual/vote-note.php?id=83556&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd83556">
    <a href="https://www.php.net/manual/vote-note.php?id=83556&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V83556" title="50% like this...">
    0
    </div>
  </div>
  <a href="language.oop5.magic.php.html#83556" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#83556"> &para;</a><div class="date" title="2008-05-31 04:24"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom83556">
<div class="phpcode"><code><span class="html">
Serializing objects is problematic with references. This is solved redefining the __sleep() magic method. This is also problematic when parent class has private variables since the parent object is not accessible nor its private variables from within the child object.<br /><br />I found a solution that seems working for classes that implements this __sleep() method, and for its subclasses. Without more work in subclasses. The inheritance system does the trick.<br /><br />Recursively __sleep() call parent' __sleep() and return the whole array of variables of the object instance to be serialized.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">foo </span><span class="keyword">{<br />}<br /><br />class </span><span class="default">a </span><span class="keyword">{<br />&nbsp; private </span><span class="default">$var1</span><span class="keyword">;<br /><br />&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">foo </span><span class="keyword">&amp;</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">) {<br />&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">var1 </span><span class="keyword">= &amp;</span><span class="default">$obj</span><span class="keyword">;<br />&nbsp; }<br /><br />&nbsp; </span><span class="comment">/** Return its variables array, if its parent exists and the __sleep method is accessible, call it and push the result into the array and return the whole thing. */<br />&nbsp; </span><span class="keyword">public function </span><span class="default">__sleep</span><span class="keyword">() {<br />&nbsp; &nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">get_object_vars</span><span class="keyword">(&amp;</span><span class="default">$this</span><span class="keyword">));<br />&nbsp; &nbsp; if (</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">parent</span><span class="keyword">, </span><span class="string">'__sleep'</span><span class="keyword">)) {<br />&nbsp; &nbsp; &nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__sleep</span><span class="keyword">();<br />&nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">);<br />&nbsp; &nbsp; };<br />&nbsp; &nbsp; return </span><span class="default">$a</span><span class="keyword">;<br />&nbsp; }<br />}<br /><br />class </span><span class="default">b </span><span class="keyword">extends </span><span class="default">a </span><span class="keyword">{<br />&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">foo </span><span class="keyword">&amp;</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">) {<br />&nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">);<br />&nbsp; }<br />}<br /><br /></span><span class="default">session_start</span><span class="keyword">();<br /></span><span class="default">$myfoo </span><span class="keyword">= &amp;new </span><span class="default">foo</span><span class="keyword">();<br /></span><span class="default">$myb </span><span class="keyword">= &amp;new </span><span class="default">b</span><span class="keyword">(</span><span class="default">$myfoo</span><span class="keyword">);<br /></span><span class="default">$myb </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(&amp;</span><span class="default">$myb</span><span class="keyword">));<br /></span><span class="default">?&gt;<br /></span><br />This should work, I haven't tested deeper.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48849">  <div class="votes">
    <div id="Vu48849">
    <a href="https://www.php.net/manual/vote-note.php?id=48849&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd48849">
    <a href="https://www.php.net/manual/vote-note.php?id=48849&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V48849" title="50% like this...">
    0
    </div>
  </div>
  <a href="language.oop5.magic.php.html#48849" class="name">
  <strong class="user"><em>krisj1010 at gmail.com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#48849"> &para;</a><div class="date" title="2005-01-09 12:09"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom48849">
<div class="phpcode"><code><span class="html">
If you are attempting to write an abstract/base class which automates the __sleep process in PHP5 you will run into some trouble if the subclasses which are being serialized have private/protected variables you need to be serialized.&nbsp; <br /><br />The reason is, even though get_class($this) within the base class will return the subclass -- get_class_vars(get_class($this)) will *not* return the subclass' protected/private variables.&nbsp; Which makes sense -- using OO principles.&nbsp; <br /><br />However, when automating __sleep it becomes necissary to have access to the private/protected subclass variables because their names have to be returned by __sleep.<br /><br />So here is the work around:<br /><span class="default">&lt;?php<br /></span><span class="keyword">public function </span><span class="default">__sleep</span><span class="keyword">()<br />{<br /> ... </span><span class="default">code </span><span class="keyword">...<br /></span><span class="default">$sleepVars&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">((array)</span><span class="default">$this</span><span class="keyword">);<br />return </span><span class="default">$sleepVars</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span><br />Even though array_keys includes more information about the variable names than just the variable names -- it still seems to work appropriately.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107031">  <div class="votes">
    <div id="Vu107031">
    <a href="https://www.php.net/manual/vote-note.php?id=107031&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd107031">
    <a href="https://www.php.net/manual/vote-note.php?id=107031&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V107031" title="49% like this...">
    -1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#107031" class="name">
  <strong class="user"><em>osbertv at yahoo dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#107031"> &para;</a><div class="date" title="2011-12-29 09:42"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom107031">
<div class="phpcode"><code><span class="html">
Invoking a class inside a class results in an error.<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">A<br /></span><span class="keyword">{<br />&nbsp; &nbsp; public function </span><span class="default">__invoke</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Invoking A() Class"</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br />class </span><span class="default">B <br /></span><span class="keyword">{<br />&nbsp; &nbsp; public </span><span class="default">$a</span><span class="keyword">;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; public function </span><span class="default">__invoke</span><span class="keyword">()<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Invoking B() Class"</span><span class="keyword">;<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="default">$a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br /></span><span class="default">$b </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br /></span><span class="default">$a</span><span class="keyword">();<br /></span><span class="default">$b</span><span class="keyword">();<br /></span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">a</span><span class="keyword">();<br /><br /></span><span class="default">?&gt;<br /></span><br />returns<br />Invoking B() Class<br />PHP Fatal error:&nbsp; Call to undefined method B::a()</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112209">  <div class="votes">
    <div id="Vu112209">
    <a href="https://www.php.net/manual/vote-note.php?id=112209&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd112209">
    <a href="https://www.php.net/manual/vote-note.php?id=112209&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V112209" title="48% like this...">
    -1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#112209" class="name">
  <strong class="user"><em>danillo dot paiva dot toledo at gmail dot com</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#112209"> &para;</a><div class="date" title="2013-05-16 07:39"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112209">
<div class="phpcode"><code><span class="html">
While I was studying Ruby I saw as such interesting things as properties created + its getters and setters in just one line.<br /><br />I tryied to do the same in PHP and this is the code I have<br /><br />class Father {<br />&nbsp; &nbsp; public function __call($name, $args) {<br />&nbsp; &nbsp; &nbsp; &nbsp; if(isset($this-&gt;$name)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(isset($args[0]))<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;$name = $args[0];<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;$name;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; return false;<br />&nbsp; &nbsp; }<br />}<br /><br />class Child extends Father {<br />&nbsp; &nbsp; public $country = "Brazil";<br />&nbsp; &nbsp; public $state = "Sao Paulo";<br />}<br /><br />Sometimes we don't need things like that on all classes but is quite interesting.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75010">  <div class="votes">
    <div id="Vu75010">
    <a href="https://www.php.net/manual/vote-note.php?id=75010&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd75010">
    <a href="https://www.php.net/manual/vote-note.php?id=75010&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V75010" title="48% like this...">
    -1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#75010" class="name">
  <strong class="user"><em>Travis Swicegood</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#75010"> &para;</a><div class="date" title="2007-05-08 07:43"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom75010">
<div class="phpcode"><code><span class="html">
There is no need to use eval() to mimic mixins (i.e., multiple inheritance) within PHP 5.&nbsp; You only need to:<br /><br /><span class="default">&lt;?php<br /><br /></span><span class="keyword">class </span><span class="default">MyClass<br /></span><span class="keyword">{<br />&nbsp; &nbsp; private </span><span class="default">$_obj </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_obj </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">;<br />&nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_obj</span><span class="keyword">, </span><span class="default">$method</span><span class="keyword">)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"unknown method [</span><span class="default">$method</span><span class="string">]"</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_obj</span><span class="keyword">, </span><span class="default">$method</span><span class="keyword">),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$args<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);<br />&nbsp; &nbsp; }<br />}<br /><br /></span><span class="default">?&gt;<br /></span><br />You could just as easily add an addMixin() method that would allow you to add multiple objects to an array, and then iterate over that array until you found the right method.&nbsp; As noted, these are referred to as a Mixins in other languages.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59560">  <div class="votes">
    <div id="Vu59560">
    <a href="https://www.php.net/manual/vote-note.php?id=59560&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd59560">
    <a href="https://www.php.net/manual/vote-note.php?id=59560&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V59560" title="47% like this...">
    -1
    </div>
  </div>
  <a href="language.oop5.magic.php.html#59560" class="name">
  <strong class="user"><em>docey</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#59560"> &para;</a><div class="date" title="2005-12-09 08:44"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom59560">
<div class="phpcode"><code><span class="html">
about __sleep and _wakeup, consider using a method like this:<br /><br />class core<br />{<br /><br /> var $sub_core; //ref of subcore<br /> var $_sleep_subcore; // place where serialize version of sub_core will be stored<br /><br /> function core(){<br />&nbsp; $this-&gt;sub_core = new sub_core();<br />&nbsp; return true;<br /> }<br /><br /> function __wakeup()<br /> {<br />&nbsp; // on wakeup of core, core unserializes sub_core<br />&nbsp; // wich it had stored when it was serialized itself<br />&nbsp; $this-&gt;sub_core = unserialize($this-&gt;_sleep_subcore);<br />&nbsp; return true;<br /> }<br /><br /> function __sleep()<br /> {<br />&nbsp; // sub_core will be serialized when core is serialized.<br />&nbsp; // the serialized subcore will be stored as a string inside core.<br />&nbsp;&nbsp; $this-&gt;_sleep_subcore = serialize($this-&gt;sub_core);<br />&nbsp;&nbsp; $return_arr[] = "_sleep_subcore";<br />&nbsp;&nbsp; return $return_arr;<br /> }<br /><br />}<br /><br />class sub_core<br />{<br /> var $info;<br /><br /> function sub_core()<br /> {<br />&nbsp; $this-&gt;info["somedata"] = "somedata overhere"<br /> }<br /><br /> function __wakeup()<br /> {<br />&nbsp; return true;<br /> }<br /><br /> function __sleep()<br /> {<br />&nbsp; $return_arr[] = "info"<br />&nbsp; return $return_arr; <br /> }<br /><br />}<br /><br />this way subcore is being serialized by core when core is being serialized. subcore handles its own data and core stores it as a serialize string inside itself. on wakeup core unserializes subcore. <br /><br />this may have a performance cost, but if you have many objects connected this way this is the best way of serializing them. you only need to serialize the the main object wich will serialize all those below which will serialize all those below them again. in effect causing a sort of chainreaction in wich each object takes care of its own info.<br /><br />offcoarse you always need to store the eventualy serialized string in a safe place. somebody got experience with this way of __wakeup and __sleep. <br /><br />works in PHP4&amp;5</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98963">  <div class="votes">
    <div id="Vu98963">
    <a href="https://www.php.net/manual/vote-note.php?id=98963&amp;page=language.oop5.magic&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd98963">
    <a href="https://www.php.net/manual/vote-note.php?id=98963&amp;page=language.oop5.magic&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V98963" title="42% like this...">
    -6
    </div>
  </div>
  <a href="language.oop5.magic.php.html#98963" class="name">
  <strong class="user"><em>tom</em></strong></a><a class="genanchor" href="language.oop5.magic.php.html#98963"> &para;</a><div class="date" title="2010-07-18 03:20"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom98963">
<div class="phpcode"><code><span class="html">
Note a common pitfall when using __wakeup.<br /><br />If you unserialize a datastructure, you may not rely on the parent object to have been fully unserialized by the time __wakeup is called. Example<br /><br /><span class="default">&lt;?php<br /></span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br /> public </span><span class="default">$b</span><span class="keyword">;<br /> public </span><span class="default">$name</span><span class="keyword">;<br />}<br /><br />class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br /> public </span><span class="default">$parent</span><span class="keyword">;<br /> public function </span><span class="default">__wakeup</span><span class="keyword">() {<br />&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$parent</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">);<br /> }<br />}<br /><br /></span><span class="default">$a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br /></span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="string">"foo"</span><span class="keyword">;<br /></span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">b </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br /></span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">b</span><span class="keyword">-&gt;</span><span class="default">parent </span><span class="keyword">= </span><span class="default">$a</span><span class="keyword">;<br /></span><span class="default">$s </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br /></span><span class="default">$a </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br />Expected output: "foo".<br />Actual output: NULL.<br /><br />Reason: $b is unserialized before $name. By the time B::__wakeup is called, $a-&gt;name does not yet have a value.<br /><br />So be aware that the order in which your class variables are defined is important! You need to manually order them by dependencies - or write a __sleep function and order them by depencies there. (Currently I can't tell which option I hate more)</span>
</code></div>
  </div>
 </div></div>

 <div class="foot"><a href="https://www.php.net/manual/add-note.php?sect=language.oop5.magic&amp;redirect=https://www.php.net/manual/ru/language.oop5.magic.php"><img src='https://www.php.net/images/notes-add@2x.png' alt='add a note' width='12' height='12'> <small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="https://www.php.net/manual/ru/language.oop5.php">Классы и объекты</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="https://www.php.net/manual/ru/oop5.intro.php" title="Введение">Введение</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.basic.php" title="Основы">Основы</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.properties.php" title="Свойства">Свойства</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.constants.php" title="Константы классов">Константы классов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.autoload.php" title="Автоматическая загрузка классов">Автоматическая загрузка классов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.decon.php" title="Конструкторы и деструкторы">Конструкторы и деструкторы</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.visibility.php" title="Область видимости">Область видимости</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.inheritance.php" title="Наследование">Наследование</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.paamayim-nekudotayim.php" title="Оператор разрешения области видимости (::)">Оператор разрешения области видимости (::)</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.static.php" title="Ключевое слово static">Ключевое слово static</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.abstract.php" title="Абстрактные классы">Абстрактные классы</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.interfaces.php" title="Интерфейсы объектов">Интерфейсы объектов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.traits.php" title="Трейты">Трейты</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.anonymous.php" title="Анонимные классы">Анонимные классы</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.overloading.php" title="Перегрузка">Перегрузка</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.iterations.php" title="Итераторы объектов">Итераторы объектов</a>
                        </li>
                                                <li class="current">
                            <a href="language.oop5.magic.php.html" title="Магические методы">Магические методы</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.final.php" title="Ключевое слово final">Ключевое слово final</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.cloning.php" title="Клонирование объектов">Клонирование объектов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.object-comparison.php" title="Сравнение объектов">Сравнение объектов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.late-static-bindings.php" title="Позднее статическое связывание">Позднее статическое связывание</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.references.php" title="Объекты и ссылки">Объекты и ссылки</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.serialization.php" title="Сериализация объектов">Сериализация объектов</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.variance.php" title="Ковариантность и контравариантность">Ковариантность и контравариантность</a>
                        </li>
                                                <li class="">
                            <a href="https://www.php.net/manual/ru/language.oop5.changelog.php" title="Журнал изменений ООП">Журнал изменений ООП</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="https://www.php.net/copyright.php">Copyright &copy; 2001-2022 The PHP Group</a></li>
        <li><a href="https://www.php.net/my.php">My PHP.net</a></li>
        <li><a href="https://www.php.net/contact.php">Contact</a></li>
        <li><a href="https://www.php.net/sites.php">Other PHP.net sites</a></li>
        <li><a href="https://www.php.net/privacy.php">Privacy policy</a></li>
        <li><a href="https://github.com/php/web-php/blob/master/manual%2Fru%2Flanguage.oop5.magic.php">View Source</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" integrity="sha384-aBL3Lzi6c9LNDGvpHkZrrm3ZVsIwohDD7CDozL0pk8FwCrfmV7H9w8j3L7ikEv6h" crossorigin="anonymous"></script>
<script src="https://www.php.net/cached.php?t=1421837618&amp;f=/js/ext/modernizr.js"></script>
<script src="https://www.php.net/cached.php?t=1421837618&amp;f=/js/ext/hogan-2.0.0.min.js"></script>
<script src="https://www.php.net/cached.php?t=1421837618&amp;f=/js/ext/typeahead.min.js"></script>
<script src="https://www.php.net/cached.php?t=1421837618&amp;f=/js/ext/mousetrap.min.js"></script>
<script src="https://www.php.net/cached.php?t=1421837618&amp;f=/js/search.js"></script>
<script src="https://www.php.net/cached.php?t=1637324403&amp;f=/js/common.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="https://www.php.net/images/to-top@2x.png"></a>

</body>
</html>
