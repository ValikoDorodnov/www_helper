<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <meta name="referrer" content="unsafe-url">
  <title>Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL) / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.da6c6b36.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.4de4e95a.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.92df6f6d.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.4de4e95a.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.2822d469ec31a56409ac330bbcf7fcbf.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/vk\/blog\/352444\/"},"headline":"Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)","datePublished":"2018-04-13T12:36:49+03:00","dateModified":"2018-04-13T15:56:54+03:00","author":{"@type":"Person","name":"Макс"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Книга &laquo;Безопасность в PHP&raquo; (часть 1) Книга &laquo;Безопасность в PHP&raquo; (часть 2) Книга &laquo;Безопасность в PHP&raquo; (часть 3) Связь через интернет между участниками процесса с...","url":"https:\/\/habr.com\/ru\/company\/vk\/blog\/352444\/#post-content-body","about":["c_vk","h_infosecurity","h_php","h_programming","h_analysis_design","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/352444\/4d0fa5fc775afbef19e9400920a6fdb5\/"]}</script>
  <script src="https://www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.64.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Книга «Безопасность в PHP» (часть 1)
Книга «Безопасность в PHP» (часть 2)
Книга «Безопасность в PHP» (часть 3)
Связь через интернет между участниками процесса сопряжена с рисками. Когда вы..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Книга «Безопасность в PHP» (часть 1)
Книга «Безопасность в PHP» (часть 2)
Книга «Безопасность в PHP» (часть 3)
Связь через интернет между участниками процесса сопряжена с рисками. Когда вы..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Книга «Безопасность в PHP» (часть 1)
Книга «Безопасность в PHP» (часть 2)
Книга «Безопасность в PHP» (часть 3)
Связь через интернет между участниками процесса сопряжена с рисками. Когда вы..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Книга «Безопасность в PHP» (часть 1)
Книга «Безопасность в PHP» (часть 2)
Книга «Безопасность в PHP» (часть 3)
Связь через интернет между участниками процесса сопряжена с рисками. Когда вы..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Книга «Безопасность в PHP» (часть 1)
Книга «Безопасность в PHP» (часть 2)
Книга «Безопасность в PHP» (часть 3)
Связь через интернет между участниками процесса сопряжена с рисками. Когда вы..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="352444" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2018-04-13T09:36:49.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/company/vk/blog/352444/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="php, security, никто не читает теги">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/352444/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="index.html.1.19.html" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/352444/4d0fa5fc775afbef19e9400920a6fdb5/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="https://habr.com/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="https://habr.com/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="https://habr.com/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="https://habr.com/ru/flows/all" class="tm-main-menu__item">
        Все потоки
      </a> <a href="https://habr.com/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="https://habr.com/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="https://habr.com/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="https://habr.com/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="https://habr.com/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="https://habr.com/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="https://habr.com/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="vk" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><div class="tm-company-card__branding tm-company-article__branding tm-company-card__branding_loading"><div class="tm-company-card__branding-placeholder"><!----></div> <a href="https://vk.com/vkteam"><img src="https://habrastorage.org/getpro/habr/branding/174/2c4/3a5/1742c43a5b504987a0fadf577a0bd4de.png" width="100%" class="tm-company-card__branding-image"></a></div></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a href="https://habr.com/ru/company/vk/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="https://habrastorage.org/getpro/habr/company/9ed/c74/6b4/9edc746b484c805ecad1f941b5f7068a.png" width="48" class="tm-entity-image__pic"></div></a> <a href="https://career.habr.com/companies/vk" rel="noopener" target="_blank" class="tm-grade tm-company-card__rating"><div class="tm-rating"><div class="tm-rating__header"><svg height="24" width="24" class="tm-svg-img tm-svg-grade__icon"><title>Оценка компании на Хабр Карьере</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#grade"></use></svg> <div class="tm-rating__counter tm-rating__counter_variant-grade">4.35</div></div> <div class="tm-rating__text tm-rating__text_variant-grade">
    Оценка
  </div></div></a> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">266.34</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div> <!----></div> <div class="tm-company-card__info"><a href="https://habr.com/ru/company/vk/profile/" class="tm-company-card__name">
      VK
    </a> <div class="tm-company-card__description">Технологии, которые объединяют</div></div></div> <!----></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/AloneCoder/" title="AloneCoder" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="https://habrastorage.org/r/w32/getpro/habr/avatars/741/45e/bea/74145ebeab7f222cce402aed2683f9d7.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/AloneCoder/" class="tm-user-info__username">
      AloneCoder
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2018-04-13T09:36:49.000Z" title="2018-04-13, 12:36">13  апреля  2018 в 12:36</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/company/vk/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании VK</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/infosecurity/" class="tm-article-snippet__hubs-item-link"><span>Информационная безопасность</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/php/" class="tm-article-snippet__hubs-item-link"><span>PHP</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/analysis_design/" class="tm-article-snippet__hubs-item-link"><span>Анализ и проектирование систем</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-translation"><span>
        Перевод
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://phpsecurity.readthedocs.io/en/latest/Transport-Layer-Security-%28HTTPS-SSL-and-TLS%29.html" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Padraic Brady
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><p><img src="https://habrastorage.org/r/w1560/webt/t6/ms/ko/t6mskoexiw-nbrlrjfop4wdqixm.png" data-src="https://habrastorage.org/webt/t6/ms/ko/t6mskoexiw-nbrlrjfop4wdqixm.png"/></p><br/>
<p><a href="https://habrahabr.ru/company/mailru/blog/310726/">Книга «Безопасность в PHP» (часть 1)</a><br/>
<a href="https://habrahabr.ru/company/mailru/blog/352440/">Книга «Безопасность в PHP» (часть 2)</a><br/>
<a href="https://habrahabr.ru/company/mailru/blog/352442/">Книга «Безопасность в PHP» (часть 3)</a></p><br/>
<p>Связь через интернет между участниками процесса сопряжена с рисками. Когда вы отправляете платёжное поручение в магазин, используя онлайн-сервис, то совершенно точно не хотите, чтобы злоумышленник мог его перехватить, считать, изменить или заново повторить HTTP-запрос к онлайн-приложению. Только представьте себе последствия того, что атакующий считает куку вашей сессии или изменит получателя платежа, товар, платёжный адрес. Или внедрит в разметку, отправляемую магазином в ответ на запрос пользователя, свой HTML или JavaScript.</p><a name="habracut"></a><br/>
<p>Защита важных и личных данных — это серьёзный бизнес. У пользователей браузеров и приложений крайне высокие ожидания относительно безопасности. Особое значение имеют целостность транзакций по банковским картам, приватности и идентификационной информации. Решение этих задач, когда речь идёт о защите передачи данных между двумя участниками процесса, требует обеспечения безопасности на транспортном уровне, куда обычно входят HTTPS, TLS и SSL.</p><br/>
<p>Основные задачи мер защиты:</p><br/>
<ul>
<li>Безопасное шифрование пересылаемых данных.</li>
<li>Гарантированная идентификация одной или обеих сторон информационного обмена.</li>
<li>Защита от искажения данных.</li>
<li>Защита от атак с повторным воспроизведением.</li>
</ul><br/>
<p>Важнейший момент: для успешной защиты на транспортном уровне необходимо решить все четыре задачи. Если хоть в чём-то мы не преуспеем, то нас ждут серьёзные проблемы.</p><br/>
<p>Многие ошибочно полагают, что шифрование — это ключевая задача, а все остальные необязательны. Это совершенно неверно. При шифровании пересылаемых данных получатель должен иметь возможность их расшифровать. Это возможно тогда, когда клиент и сервер договорились о ключе шифрования (помимо прочего) в ходе фазы переговоров при попытке клиента установить безопасное соединение. Однако злоумышленник способен внедриться между клиентом и сервером с помощью простых методов. Он может заставить клиентскую машину считать его сервером, это называется атакой «человек посередине» (MitM, Man-in-the-Middle). И тогда переговоры о ключе шифрования будут вестись не с настоящим сервером, а с фальшивым. Это позволит злоумышленнику расшифровывать все пересылаемые клиентом данные. Очевидно, что для защиты от этого сценария нам нужно соблюсти второе требование: возможность проверки идентификации сервера, с которым общается клиент. Без этой проверки мы не отличим целевой сервер от подставного.</p><br/>
<p>Так что для безопасной связи необходимо соблюдать все четыре условия. Каждое из них идеально дополняет остальные три, и только все вместе они обеспечивают надёжную и устойчивую безопасность на транспортном уровне (Transport Layer Security, TLS).</p><br/>
<p>Помимо технических аспектов работы TLS, у качественного обеспечения безопасности есть и другая сторона. Например, если мы позволяем пользователю вводить в форму авторизации приложения данные по HTTP, то должны для себя принять возможность MitM-атаки, в ходе которой будут перехвачены и в дальнейшем использованы авторизационные данные. Или если мы позволяем страницам, которые грузятся по HTTPS, подгружать не HTTPS-ресурсы, то должны для себя принять, что у MitM-злоумышленника есть транспорт, с помощью которого он может провести атаки межсайтового скриптинга и превратить пользовательский браузер в заранее запрограммированное оружие, способное прозрачно действовать через браузерное HTTPS-соединение.</p><br/>
<p>Оценить качество любых мер в сфере безопасности нам помогут очевидные критерии, вытекающие из четырёх основных вышеописанных задач:</p><br/>
<ul>
<li>Шифрование: используются ли сильные стандарты шифрования и наборы шифров? </li>
<li>Идентификация: проверяется ли корректность и полнота идентификации сервера?</li>
<li>Искажение данных: полностью ли защищаются пользовательские данные в ходе сессии?</li>
<li>Атаки с повторным воспроизведением: имеются ли методы защиты от злоумышленника, который записывает запросы, чтобы затем снова отправить их на сервер и многократно воспроизвести известные действия или эффекты?</li>
</ul><br/>
<p>Это ключевые вопросы для всей четвёртой части книги. Мы будем углубляться в те или иные подробности, но всё будет так или иначе вращаться вокруг этих вопросов и определения уязвимостей, когда мы не сможем давать утвердительные ответы.</p><br/>
<p>Ещё один важный момент — какие данные должны защищаться. Очевидно, что это реквизиты банковских карт, информация, позволяющая установить личность, и пароли. А что насчёт ID пользовательской сессии? Если мы защищаем пароли, но не ID, то злоумышленник всё ещё может украсть передаваемые куки и выполнить атаку с перехватом сеанса (Session Hijacking attack), олицетворив собой пользователя на его же собственном компьютере. Одной лишь защиты форм авторизации НИКОГДА не достаточно для сохранения авторизационных данных. Лучшая защита достигается, если пользовательская сессия выполняется только в рамках HTTPS с момента ввода данных в форму до завершения сессии.</p><br/>
<p>Теперь вам нужно понять, почему возникло слово «недостаточно». Проблема реализации SSL/TLS заключается не только в их неиспользовании, но и в использовании в недостаточной для максимальной безопасности мере.</p><br/>
<p>Мы рассмотрим недостаточность безопасности на транспортном уровне с трёх точек зрения:</p><br/>
<ul>
<li>Между серверным приложением и сторонним сервером.</li>
<li>Между клиентом и серверным приложением.</li>
<li>Между клиентом и серверным приложением с использованием кастомных политик защиты.</li>
</ul><br/>
<p>К первому пункту относится подтверждение, что наше веб-приложение безопасно подключается к другим участникам процесса. TLS обычно используется для API веб-сервисов и многих других источников входных данных, необходимых для работы приложения.</p><br/>
<p>Ко второму пункту относится взаимодействие пользователей с веб-приложением посредством браузеров или других клиентских приложений. В данном случае мы раскрываем безопасный URL, и нам нужно удостовериться, что меры безопасности реализованы корректно, чтобы не было риска их обхода.</p><br/>
<p>К третьему пункту относятся всякие причудливые решения (curious oddity). Поскольку SSL/TLS имеют репутацию некорректно реализуемых программистами стандартов, существует масса способов обеспечить безопасное подключение без их участия. В качестве примера можно привести использование протоколом OAuth подписанных запросов, которые не требуют SSL/TLS, но предлагают ряд обеспечиваемых теми защитных мер (в частности, опущено шифрование данных запроса). Так что это не идеальное решение, но всё же оно лучше, чем неправильно сконфигурированная SSL/TLS-библиотека.</p><br/>
<p>Прежде чем перейти к подробностям, давайте сначала рассмотрим TLS в целом и получим базовые знания, а потом углубимся во внутренности PHP.</p><br/>
<h3 id="opredeleniya-i-bazovye-uyazvimosti">Определения и базовые уязвимости</h3><br/>
<p>TLS — общее название, описывающее меры по созданию безопасного соединения между двумя участниками с помощью шифрования, проверки идентификации и т. д. Большинство из вас уже знакомы с тремя аббревиатурами: HTTPS, SSL, TLS. Давайте кратко пробежимся по ним и по их взаимосвязям.</p><br/>
<h3 id="ssltls-iz-php-server-server">SSL/TLS из PHP (сервер-сервер)</h3><br/>
<p>Как бы я ни любил PHP как язык программирования, но даже самый поверхностный обзор популярных open source библиотек ясно даёт понять: в них на каждом шагу встречаются уязвимости, связанные с безопасностью на транспортном уровне. И PHP-сообщество терпит эти уязвимости без какой-либо уважительной причины только потому, что проще подвергать пользователей угрозам, чем решать проблемы. Ситуацию усугубляет то, что сам PHP страдает от очень плохой реализации SSL/TLS в PHP-потоках, используемых всюду — от HTTP-клиентов на базе сокетов до <code>file_get_contents()</code> и прочих функций файловой системы. Добавьте к этому тот факт, что авторы PHP-библиотек даже не пытаются обсуждать возможные последствия сбоев SSL/TLS для безопасности.</p><br/>
<p>Если вы не будете предпринимать ничего из описанного в этой главе, то хотя бы выполняйте все HTTPS-запросы с помощью расширения cURL для PHP. Его конфигурация по умолчанию обеспечивает безопасность, к тому же расширение опирается на экспертную оценку большого количества пользователей вне сферы PHP. Так что сделайте этот простой шаг к улучшению безопасности, и вы не пожалеете. Идеальным же решением будет, если авторы PHP наконец очнутся и внедрят во встроенную поддержку SSL/TLS принцип Secure By Default (безопасность по умолчанию).</p><br/>
<p>Моё введение в SSL/TLS в PHP получилось очень грубым. TLS-уязвимости гораздо проще, чем большинство проблем в сфере безопасности, и все мы знаем, какое значение это имеет для браузеров. Но наше серверное приложение — не менее важное звено цепочки обеспечения безопасности пользовательских данных. Так что давайте подробнее рассмотрим SSL/TLS в PHP, в свою очередь, глядя на PHP-потоки и превосходное расширение cURL.</p><br/>
<h4 id="php-potoki">PHP-потоки</h4><br/>
<p>Для тех, кто не знаком с потоками: они нужны для обобщения (generalize) файлов, сети и прочих операций, совместно использующих общую функциональность. Чтобы поток знал, как работать с конкретным протоколом, применяются «обёртки», позволяющие потоку представлять файл, HTTP-запрос, PHAR-архив, URI данных (RFC 2397) и т. д. Чтобы инициировать поток, достаточно вызвать функцию вспомогательного файла (supporting file function) с соответствующим URL, которые обозначают обёртку и целевой ресурс.</p><br/>
<pre><code>file_get_contents('file:///tmp/file.ext');</code></pre><br/>
<p>По умолчанию потоки используют файловую обёртку (File Wrapper), так что обычно вам не нужен URL, достаточно даже относительного пути к файлам. Это очевидно, поскольку большинство функций файловой системы вроде <code>file()</code>, <code>include()</code>, <code>require_once</code> и <code>file_get_contents()</code> принимают поточные ссылки (stream references). Так что перепишем предыдущий пример:</p><br/>
<pre><code>file_get_contents('/tmp/file.ext');</code></pre><br/>
<p>Учитывая обсуждаемую тему, можно сделать и так:</p><br/>
<pre><code>file_get_contents('http://www.example.com');</code></pre><br/>
<p>Поскольку функции файловой системы — например <code>file_get_contents()</code> — поддерживают обёрнутые в HTTP потоки (HTTP wrapped streams), то они формируют в PHP HTTP-клиент, к которому очень просто получить доступ. Их можно использовать, если вы не чувствуете необходимости применять выделенные библиотеки для создания HTTP-клиентов вроде Guzzle, Buzz или классов из фреймворка Zend <code>\Zend\Http\Client</code>. Чтобы ваш простенький клиент заработал, нужно включить опцию <code>allow_url_fopen</code> в файле <code>php.ini</code>. По умолчанию она включена.</p><br/>
<p>Конечно, включение <code>allow_url_fopen</code> влечёт за собой риск атак с удалённым исполнением файлов, обходом контроля доступа или раскрытием информации. Если злоумышленник сможет по своему выбору внедрить в файловую функцию удалённый URI, то он с лёгкостью заставит приложение выполнять, хранить или отображать загруженный файл, в том числе из удалённого ненадёжного источника.</p><br/>
<p>Не забывайте о том, что файлы будут подгружаться из <code>localhost</code>, а значит, смогут обходить контроль доступа на основе ограничений, прописанных на локальном сервере. И если опция <code>allow_url_fopen</code> включена по умолчанию, то для наибольшей безопасности её придётся отключить.</p><br/>
<p>Вернёмся к использованию PHP-потоков в качестве простого HTTP-клиента (а теперь вы знаете, что это <strong>не рекомендуется</strong>). Всё становится интереснее, если вы попробуете сделать так:</p><br/>
<pre><code>$url = 'https://api.twitter.com/1/statuses/public_timeline.json';
$result = file_get_contents($url);</code></pre><br/>
<p>Это простой неаутентифицированный запрос через HTTPS к (бывшему) Twitter API 1.0. Здесь есть серьёзная утечка. Для запросов, выполняемых с помощью HTTPS- (https://) и FTPS- (ftps://) обёрток, PHP использует <code>SSL Context</code>. Здесь есть много настроек для SSL/TLS, а также их значений по умолчанию, которые абсолютно небезопасны. Перепишем пример так, чтобы проиллюстрировать, как можно вставить исходный набор настроек <code>SSL Context</code> в качестве параметра в <code>file_get_contents()</code>:</p><br/>
<pre><code>$url = 'https://api.twitter.com/1/statuses/public_timeline.json';
$contextOptions = array(
    'ssl' => array()
);
$sslContext = stream_context_create($contextOptions);
$result = file_get_contents($url, NULL, $sslContext);</code></pre><br/>
<p>Как говорилось выше, если вы неправильно сконфигурируете SSL/TLS, то приложение будет беззащитно перед атаками «человек посередине». PHP-потоки по умолчанию совершенно небезопасны при работе через SSL/TLS. Так что давайте исправим наш пример, чтобы он стал полностью безопасен.</p><br/>
<pre><code>$url = 'https://api.twitter.com/1/statuses/public_timeline.json';
$contextOptions = array(
    'ssl' => array(
        'verify_peer'   => true,
        'cafile'        => '/etc/ssl/certs/ca-certificates.crt',
        'verify_depth'  => 5,
        'CN_match'      => 'api.twitter.com',
        'disable_compression' => true,
        'SNI_enabled'         => true,
        'ciphers'             => 'ALL!EXPORT!EXPORT40!EXPORT56!aNULL!LOW!RC4'
    )
);
$sslContext = stream_context_create($contextOptions);
$result = file_get_contents($url, NULL, $sslContext);</code></pre><br/>
<p>Теперь всё в порядке! Если сравнить с предыдущей версией, то вы заметите, что мы настроили четыре опции, которые изначально были не настроены или отключены PHP. Давайте разберёмся, что они делают.</p><br/>
<ul>
<li>verify_peer</li>
</ul><br/>
<p>Проверка пира (Peer Verification) — проверка достоверности SSL-сертификата, предоставленного хостом, на который мы отправили HTTPS-запрос. Правильный сертификат подписан закрытым ключом надёжного удостоверяющего центра (Certificate Authority, CA). Проверку можно выполнить с помощью открытого ключа CA, который включается в файловый набор в виде опции <code>cafile</code> для используемого нами SSL Context. Кроме того, сертификат не должен быть просрочен.</p><br/>
<ul>
<li>cafile</li>
</ul><br/>
<p>Настройка <code>cafile</code> должна указывать на валидный файл, содержащий открытый ключ надёжного CA. В PHP это не делается автоматически, поэтому держите ключи в связанном файле специального формата (обычно PEM или CRT). Если вы не можете найти копию, то скачайте и спарсите из <a href="https://curl.haxx.se/ca/cacert.pem">Mozilla VCS</a>. Без этого файла невозможно проверить пир, и запрос не будет выполнен.</p><br/>
<ul>
<li>verify_depth</li>
</ul><br/>
<p>Эта настройка задаёт максимально допустимое количество промежуточных издателей сертификатов, т. е. количество CA-сертификатов, которые могут использоваться при проверке исходного клиентского сертификата.</p><br/>
<ul>
<li>CN_match</li>
</ul><br/>
<p>Три предыдущие опции относятся к проверке предоставляемого сервером сертификата. Однако они не помогают нам понять, валиден ли он запрашиваемому нами доменному имени или IP, т. е. части URL, относящейся к хосту. Чтобы выяснить, привязан ли сертификат к текущему домену/IP, выполним проверку хоста (Host Verification). В PHP для этого нужно задать <code>CN_match</code> значение хоста (в SSL Context), включая поддомен, если есть. Пока задана эта опция, PHP будет выполнять внутреннюю проверку. Если же этого не делать, то во время атаки «человек посередине» злоумышленник может предоставить валидный сертификат, подписанный надёжным CA. Но сертификат будет валидным для домена, находящегося под контролем атакующего, а не для того домена, к которому вы хотели подключиться. Настройка опции <code>CN_match</code> поможет определить несовпадение сертификатов и приведёт к невыполнению HTTPS-запроса.</p><br/>
<p>Поскольку используемый злоумышленником валидный сертификат будет содержать идентификационную информацию атакующего (это условие его получения!), то имейте в виду, что подкованному злоумышленнику доступно любое количество валидных, подписанных CA сертификатов в комплекте с соответствующими закрытыми ключами. Они могли быть украдены у других компаний либо проскользнуть через проверку надёжных CA. Так это произошло в 2011 году, когда DigiNotor выпустил для <code>google.com</code> сертификат для неизвестной стороны. Она использовала его для атак «человек посередине», преимущественно против иранских пользователей.</p><br/>
<ul>
<li>disable_compression</li>
</ul><br/>
<p>Эта опция появилась в PHP 5.4.13. Она нужна для защиты от атак CRIME и других атак с дополнением блоков наподобие BEAST. На момент написания этой части книги опция была доступна уже 10 месяцев. Потребовалось немало терпения, чтобы обнаружить практически единственный пример её использования в open source PHP.</p><br/>
<ul>
<li>SNI_enabled</li>
</ul><br/>
<p>Включает поддержку указания имени сервера (Server Name Indication), когда любой одиночный IP может быть настроен для работы нескольких SSL-сертификатов, чтобы не ограничиваться одним сертификатом для всех сайтов или не HTTP-сервисов, хостящихся на этом IP.</p><br/>
<ul>
<li>ciphers</li>
</ul><br/>
<p>Эта настройка помогает отображать, какие шифры следует или не следует выбирать при установке SSL/TLS-соединений. Список по умолчанию предоставляется расширением openssl. Он содержит небезопасные шифры, которые стоит отключить, если только вы не вынуждены их применять. Нижеприведённый список, использующий принятый в openssl синтаксис, был реализован cURL в январе 2014-го. Предложенный Mozilla альтернативный список может быть лучше, поскольку упор в нём сделан на полную безопасность пересылки (Perfect Forward Secrecy), это лучший практический подход. Список Mozilla длиннее:</p><br/>
<pre><code>ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:ECDHE-RSA-RC4-SHA:ECDHE-ECDSA-RC4-SHA:AES128:AES256:RC4-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!3DES:!MD5:!PSK</code></pre><br/>
<h3 id="ogranicheniya"><em>Ограничения</em></h3><br/>
<p>Как описано выше, проверка предоставленного сервером сертификата на валидность для хоста, указанного в используемом вами URL, при атаке «человек посередине» не позволяет просто подсунуть любой валидный сертификат, купленный или полученный нелегально. Это один из четырёх неотъемлемых шагов, позволяющих сделать ваше соединение полностью безопасным.</p><br/>
<p>Система выполняет проверку благодаря параметру <code>CN_match</code>, объявляемому <code>SSL Context</code> в HTTPS-обёртке PHP. Но у него есть недостаток. На момент написания книги проверялось лишь общее наименование (Common Name, CN) SSL-сертификата, а валидность определяемого сертификатом поля «дополнительное имя субъекта» (Subject Alternative Name, SAN) не проверялась. SAN позволяет защищать несколько имён доменов с помощью одного SSL-сертификата, поэтому оно крайне важно и поддерживается всеми современными браузерами. А поскольку PHP пока что не поддерживает проверку SAN, то SSL/TLS-подключения к домену, защищённому таким сертификатом, установлены не будут. Поддержка SAN появится в PHP с версии 5.6.</p><br/>
<p>C другой стороны, расширение cURL из коробки поддерживает SAN, так что его использование гораздо надёжнее и предпочтительнее по сравнению со встроенными в PHP HTTPS/FTPS-обёртками. В связи с этим применение PHP-потоков с большой вероятностью может привести к ошибочному поведению, и нетерпеливые программисты просто отключат проверку хоста в целом, что крайне нежелательно делать.</p><br/>
<h3 id="ssl-context-v-php-soketah"><em>SSL Context в PHP-сокетах</em></h3><br/>
<p>Многие HTTP-клиенты в PHP предлагают и cURL-адаптер, и используемый по умолчанию PHP-сокет адаптер. Применение последнего по умолчанию говорит о том, что cURL — опциональное расширение, на практике его можно отключить.</p><br/>
<p>PHP-сокеты используют тот же ресурс <code>SSL Context</code>, что и PHP-потоки, поэтому здесь присутствуют те же проблемы и ограничения, что описаны выше. Побочный эффект: многие основные HTTP-клиенты, скорее всего, априори ненадёжны и менее безопасны, чем должны быть. Подобные клиентские библиотеки, когда это возможно, необходимо конфигурировать так, чтобы они использовали cURL-адаптер. Также проверяйте, чтобы клиенты не забывали применять правильный подход к обеспечению безопасности SSL/TLS.</p><br/>
<h3 id="dopolnitelnye-riski"><em>Дополнительные риски</em></h3><br/>
<h3 id="rasshirenie-curl">Расширение cURL</h3><br/>
<p>В отличие от PHP-потоков, расширение cURL лишь передаёт данные, в том числе HTTP-запросы. Также, в отличие от <code>SSL Context</code> потоков, cURL по умолчанию безопасно выполняет запросы через SSL/TLS. Вам для этого ничего не нужно делать, если только оно не было скомпилировано без хранилища пакета CA-сертификатов (например, без файла cert.pem или ca-bundle.crt с сертификатами надёжных CA).</p><br/>
<p>Поскольку это не требует особого подхода, вы можете вызвать Twitter API — аналогично тому, как мы делали это раньше для SSL/TLS с использованием PHP-потока. Минимум хлопот, и не надо беспокоиться о том, что вы забудете о каких-то опциях, которые откроют вас для атаки «человек посередине».</p><br/>
<pre><code>$url = 'https://api.twitter.com/1/statuses/public_timeline.json';
$req = curl_init($url);
curl_setopt($req, CURLOPT_RETURNTRANSFER, TRUE);
$result = curl_exec($req);</code></pre><br/>
<p>Поэтому для HTTPS-запросов рекомендую cURL. По умолчанию это безопасно, а PHP-потоки — наверняка нет. В противном случае просто используйте cURL, это избавит вас от головной боли. В конечном счёте cURL безопаснее, требует меньше кода и с меньшей вероятностью подвержен сбоям в безопасности SSL/TLS по вине ошибок человека.</p><br/>
<p>На момент написания книги PHP 5.6 достиг версии alpha1. В финальном релизе появятся более безопасные значения по умолчанию для PHP-потоков и сокет-соединений через SSL/TLS. Эти нововведения не будут портированы в PHP 5.3, 5.4 или 5.5. Поэтому программистам придётся сознательно внедрять безопасные настройки по умолчанию, пока PHP 5.6 не превратится в необходимый минимум.</p><br/>
<p>Конечно, если расширение cURL было включено без настройки размещения пакета надёжных сертификатов, то вышеприведённый пример работать не будет. Для публично распространяемых библиотек нужно принудительно настраивать безопасное поведение:</p><br/>
<pre><code>$url = 'https://api.twitter.com/1/statuses/public_timeline.json';
$req = curl_init($url);
curl_setopt($req, CURLOPT_RETURNTRANSFER, TRUE);
$result = curl_exec($req);

/**
 * Проверяет, является ли ошибка сбоем SSL, повторяет попытку с помощью пакета 
 * CA-сертификатов, предполагая, что локальный сервер не сконфигурирован 
 * для ext/curl. Ошибка 77 ссылается на CURLE_SSL_CACERT_BADFILE, который 
 * по какой-то причине не определён в качестве константы в мануале PHP.
*/
$error = curl_errno($req);
if ($error == CURLE_SSL_PEER_CERTIFICATE || $error == CURLE_SSL_CACERT
|| $error == 77) {
    curl_setopt($req, CURLOPT_CAINFO, __DIR__ . '/cert-bundle.crt');
    $result = curl_exec($req);
}

/**
 * Все последующие ошибки нельзя исправить без нарушения безопасности.
 * Поэтому не пытайтесь отключить SSL и попробовать снова ;).
 */</code></pre><br/>
<p>Самая сложная часть, очевидно, распространение файла с пакетом сертификатов <code>cert-bundle.crt</code> или <code>cafile.pem</code> (имя файла варьируется в зависимости от источника!). Сертификат любого CA может быть в любое время аннулирован большинством браузеров в случае нарушения их безопасности или процессов рецензирования (peer review), так что долго не обновлять файл с сертификатами — не лучшая идея. Тем не менее самое очевидное решение — распространять копию файла с библиотекой или приложением, для которого он требуется.</p><br/>
<p>Если вы не можете строго контролировать обновление распространяемого пакета сертификатов или вам нужен инструмент, способный периодически выполнять за вас эту проверку, воспользуйтесь <a href="https://github.com/EvanDotPro/Sslurp">Sslurp</a>.</p><br/>
<h2 id="ssltls-soedineniya-so-storony-klienta-klientbrauzer-server">SSL/TLS-соединения со стороны клиента (клиент/браузер-сервер)</h2><br/>
<p>Большая часть того, о чём мы говорили до этого, была связана с SSL/TLS-соединениями, устанавливаемыми с другим сервером по инициативе PHP веб-приложения. Конечно, есть ещё ряд проблем в безопасности, когда приложение оказывает SSL/TLS-поддержку клиентским браузерам и другим приложениям. Здесь возникает риск атак, связанных с уязвимостями защиты на транспортном уровне.</p><br/>
<p>Если вдуматься, то всё это довольно просто. Скажем, я создаю онлайн-приложение, обеспечивающее защиту при вводе пользовательского пароля. Форма авторизации обслуживается через HTTPS, и данные из неё тоже передаются через HTTPS. Миссия выполнена. Чтобы начать работу в своём аккаунте, пользователь был перенаправлен на HTTP URL. Заметили проблему?</p><br/>
<p>Когда есть угроза атаки «человек посередине», мы не должны просто защищать форму авторизации, а потом её закрывать. Куки пользовательских сессий и все вводимые данные, а также весь получаемый пользователями HTML-код не будут в безопасности при работе через HTTP. Злоумышленник может украсть куки и выдать себя за пользователя, может внедрить XSS-код в получаемые пользователями страницы для выполнения задач от лица пользователей или управления их действиями. И для всего этого не нужны пользовательские пароли.</p><br/>
<p>Одна лишь защита процесса аутентификации с помощью HTTPS предотвратит прямую кражу пароля, но не защитит от перехвата сессии, других форм кражи данных, а также от внедрения кода для XSS-атак. Защищая с помощью HTTPS одного лишь пользователя, мы обеспечиваем недостаточную защиту на транспортном уровне. Наши пользователи остаются уязвимы к атакам «человек посередине».</p></div></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bphp%5D" class="tm-tags-list__link">php</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsecurity%5D" class="tm-tags-list__link">security</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BD%D0%B8%D0%BA%D1%82%D0%BE%20%D0%BD%D0%B5%20%D1%87%D0%B8%D1%82%D0%B0%D0%B5%D1%82%20%D1%82%D0%B5%D0%B3%D0%B8%5D" class="tm-tags-list__link">никто не читает теги</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/company/vk/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании VK
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/infosecurity/" class="tm-hubs-list__link">
    Информационная безопасность
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/php/" class="tm-hubs-list__link">
    PHP
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/analysis_design/" class="tm-hubs-list__link">
    Анализ и проектирование систем
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 16: ↑16 и ↓0</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-rating"></use></svg> <span title="Всего голосов 16: ↑16 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+16</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">10K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    117
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <DIV class="v-portal" style="display:none;"></DIV> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="https://habr.com/ru/company/vk/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="https://habrastorage.org/getpro/habr/company/9ed/c74/6b4/9edc746b484c805ecad1f941b5f7068a.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="https://habr.com/ru/company/vk/profile/" class="tm-company-snippet__title">VK</a> <div class="tm-company-snippet__description">Технологии, которые объединяют</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://facebook.com/insidevk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Facebook
    </a><a href="https://twitter.com/inside_vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Twitter
    </a><a href="https://vk.com/insidevk" rel="noopener" target="_blank" class="tm-article-author__contact">
      ВКонтакте
    </a><a href="https://instagram.com/inside.vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Instagram
    </a><a href="https://telegram.me/inside_vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Telegram
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="https://habr.com/ru/users/AloneCoder/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="https://habrastorage.org/getpro/habr/avatars/741/45e/bea/74145ebeab7f222cce402aed2683f9d7.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 575 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    359
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Макс</span> <a href="https://habr.com/ru/users/AloneCoder/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @AloneCoder
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">¯\_(ツ)_/¯</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="https://habr.com/ru/company/vk/blog/352444/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v25.4b679db1.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 1 
    </span></a> <!----></div></div></div>  <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="1998-10-14T20:00:00.000Z" title="1998-10-15, 00:00">15  октября  1998</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://vk.com/vkteam" target="_blank" class="tm-company-basic-info__link">
      vk.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    5 001–10 000 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2008-08-09T07:42:32.000Z" title="2008-08-09, 11:42">9  августа  2008</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://habr.com/ru/users/AnastasiaGutor/" class="tm-company-basic-info__link">
      Анастасия Гутор
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/company/vk/blog/352444/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr-register/?back=/ru/company/vk/blog/352444/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="https://habr.com/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="https://habr.com/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="https://habr.com/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2022 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"352444":{"id":"352444","timePublished":"2018-04-13T09:36:49+00:00","isCorporative":true,"lang":"ru","titleHtml":"Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)","leadData":{"textHtml":"\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ft6\u002Fms\u002Fko\u002Ft6mskoexiw-nbrlrjfop4wdqixm.png\"\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F310726\u002F\"\u003EКнига «Безопасность в PHP» (часть 1)\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F352440\u002F\"\u003EКнига «Безопасность в PHP» (часть 2)\u003C\u002Fa\u003E\u003Cbr\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F352442\u002F\"\u003EКнига «Безопасность в PHP» (часть 3)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EСвязь через интернет между участниками процесса сопряжена с рисками. Когда вы отправляете платёжное поручение в магазин, используя онлайн-сервис, то совершенно точно не хотите, чтобы злоумышленник мог его перехватить, считать, изменить или заново повторить HTTP-запрос к онлайн-приложению. Только представьте себе последствия того, что атакующий считает куку вашей сессии или изменит получателя платежа, товар, платёжный адрес. Или внедрит в разметку, отправляемую магазином в ответ на запрос пользователя, свой HTML или JavaScript.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Padraic Brady","originalUrl":"https:\u002F\u002Fphpsecurity.readthedocs.io\u002Fen\u002Flatest\u002FTransport-Layer-Security-%28HTTPS-SSL-and-TLS%29.html"}}],"author":{"scoreStats":{"score":359,"votesCount":575},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"63394","alias":"AloneCoder","fullname":"Макс","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F741\u002F45e\u002Fbea\u002F74145ebeab7f222cce402aed2683f9d7.png","speciality":"¯\\_(ツ)_\u002F¯"},"statistics":{"commentsCount":1,"favoritesCount":117,"readingCount":10476,"score":16,"votesCount":16},"hubs":[{"relatedData":null,"id":"4992","alias":"vk","type":"corporative","title":"Блог компании VK","titleHtml":"Блог компании VK","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"260","alias":"php","type":"collective","title":"PHP","titleHtml":"PHP","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"397","alias":"analysis_design","type":"collective","title":"Анализ и проектирование систем","titleHtml":"Анализ и проектирование систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fwebt\u002Ft6\u002Fms\u002Fko\u002Ft6mskoexiw-nbrlrjfop4wdqixm.png\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ft6\u002Fms\u002Fko\u002Ft6mskoexiw-nbrlrjfop4wdqixm.png\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F310726\u002F\"\u003EКнига «Безопасность в PHP» (часть 1)\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F352440\u002F\"\u003EКнига «Безопасность в PHP» (часть 2)\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrahabr.ru\u002Fcompany\u002Fmailru\u002Fblog\u002F352442\u002F\"\u003EКнига «Безопасность в PHP» (часть 3)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСвязь через интернет между участниками процесса сопряжена с рисками. Когда вы отправляете платёжное поручение в магазин, используя онлайн-сервис, то совершенно точно не хотите, чтобы злоумышленник мог его перехватить, считать, изменить или заново повторить HTTP-запрос к онлайн-приложению. Только представьте себе последствия того, что атакующий считает куку вашей сессии или изменит получателя платежа, товар, платёжный адрес. Или внедрит в разметку, отправляемую магазином в ответ на запрос пользователя, свой HTML или JavaScript.\u003C\u002Fp\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЗащита важных и личных данных — это серьёзный бизнес. У пользователей браузеров и приложений крайне высокие ожидания относительно безопасности. Особое значение имеют целостность транзакций по банковским картам, приватности и идентификационной информации. Решение этих задач, когда речь идёт о защите передачи данных между двумя участниками процесса, требует обеспечения безопасности на транспортном уровне, куда обычно входят HTTPS, TLS и SSL.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОсновные задачи мер защиты:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EБезопасное шифрование пересылаемых данных.\u003C\u002Fli\u003E\r\n\u003Cli\u003EГарантированная идентификация одной или обеих сторон информационного обмена.\u003C\u002Fli\u003E\r\n\u003Cli\u003EЗащита от искажения данных.\u003C\u002Fli\u003E\r\n\u003Cli\u003EЗащита от атак с повторным воспроизведением.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВажнейший момент: для успешной защиты на транспортном уровне необходимо решить все четыре задачи. Если хоть в чём-то мы не преуспеем, то нас ждут серьёзные проблемы.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМногие ошибочно полагают, что шифрование — это ключевая задача, а все остальные необязательны. Это совершенно неверно. При шифровании пересылаемых данных получатель должен иметь возможность их расшифровать. Это возможно тогда, когда клиент и сервер договорились о ключе шифрования (помимо прочего) в ходе фазы переговоров при попытке клиента установить безопасное соединение. Однако злоумышленник способен внедриться между клиентом и сервером с помощью простых методов. Он может заставить клиентскую машину считать его сервером, это называется атакой «человек посередине» (MitM, Man-in-the-Middle). И тогда переговоры о ключе шифрования будут вестись не с настоящим сервером, а с фальшивым. Это позволит злоумышленнику расшифровывать все пересылаемые клиентом данные. Очевидно, что для защиты от этого сценария нам нужно соблюсти второе требование: возможность проверки идентификации сервера, с которым общается клиент. Без этой проверки мы не отличим целевой сервер от подставного.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТак что для безопасной связи необходимо соблюдать все четыре условия. Каждое из них идеально дополняет остальные три, и только все вместе они обеспечивают надёжную и устойчивую безопасность на транспортном уровне (Transport Layer Security, TLS).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПомимо технических аспектов работы TLS, у качественного обеспечения безопасности есть и другая сторона. Например, если мы позволяем пользователю вводить в форму авторизации приложения данные по HTTP, то должны для себя принять возможность MitM-атаки, в ходе которой будут перехвачены и в дальнейшем использованы авторизационные данные. Или если мы позволяем страницам, которые грузятся по HTTPS, подгружать не HTTPS-ресурсы, то должны для себя принять, что у MitM-злоумышленника есть транспорт, с помощью которого он может провести атаки межсайтового скриптинга и превратить пользовательский браузер в заранее запрограммированное оружие, способное прозрачно действовать через браузерное HTTPS-соединение.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОценить качество любых мер в сфере безопасности нам помогут очевидные критерии, вытекающие из четырёх основных вышеописанных задач:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EШифрование: используются ли сильные стандарты шифрования и наборы шифров? \u003C\u002Fli\u003E\r\n\u003Cli\u003EИдентификация: проверяется ли корректность и полнота идентификации сервера?\u003C\u002Fli\u003E\r\n\u003Cli\u003EИскажение данных: полностью ли защищаются пользовательские данные в ходе сессии?\u003C\u002Fli\u003E\r\n\u003Cli\u003EАтаки с повторным воспроизведением: имеются ли методы защиты от злоумышленника, который записывает запросы, чтобы затем снова отправить их на сервер и многократно воспроизвести известные действия или эффекты?\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭто ключевые вопросы для всей четвёртой части книги. Мы будем углубляться в те или иные подробности, но всё будет так или иначе вращаться вокруг этих вопросов и определения уязвимостей, когда мы не сможем давать утвердительные ответы.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕщё один важный момент — какие данные должны защищаться. Очевидно, что это реквизиты банковских карт, информация, позволяющая установить личность, и пароли. А что насчёт ID пользовательской сессии? Если мы защищаем пароли, но не ID, то злоумышленник всё ещё может украсть передаваемые куки и выполнить атаку с перехватом сеанса (Session Hijacking attack), олицетворив собой пользователя на его же собственном компьютере. Одной лишь защиты форм авторизации НИКОГДА не достаточно для сохранения авторизационных данных. Лучшая защита достигается, если пользовательская сессия выполняется только в рамках HTTPS с момента ввода данных в форму до завершения сессии.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь вам нужно понять, почему возникло слово «недостаточно». Проблема реализации SSL\u002FTLS заключается не только в их неиспользовании, но и в использовании в недостаточной для максимальной безопасности мере.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМы рассмотрим недостаточность безопасности на транспортном уровне с трёх точек зрения:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EМежду серверным приложением и сторонним сервером.\u003C\u002Fli\u003E\r\n\u003Cli\u003EМежду клиентом и серверным приложением.\u003C\u002Fli\u003E\r\n\u003Cli\u003EМежду клиентом и серверным приложением с использованием кастомных политик защиты.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EК первому пункту относится подтверждение, что наше веб-приложение безопасно подключается к другим участникам процесса. TLS обычно используется для API веб-сервисов и многих других источников входных данных, необходимых для работы приложения.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКо второму пункту относится взаимодействие пользователей с веб-приложением посредством браузеров или других клиентских приложений. В данном случае мы раскрываем безопасный URL, и нам нужно удостовериться, что меры безопасности реализованы корректно, чтобы не было риска их обхода.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EК третьему пункту относятся всякие причудливые решения (curious oddity). Поскольку SSL\u002FTLS имеют репутацию некорректно реализуемых программистами стандартов, существует масса способов обеспечить безопасное подключение без их участия. В качестве примера можно привести использование протоколом OAuth подписанных запросов, которые не требуют SSL\u002FTLS, но предлагают ряд обеспечиваемых теми защитных мер (в частности, опущено шифрование данных запроса). Так что это не идеальное решение, но всё же оно лучше, чем неправильно сконфигурированная SSL\u002FTLS-библиотека.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПрежде чем перейти к подробностям, давайте сначала рассмотрим TLS в целом и получим базовые знания, а потом углубимся во внутренности PHP.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"opredeleniya-i-bazovye-uyazvimosti\"\u003EОпределения и базовые уязвимости\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ETLS — общее название, описывающее меры по созданию безопасного соединения между двумя участниками с помощью шифрования, проверки идентификации и т. д. Большинство из вас уже знакомы с тремя аббревиатурами: HTTPS, SSL, TLS. Давайте кратко пробежимся по ним и по их взаимосвязям.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"ssltls-iz-php-server-server\"\u003ESSL\u002FTLS из PHP (сервер-сервер)\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак бы я ни любил PHP как язык программирования, но даже самый поверхностный обзор популярных open source библиотек ясно даёт понять: в них на каждом шагу встречаются уязвимости, связанные с безопасностью на транспортном уровне. И PHP-сообщество терпит эти уязвимости без какой-либо уважительной причины только потому, что проще подвергать пользователей угрозам, чем решать проблемы. Ситуацию усугубляет то, что сам PHP страдает от очень плохой реализации SSL\u002FTLS в PHP-потоках, используемых всюду — от HTTP-клиентов на базе сокетов до \u003Ccode\u003Efile_get_contents()\u003C\u002Fcode\u003E и прочих функций файловой системы. Добавьте к этому тот факт, что авторы PHP-библиотек даже не пытаются обсуждать возможные последствия сбоев SSL\u002FTLS для безопасности.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли вы не будете предпринимать ничего из описанного в этой главе, то хотя бы выполняйте все HTTPS-запросы с помощью расширения cURL для PHP. Его конфигурация по умолчанию обеспечивает безопасность, к тому же расширение опирается на экспертную оценку большого количества пользователей вне сферы PHP. Так что сделайте этот простой шаг к улучшению безопасности, и вы не пожалеете. Идеальным же решением будет, если авторы PHP наконец очнутся и внедрят во встроенную поддержку SSL\u002FTLS принцип Secure By Default (безопасность по умолчанию).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМоё введение в SSL\u002FTLS в PHP получилось очень грубым. TLS-уязвимости гораздо проще, чем большинство проблем в сфере безопасности, и все мы знаем, какое значение это имеет для браузеров. Но наше серверное приложение — не менее важное звено цепочки обеспечения безопасности пользовательских данных. Так что давайте подробнее рассмотрим SSL\u002FTLS в PHP, в свою очередь, глядя на PHP-потоки и превосходное расширение cURL.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4 id=\"php-potoki\"\u003EPHP-потоки\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля тех, кто не знаком с потоками: они нужны для обобщения (generalize) файлов, сети и прочих операций, совместно использующих общую функциональность. Чтобы поток знал, как работать с конкретным протоколом, применяются «обёртки», позволяющие потоку представлять файл, HTTP-запрос, PHAR-архив, URI данных (RFC 2397) и т. д. Чтобы инициировать поток, достаточно вызвать функцию вспомогательного файла (supporting file function) с соответствующим URL, которые обозначают обёртку и целевой ресурс.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003Efile_get_contents('file:\u002F\u002F\u002Ftmp\u002Ffile.ext');\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПо умолчанию потоки используют файловую обёртку (File Wrapper), так что обычно вам не нужен URL, достаточно даже относительного пути к файлам. Это очевидно, поскольку большинство функций файловой системы вроде \u003Ccode\u003Efile()\u003C\u002Fcode\u003E, \u003Ccode\u003Einclude()\u003C\u002Fcode\u003E, \u003Ccode\u003Erequire_once\u003C\u002Fcode\u003E и \u003Ccode\u003Efile_get_contents()\u003C\u002Fcode\u003E принимают поточные ссылки (stream references). Так что перепишем предыдущий пример:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003Efile_get_contents('\u002Ftmp\u002Ffile.ext');\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУчитывая обсуждаемую тему, можно сделать и так:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003Efile_get_contents('http:\u002F\u002Fwww.example.com');\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоскольку функции файловой системы — например \u003Ccode\u003Efile_get_contents()\u003C\u002Fcode\u003E — поддерживают обёрнутые в HTTP потоки (HTTP wrapped streams), то они формируют в PHP HTTP-клиент, к которому очень просто получить доступ. Их можно использовать, если вы не чувствуете необходимости применять выделенные библиотеки для создания HTTP-клиентов вроде Guzzle, Buzz или классов из фреймворка Zend \u003Ccode\u003E\\Zend\\Http\\Client\u003C\u002Fcode\u003E. Чтобы ваш простенький клиент заработал, нужно включить опцию \u003Ccode\u003Eallow_url_fopen\u003C\u002Fcode\u003E в файле \u003Ccode\u003Ephp.ini\u003C\u002Fcode\u003E. По умолчанию она включена.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКонечно, включение \u003Ccode\u003Eallow_url_fopen\u003C\u002Fcode\u003E влечёт за собой риск атак с удалённым исполнением файлов, обходом контроля доступа или раскрытием информации. Если злоумышленник сможет по своему выбору внедрить в файловую функцию удалённый URI, то он с лёгкостью заставит приложение выполнять, хранить или отображать загруженный файл, в том числе из удалённого ненадёжного источника.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНе забывайте о том, что файлы будут подгружаться из \u003Ccode\u003Elocalhost\u003C\u002Fcode\u003E, а значит, смогут обходить контроль доступа на основе ограничений, прописанных на локальном сервере. И если опция \u003Ccode\u003Eallow_url_fopen\u003C\u002Fcode\u003E включена по умолчанию, то для наибольшей безопасности её придётся отключить.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВернёмся к использованию PHP-потоков в качестве простого HTTP-клиента (а теперь вы знаете, что это \u003Cstrong\u003Eне рекомендуется\u003C\u002Fstrong\u003E). Всё становится интереснее, если вы попробуете сделать так:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$url = 'https:\u002F\u002Fapi.twitter.com\u002F1\u002Fstatuses\u002Fpublic_timeline.json';\n$result = file_get_contents($url);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭто простой неаутентифицированный запрос через HTTPS к (бывшему) Twitter API 1.0. Здесь есть серьёзная утечка. Для запросов, выполняемых с помощью HTTPS- (https:\u002F\u002F) и FTPS- (ftps:\u002F\u002F) обёрток, PHP использует \u003Ccode\u003ESSL Context\u003C\u002Fcode\u003E. Здесь есть много настроек для SSL\u002FTLS, а также их значений по умолчанию, которые абсолютно небезопасны. Перепишем пример так, чтобы проиллюстрировать, как можно вставить исходный набор настроек \u003Ccode\u003ESSL Context\u003C\u002Fcode\u003E в качестве параметра в \u003Ccode\u003Efile_get_contents()\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$url = 'https:\u002F\u002Fapi.twitter.com\u002F1\u002Fstatuses\u002Fpublic_timeline.json';\n$contextOptions = array(\n    'ssl' =\u003E array()\n);\n$sslContext = stream_context_create($contextOptions);\n$result = file_get_contents($url, NULL, $sslContext);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак говорилось выше, если вы неправильно сконфигурируете SSL\u002FTLS, то приложение будет беззащитно перед атаками «человек посередине». PHP-потоки по умолчанию совершенно небезопасны при работе через SSL\u002FTLS. Так что давайте исправим наш пример, чтобы он стал полностью безопасен.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$url = 'https:\u002F\u002Fapi.twitter.com\u002F1\u002Fstatuses\u002Fpublic_timeline.json';\n$contextOptions = array(\n    'ssl' =\u003E array(\n        'verify_peer'   =\u003E true,\n        'cafile'        =\u003E '\u002Fetc\u002Fssl\u002Fcerts\u002Fca-certificates.crt',\n        'verify_depth'  =\u003E 5,\n        'CN_match'      =\u003E 'api.twitter.com',\n        'disable_compression' =\u003E true,\n        'SNI_enabled'         =\u003E true,\n        'ciphers'             =\u003E 'ALL!EXPORT!EXPORT40!EXPORT56!aNULL!LOW!RC4'\n    )\n);\n$sslContext = stream_context_create($contextOptions);\n$result = file_get_contents($url, NULL, $sslContext);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь всё в порядке! Если сравнить с предыдущей версией, то вы заметите, что мы настроили четыре опции, которые изначально были не настроены или отключены PHP. Давайте разберёмся, что они делают.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Everify_peer\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПроверка пира (Peer Verification) — проверка достоверности SSL-сертификата, предоставленного хостом, на который мы отправили HTTPS-запрос. Правильный сертификат подписан закрытым ключом надёжного удостоверяющего центра (Certificate Authority, CA). Проверку можно выполнить с помощью открытого ключа CA, который включается в файловый набор в виде опции \u003Ccode\u003Ecafile\u003C\u002Fcode\u003E для используемого нами SSL Context. Кроме того, сертификат не должен быть просрочен.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Ecafile\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНастройка \u003Ccode\u003Ecafile\u003C\u002Fcode\u003E должна указывать на валидный файл, содержащий открытый ключ надёжного CA. В PHP это не делается автоматически, поэтому держите ключи в связанном файле специального формата (обычно PEM или CRT). Если вы не можете найти копию, то скачайте и спарсите из \u003Ca href=\"https:\u002F\u002Fcurl.haxx.se\u002Fca\u002Fcacert.pem\"\u003EMozilla VCS\u003C\u002Fa\u003E. Без этого файла невозможно проверить пир, и запрос не будет выполнен.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Everify_depth\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭта настройка задаёт максимально допустимое количество промежуточных издателей сертификатов, т. е. количество CA-сертификатов, которые могут использоваться при проверке исходного клиентского сертификата.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003ECN_match\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТри предыдущие опции относятся к проверке предоставляемого сервером сертификата. Однако они не помогают нам понять, валиден ли он запрашиваемому нами доменному имени или IP, т. е. части URL, относящейся к хосту. Чтобы выяснить, привязан ли сертификат к текущему домену\u002FIP, выполним проверку хоста (Host Verification). В PHP для этого нужно задать \u003Ccode\u003ECN_match\u003C\u002Fcode\u003E значение хоста (в SSL Context), включая поддомен, если есть. Пока задана эта опция, PHP будет выполнять внутреннюю проверку. Если же этого не делать, то во время атаки «человек посередине» злоумышленник может предоставить валидный сертификат, подписанный надёжным CA. Но сертификат будет валидным для домена, находящегося под контролем атакующего, а не для того домена, к которому вы хотели подключиться. Настройка опции \u003Ccode\u003ECN_match\u003C\u002Fcode\u003E поможет определить несовпадение сертификатов и приведёт к невыполнению HTTPS-запроса.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоскольку используемый злоумышленником валидный сертификат будет содержать идентификационную информацию атакующего (это условие его получения!), то имейте в виду, что подкованному злоумышленнику доступно любое количество валидных, подписанных CA сертификатов в комплекте с соответствующими закрытыми ключами. Они могли быть украдены у других компаний либо проскользнуть через проверку надёжных CA. Так это произошло в 2011 году, когда DigiNotor выпустил для \u003Ccode\u003Egoogle.com\u003C\u002Fcode\u003E сертификат для неизвестной стороны. Она использовала его для атак «человек посередине», преимущественно против иранских пользователей.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Edisable_compression\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭта опция появилась в PHP 5.4.13. Она нужна для защиты от атак CRIME и других атак с дополнением блоков наподобие BEAST. На момент написания этой части книги опция была доступна уже 10 месяцев. Потребовалось немало терпения, чтобы обнаружить практически единственный пример её использования в open source PHP.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003ESNI_enabled\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВключает поддержку указания имени сервера (Server Name Indication), когда любой одиночный IP может быть настроен для работы нескольких SSL-сертификатов, чтобы не ограничиваться одним сертификатом для всех сайтов или не HTTP-сервисов, хостящихся на этом IP.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eciphers\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭта настройка помогает отображать, какие шифры следует или не следует выбирать при установке SSL\u002FTLS-соединений. Список по умолчанию предоставляется расширением openssl. Он содержит небезопасные шифры, которые стоит отключить, если только вы не вынуждены их применять. Нижеприведённый список, использующий принятый в openssl синтаксис, был реализован cURL в январе 2014-го. Предложенный Mozilla альтернативный список может быть лучше, поскольку упор в нём сделан на полную безопасность пересылки (Perfect Forward Secrecy), это лучший практический подход. Список Mozilla длиннее:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003EECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:ECDHE-RSA-RC4-SHA:ECDHE-ECDSA-RC4-SHA:AES128:AES256:RC4-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!3DES:!MD5:!PSK\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"ogranicheniya\"\u003E\u003Cem\u003EОграничения\u003C\u002Fem\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКак описано выше, проверка предоставленного сервером сертификата на валидность для хоста, указанного в используемом вами URL, при атаке «человек посередине» не позволяет просто подсунуть любой валидный сертификат, купленный или полученный нелегально. Это один из четырёх неотъемлемых шагов, позволяющих сделать ваше соединение полностью безопасным.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСистема выполняет проверку благодаря параметру \u003Ccode\u003ECN_match\u003C\u002Fcode\u003E, объявляемому \u003Ccode\u003ESSL Context\u003C\u002Fcode\u003E в HTTPS-обёртке PHP. Но у него есть недостаток. На момент написания книги проверялось лишь общее наименование (Common Name, CN) SSL-сертификата, а валидность определяемого сертификатом поля «дополнительное имя субъекта» (Subject Alternative Name, SAN) не проверялась. SAN позволяет защищать несколько имён доменов с помощью одного SSL-сертификата, поэтому оно крайне важно и поддерживается всеми современными браузерами. А поскольку PHP пока что не поддерживает проверку SAN, то SSL\u002FTLS-подключения к домену, защищённому таким сертификатом, установлены не будут. Поддержка SAN появится в PHP с версии 5.6.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EC другой стороны, расширение cURL из коробки поддерживает SAN, так что его использование гораздо надёжнее и предпочтительнее по сравнению со встроенными в PHP HTTPS\u002FFTPS-обёртками. В связи с этим применение PHP-потоков с большой вероятностью может привести к ошибочному поведению, и нетерпеливые программисты просто отключат проверку хоста в целом, что крайне нежелательно делать.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"ssl-context-v-php-soketah\"\u003E\u003Cem\u003ESSL Context в PHP-сокетах\u003C\u002Fem\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМногие HTTP-клиенты в PHP предлагают и cURL-адаптер, и используемый по умолчанию PHP-сокет адаптер. Применение последнего по умолчанию говорит о том, что cURL — опциональное расширение, на практике его можно отключить.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EPHP-сокеты используют тот же ресурс \u003Ccode\u003ESSL Context\u003C\u002Fcode\u003E, что и PHP-потоки, поэтому здесь присутствуют те же проблемы и ограничения, что описаны выше. Побочный эффект: многие основные HTTP-клиенты, скорее всего, априори ненадёжны и менее безопасны, чем должны быть. Подобные клиентские библиотеки, когда это возможно, необходимо конфигурировать так, чтобы они использовали cURL-адаптер. Также проверяйте, чтобы клиенты не забывали применять правильный подход к обеспечению безопасности SSL\u002FTLS.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"dopolnitelnye-riski\"\u003E\u003Cem\u003EДополнительные риски\u003C\u002Fem\u003E\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"rasshirenie-curl\"\u003EРасширение cURL\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ отличие от PHP-потоков, расширение cURL лишь передаёт данные, в том числе HTTP-запросы. Также, в отличие от \u003Ccode\u003ESSL Context\u003C\u002Fcode\u003E потоков, cURL по умолчанию безопасно выполняет запросы через SSL\u002FTLS. Вам для этого ничего не нужно делать, если только оно не было скомпилировано без хранилища пакета CA-сертификатов (например, без файла cert.pem или ca-bundle.crt с сертификатами надёжных CA).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоскольку это не требует особого подхода, вы можете вызвать Twitter API — аналогично тому, как мы делали это раньше для SSL\u002FTLS с использованием PHP-потока. Минимум хлопот, и не надо беспокоиться о том, что вы забудете о каких-то опциях, которые откроют вас для атаки «человек посередине».\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$url = 'https:\u002F\u002Fapi.twitter.com\u002F1\u002Fstatuses\u002Fpublic_timeline.json';\n$req = curl_init($url);\ncurl_setopt($req, CURLOPT_RETURNTRANSFER, TRUE);\n$result = curl_exec($req);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоэтому для HTTPS-запросов рекомендую cURL. По умолчанию это безопасно, а PHP-потоки — наверняка нет. В противном случае просто используйте cURL, это избавит вас от головной боли. В конечном счёте cURL безопаснее, требует меньше кода и с меньшей вероятностью подвержен сбоям в безопасности SSL\u002FTLS по вине ошибок человека.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНа момент написания книги PHP 5.6 достиг версии alpha1. В финальном релизе появятся более безопасные значения по умолчанию для PHP-потоков и сокет-соединений через SSL\u002FTLS. Эти нововведения не будут портированы в PHP 5.3, 5.4 или 5.5. Поэтому программистам придётся сознательно внедрять безопасные настройки по умолчанию, пока PHP 5.6 не превратится в необходимый минимум.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКонечно, если расширение cURL было включено без настройки размещения пакета надёжных сертификатов, то вышеприведённый пример работать не будет. Для публично распространяемых библиотек нужно принудительно настраивать безопасное поведение:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode\u003E$url = 'https:\u002F\u002Fapi.twitter.com\u002F1\u002Fstatuses\u002Fpublic_timeline.json';\n$req = curl_init($url);\ncurl_setopt($req, CURLOPT_RETURNTRANSFER, TRUE);\n$result = curl_exec($req);\n\n\u002F**\n * Проверяет, является ли ошибка сбоем SSL, повторяет попытку с помощью пакета \n * CA-сертификатов, предполагая, что локальный сервер не сконфигурирован \n * для ext\u002Fcurl. Ошибка 77 ссылается на CURLE_SSL_CACERT_BADFILE, который \n * по какой-то причине не определён в качестве константы в мануале PHP.\n*\u002F\n$error = curl_errno($req);\nif ($error == CURLE_SSL_PEER_CERTIFICATE || $error == CURLE_SSL_CACERT\n|| $error == 77) {\n    curl_setopt($req, CURLOPT_CAINFO, __DIR__ . '\u002Fcert-bundle.crt');\n    $result = curl_exec($req);\n}\n\n\u002F**\n * Все последующие ошибки нельзя исправить без нарушения безопасности.\n * Поэтому не пытайтесь отключить SSL и попробовать снова ;).\n *\u002F\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСамая сложная часть, очевидно, распространение файла с пакетом сертификатов \u003Ccode\u003Ecert-bundle.crt\u003C\u002Fcode\u003E или \u003Ccode\u003Ecafile.pem\u003C\u002Fcode\u003E (имя файла варьируется в зависимости от источника!). Сертификат любого CA может быть в любое время аннулирован большинством браузеров в случае нарушения их безопасности или процессов рецензирования (peer review), так что долго не обновлять файл с сертификатами — не лучшая идея. Тем не менее самое очевидное решение — распространять копию файла с библиотекой или приложением, для которого он требуется.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли вы не можете строго контролировать обновление распространяемого пакета сертификатов или вам нужен инструмент, способный периодически выполнять за вас эту проверку, воспользуйтесь \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FEvanDotPro\u002FSslurp\"\u003ESslurp\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"ssltls-soedineniya-so-storony-klienta-klientbrauzer-server\"\u003ESSL\u002FTLS-соединения со стороны клиента (клиент\u002Fбраузер-сервер)\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EБольшая часть того, о чём мы говорили до этого, была связана с SSL\u002FTLS-соединениями, устанавливаемыми с другим сервером по инициативе PHP веб-приложения. Конечно, есть ещё ряд проблем в безопасности, когда приложение оказывает SSL\u002FTLS-поддержку клиентским браузерам и другим приложениям. Здесь возникает риск атак, связанных с уязвимостями защиты на транспортном уровне.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли вдуматься, то всё это довольно просто. Скажем, я создаю онлайн-приложение, обеспечивающее защиту при вводе пользовательского пароля. Форма авторизации обслуживается через HTTPS, и данные из неё тоже передаются через HTTPS. Миссия выполнена. Чтобы начать работу в своём аккаунте, пользователь был перенаправлен на HTTP URL. Заметили проблему?\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКогда есть угроза атаки «человек посередине», мы не должны просто защищать форму авторизации, а потом её закрывать. Куки пользовательских сессий и все вводимые данные, а также весь получаемый пользователями HTML-код не будут в безопасности при работе через HTTP. Злоумышленник может украсть куки и выдать себя за пользователя, может внедрить XSS-код в получаемые пользователями страницы для выполнения задач от лица пользователей или управления их действиями. И для всего этого не нужны пользовательские пароли.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОдна лишь защита процесса аутентификации с помощью HTTPS предотвратит прямую кражу пароля, но не защитит от перехвата сессии, других форм кражи данных, а также от внедрения кода для XSS-атак. Защищая с помощью HTTPS одного лишь пользователя, мы обеспечиваем недостаточную защиту на транспортном уровне. Наши пользователи остаются уязвимы к атакам «человек посередине».\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"php"},{"titleHtml":"security"},{"titleHtml":"никто не читает теги"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F352444\u002F4d0fa5fc775afbef19e9400920a6fdb5\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F352444\u002F4d0fa5fc775afbef19e9400920a6fdb5\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fvk\\\u002Fblog\\\u002F352444\\\u002F\"},\"headline\":\"Книга Безопасность в PHP (часть 4). Недостаток безопасности на транспортном уровне (HTTPS, TLS и SSL)\",\"datePublished\":\"2018-04-13T12:36:49+03:00\",\"dateModified\":\"2018-04-13T15:56:54+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Макс\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Книга &laquo;Безопасность в PHP&raquo; (часть 1) Книга &laquo;Безопасность в PHP&raquo; (часть 2) Книга &laquo;Безопасность в PHP&raquo; (часть 3) Связь через интернет между участниками процесса с...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fvk\\\u002Fblog\\\u002F352444\\\u002F#post-content-body\",\"about\":[\"c_vk\",\"h_infosecurity\",\"h_php\",\"h_programming\",\"h_analysis_design\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F352444\\\u002F4d0fa5fc775afbef19e9400920a6fdb5\\\u002F\"]}","metaDescription":"Книга «Безопасность в PHP» (часть 1)\r\nКнига «Безопасность в PHP» (часть 2)\r\nКнига «Безопасность в PHP» (часть 3)\r\nСвязь через интернет между участниками процесса сопряжена с рисками. Когда вы...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"vk":{"alias":"vk","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F9ed\u002Fc74\u002F6b4\u002F9edc746b484c805ecad1f941b5f7068a.png","titleHtml":"VK","descriptionHtml":"Технологии, которые объединяют","relatedData":null,"statistics":{"postsCount":2278,"newsCount":165,"vacanciesCount":122,"employeesCount":700,"careerRating":4.35,"subscribersCount":134521,"rating":266.34,"invest":null},"foundationDate":{"year":"1998","month":"10","day":"15"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fvk.com\u002Fvkteam","staffNumber":"5 001–10 000 человек","registrationDate":"2008-08-09T07:42:32+00:00","representativeUser":{"alias":"AnastasiaGutor","fullname":"Анастасия Гутор"},"contacts":[{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002Finsidevk"},{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002Finside_vk"},{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Finsidevk"},{"title":"Instagram","url":"https:\u002F\u002Finstagram.com\u002Finside.vk"},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Finside_vk"}],"settings":{"analyticsSettings":[{"type":"ga","trackingId":"UA-16546458-6"}],"branding":{"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fbranding\u002F174\u002F2c4\u002F3a5\u002F1742c43a5b504987a0fadf577a0bd4de.png","linkUrl":"https:\u002F\u002Fvk.com\u002Fvkteam","pixelUrl":null},"status":"active","isStartup":false},"metadata":{"titleHtml":"VK, Москва - Технологии, которые объединяют с 15 октября 1998 г.","title":"VK, Москва - Технологии, которые объединяют с 15 октября 1998 г.","keywords":["DevOps","Облачные вычисления","Облачные сервисы","Kubernetes","Программирование","mail.ru","никто не читает теги","mail.ru cloud solutions","tarantool","mail.ru group","python","kubernetes","geekbrains","php","продуктовый дизайн","разработка","пользовательские интерфейсы","javascript","вконтакте","meetup","machine learning","машинное обучение","go","devops","android"],"descriptionHtml":"2 278 статей от авторов компании VK","description":"2 278 статей от авторов компании VK"},"aDeskSettings":null,"careerAlias":"vk"}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"technotext":{"nominationsList":[]},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.da6c6b36.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.92df6f6d.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="https://habr.com/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
