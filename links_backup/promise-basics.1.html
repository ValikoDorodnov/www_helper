<!DOCTYPE html><html lang="ru" data-theme-enabled="1"><head><script>window.currentUser = null;</script><script>window.rateUsdToNative = 98.8745;</script><title itemprop="name">Промисы</title><link href="https://learn.javascript.ru/pack/styles.151c2ad2b575d09af8f5.css" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><!-- chrome autotranslate is enabled only for "en" main version--><meta name="google" content="notranslate"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="https://fonts.googleapis.com/css?family=Open+Sans:bold,italic,bolditalic" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="https://learn.javascript.ru/img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="promise-basics.1.html"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><link rel="icon" href="https://learn.javascript.ru/img/favicon/favicon.png"><meta itemprop="image" content="https://learn.javascript.ru/img/site_preview_ru_512x512.png"><meta property="og:title" content="Промисы"><meta property="og:image" content="https://learn.javascript.ru/img/site_preview_ru_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Промисы"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://learn.javascript.ru/img/site_preview_ru_512x512.png"><link rel="prev" href="https://learn.javascript.ru/callbacks"><link rel="next" href="https://learn.javascript.ru/promise-chaining"><script>window.GA_ID = "UA-2056213-16";</script><script>window.GTM_ID = 'GTM-WD2DZPG'</script><script>window.YANDEX_METRIKA_ID = 17649010;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.GTM_ID&&ga("require",GTM_ID),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var r=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),n=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+r+" "+n,exFatal:!0})});</script><script src="https://www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="https://mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6LfmLAEVAAAAAJMykMnf7aY8nkyTRmYi2ynx51R1";</script><script src="https://learn.javascript.ru/pack/init.f43ee4b37d6f76e4f838.js"></script><script src="https://learn.javascript.ru/pack/head.9546f64faccf13e736f6.js" defer></script><script>
function loadScript(src) {
  return new Promise(function(resolve, reject) {
    let script = document.createElement('script');
    script.src = src;

    script.onload = () => resolve(script);
    script.onerror = () => reject(new Error("Script load error: " + src));

    document.head.append(script);
  });
}
</script>
<meta property="og:title" content="Промисы"><meta property="og:type" content="article"><script src="https://learn.javascript.ru/pack/tutorial.f792acb067a354bc7904.js" defer></script><script src="https://learn.javascript.ru/pack/footer.440ca4f81c63a09affe0.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if IE]><div style="color:red;text-align:center">Извините, Internet Explorer не поддерживается, пожалуйста используйте более новый браузер.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><script>window.langs = [{"code":"ar","name":"Arabic"},{"code":"az","name":"Azerbaijani"},{"code":"bg","name":"Bulgarian"},{"code":"bn","name":"Bengali"},{"code":"bs","name":"Bosnian"},{"code":"ca","name":"Catalan"},{"code":"cs","name":"Czech"},{"code":"da","name":"Danish"},{"code":"de","name":"German"},{"code":"el","name":"Greek"},{"code":"en","name":"English"},{"code":"es","name":"Spanish"},{"code":"fa","name":"Persian (Farsi)"},{"code":"fi","name":"Finnish"},{"code":"fr","name":"French"},{"code":"he","name":"Hebrew"},{"code":"hi","name":"Hindi"},{"code":"hr","name":"Croatian"},{"code":"hu","name":"Hungarian"},{"code":"hy","name":"Armenian"},{"code":"id","name":"Indonesian"},{"code":"it","name":"Italian"},{"code":"ja","name":"Japanese"},{"code":"ka","name":"Georgian"},{"code":"kk","name":"Kazakh"},{"code":"km","name":"Central Khmer"},{"code":"ko","name":"Korean"},{"code":"lt","name":"Lithuanian"},{"code":"me","name":"Montenegrin"},{"code":"ml","name":"Malayalam"},{"code":"my","name":"Burmese"},{"code":"nl","name":"Dutch"},{"code":"no","name":"Norvegian"},{"code":"pa","name":"Punjabi"},{"code":"pl","name":"Polish"},{"code":"pt","name":"Portuguese"},{"code":"ro","name":"Romanian"},{"code":"ru","name":"Russian"},{"code":"si","name":"Sinhala"},{"code":"sk","name":"Slovak"},{"code":"sl","name":"Slovenian"},{"code":"sq","name":"Albanian"},{"code":"sr","name":"Serbian"},{"code":"ta","name":"Tamil"},{"code":"te","name":"Telugu"},{"code":"test","name":"Test"},{"code":"th","name":"Thai"},{"code":"tk","name":"Turkmen"},{"code":"tr","name":"Turkish"},{"code":"uk","name":"Ukrainian"},{"code":"ur","name":"Urdu"},{"code":"uz","name":"Uzbek"},{"code":"v2","name":"v2"},{"code":"vi","name":"Vietnamese"},{"code":"zh-hant","name":"Chinese Traditional"},{"code":"zh","name":"Chinese"}];</script><script>window.lang = "ru";</script><script>{let t=navigator.languages||[];t=t.map(t=>t.toLowerCase());let o,i,n=[];for(let o of window.langs)for(let i of t)if(i===o.code||i.startsWith(o.code+"-")){n.push(o);break}if(!o&&"ru"!=lang&&"en"!=lang){n.find(t=>"en"==t.code)&&(o=`\n            According to your browser headers, you know English. Please help to <a href="https://github.com/javascript-tutorial/${lang}.javascript.info#readme">translate the tutorial</a>.\n            Thank you!\n          `,i="notify-translate-tutorial-local")}if(o){let t=`<div class="notification notification_top notification_info sitetoolbar__notification" style="display:none" id="${i}">\n          <div class="notification__content">${o}</div>\n          <button class="notification__close" title="Close"></button>\n        </div>`;document.write(t),showTopNotification()}}</script><div class="sitetoolbar__content"><div class="sitetoolbar__lang-switcher"><button class="sitetoolbar__dropdown-button" data-dropdown-toggler>RU</button><div class="sitetoolbar__dropdown-wrap"><div class="sitetoolbar__dropdown-body"><div class="sitetoolbar__lang-switcher-body"><div class="supported-langs supported-langs_toolbar"><div class="supported-langs__container"><ul class="supported-langs__list" style="height:200px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://ar.javascript.info/promise-basics"><span class="supported-langs__brief">AR</span><span class="supported-langs__title">عربي</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://javascript.info/promise-basics"><span class="supported-langs__brief">EN</span><span class="supported-langs__title">English</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://es.javascript.info/promise-basics"><span class="supported-langs__brief">ES</span><span class="supported-langs__title">Español</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://fr.javascript.info/promise-basics"><span class="supported-langs__brief">FR</span><span class="supported-langs__title">Français</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://id.javascript.info/promise-basics"><span class="supported-langs__brief">ID</span><span class="supported-langs__title">Indonesia</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://it.javascript.info/promise-basics"><span class="supported-langs__brief">IT</span><span class="supported-langs__title">Italiano</span></a></li></ul><ul class="supported-langs__list" style="height:200px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://ja.javascript.info/promise-basics"><span class="supported-langs__brief">JA</span><span class="supported-langs__title">日本語</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://ko.javascript.info/promise-basics"><span class="supported-langs__brief">KO</span><span class="supported-langs__title">한국어</span></a></li><li class="supported-langs__item supported-langs__item_current"><a class="supported-langs__link" href="promise-basics.1.html"><span class="supported-langs__brief">RU</span><span class="supported-langs__title">Русский</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://tr.javascript.info/promise-basics"><span class="supported-langs__brief">TR</span><span class="supported-langs__title">Türkçe</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://uk.javascript.info/promise-basics"><span class="supported-langs__brief">UK</span><span class="supported-langs__title">Українська</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://zh.javascript.info/promise-basics"><span class="supported-langs__brief">ZH</span><span class="supported-langs__title">简体中文</span></a></li></ul></div><div class="supported-langs__text">Мы хотим сделать этот проект с открытым исходным кодом доступным для людей во всем мире. Пожалуйста, <a href="https://github.com/javascript-tutorial/translate" rel="noopener noreferrer" target="_blank">помогите нам перевести</a> это руководство на свой язык</div></div></div></div></div></div><div class="sitetoolbar__logo-wrap"><a class="sitetoolbar__link sitetoolbar__link_logo" href="https://learn.javascript.ru/"><img class="sitetoolbar__logo sitetoolbar__logo_normal" src="https://learn.javascript.ru/img/sitetoolbar__logo_ru.svg" width="171" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_normal sitetoolbar__logo_dark" src="https://learn.javascript.ru/img/sitetoolbar__logo_ru-white.svg" width="171" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_small" src="https://learn.javascript.ru/img/sitetoolbar__logo_small_ru.svg" width="80" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_small sitetoolbar__logo_dark" src="https://learn.javascript.ru/img/sitetoolbar__logo_small_ru-white.svg" width="80" alt="" role="presentation"/><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){let t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button class="sitetoolbar__nav-toggle" type="button"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"><li class="sitetoolbar__section sitetoolbar__section_current"><a class="sitetoolbar__link" href="https://learn.javascript.ru/">Учебник</a></li><li class="sitetoolbar__section"><a class="sitetoolbar__link" href="https://learn.javascript.ru/courses">Курсы</a></li><li class="sitetoolbar__section"><a class="sitetoolbar__link" href="https://javascript.ru/forum/">Форум</a></li><li class="sitetoolbar__section"><a class="sitetoolbar__link" href="https://learn.javascript.ru/quiz">Тесты знаний</a></li><li class="sitetoolbar__section sitetoolbar__section_dropdown"><button class="sitetoolbar__dropdown-button" data-dropdown-toggler>Скринкасты</button><div class="sitetoolbar__dropdown-wrap"><div class="sitetoolbar__dropdown-body"><ul class="sitetoolbar__dropdown-items"><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://learn.javascript.ru/screencast/nodejs">Node.js</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://learn.javascript.ru/screencast/webpack">Webpack</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://learn.javascript.ru/screencast/gulp">Gulp</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://learn.javascript.ru/screencast/react">React.js</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://learn.javascript.ru/screencast/angular">Angular</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://youtu.be/W4hoc24K93E?list=PLDyvV36pndZFHXjXuwA_NywNrVQO0aQqb">Git: курс</a></li><li class="sitetoolbar__dropdown-item"><a class="sitetoolbar__secondary-link sitetoolbar__dropdown-link" href="https://youtu.be/lHacJuru1bc?list=PLDyvV36pndZEB7kWWocU4QSn-G78LoaEE">Git: разное</a></li></ul></div></div></li></ul></nav><div class="sitetoolbar__book-wrap"><a class="buy-book-button" href="https://learn.javascript.ru/ebook"><span class="buy-book-button__extra-text">Купить</span>EPUB/PDF</a></div><div class="sitetoolbar__login-wrap"><button class="sitetoolbar__login sitetoolbar__login_unready" data-action-login></button></div><div class="sitetoolbar__theme-switcher"><div class="theme-changer"><label class="theme-changer__label" for="theme-changer-input" data-tooltip="Сменить тему оформления"><input class="theme-changer__input" type="checkbox" id="theme-changer-input" data-theme-changer="data-theme-changer"/><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span></label></div></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><button class="sitetoolbar__search-toggle" type="button"></button><form class="sitetoolbar__search" method="GET" action="https://learn.javascript.ru/search"><div class="sitetoolbar__search-input"><div class="text-input"><input class="text-input__control" name="query" placeholder="Искать на Javascript.ru" required="required" type="text"/></div><button class="sitetoolbar__find" type="submit">Найти</button></div></form></div></div></div><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><select class="tablet-menu__nav input-select input-select input-select_small" onchange="if(this.value) window.location.href=this.value"><option value="/" selected>Учебник</option><option value="/courses">Курсы</option><option value="https://javascript.ru/forum/">Форум</option><option value="/quiz">Тесты знаний</option></select></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><form class="tablet-menu-search" action="https://learn.javascript.ru/search/"><input class="tablet-menu-search__input" type="search" name="query" placeholder="Поиск в учебнике" required="required"/><button class="tablet-menu-search__button" type="submit" name="type" value="articles">Поиск</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a class="map" href="https://learn.javascript.ru/tutorial/map" data-action="tutorial-map"><span class="map__text">Карта учебника</span></a></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="theme-changer theme-changer_tablet-menu theme-changer_has-label"><label class="theme-changer__label" for="theme-changer-input-tablet" data-tooltip="Сменить тему оформления"><input class="theme-changer__input" type="checkbox" id="theme-changer-input-tablet" data-theme-changer="data-theme-changer"/><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span><span class="theme-changer__label-text theme-changer__label-text_light-theme">Светлая тема</span><span class="theme-changer__label-text theme-changer__label-text_dark-theme">Тёмная тема</span></label></div></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Поделиться</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a><a class="share share_vk" href="https://vkontakte.ru/share.php?url=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a></div></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><select class="tablet-menu__nav input-select input-select input-select_small" onchange="if(this.value) window.location.href=this.value"><option value="https://ar.javascript.info/promise-basics">عربي</option><option value="https://javascript.info/promise-basics">English</option><option value="https://es.javascript.info/promise-basics">Español</option><option value="https://fr.javascript.info/promise-basics">Français</option><option value="https://id.javascript.info/promise-basics">Indonesia</option><option value="https://it.javascript.info/promise-basics">Italiano</option><option value="https://ja.javascript.info/promise-basics">日本語</option><option value="https://ko.javascript.info/promise-basics">한국어</option><option value="https://learn.javascript.ru/promise-basics" selected>Русский</option><option value="https://tr.javascript.info/promise-basics">Türkçe</option><option value="https://uk.javascript.info/promise-basics">Українська</option><option value="https://zh.javascript.info/promise-basics">简体中文</option></select></div></div></div><progress class="tutorial-progress" data-sticky value="76" max="93" data-tooltip="Урок 76 из 93"></progress></div><div class="page page_sidebar_on page_inner_padding"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");let e=document.querySelector(".page-wrapper");e&&e.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")});</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><div class="main__header-group"><ol class="breadcrumbs"><li class="breadcrumbs__item breadcrumbs__item_home"><a class="breadcrumbs__link" href="https://learn.javascript.ru/"><span class="breadcrumbs__hidden-text">Учебник</span></a></li><li class="breadcrumbs__item" id="breadcrumb-1"><a class="breadcrumbs__link" href="https://learn.javascript.ru/js"><span>Язык JavaScript</span></a></li><li class="breadcrumbs__item" id="breadcrumb-2"><a class="breadcrumbs__link" href="https://learn.javascript.ru/async"><span>Промисы, async/await</span></a></li><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Учебник","item":"https://learn.javascript.ru/"},{"@type":"ListItem","position":2,"name":"Язык JavaScript","item":"https://learn.javascript.ru/js"},{"@type":"ListItem","position":3,"name":"Промисы, async/await","item":"https://learn.javascript.ru/async"}]}</script></ol><div class="updated-at" data-tooltip="Последнее обновление: 3-го февраля 2022"><div class="updated-at__content">3-го февраля 2022</div></div></div><h1 class="main__header-title">Промисы</h1></div></header><div class="content"><article class="formatted" itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Промисы"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>Представьте, что вы известный певец, которого фанаты постоянно донимают расспросами о предстоящем сингле.</p>
<p>Чтобы получить передышку, вы обещаете разослать им сингл, когда он будет выпущен. Вы даёте фанатам список, в который они могут записаться. Они могут оставить там свой e-mail, чтобы получить песню, как только она выйдет. И даже больше: если что-то пойдёт не так, например, в студии будет пожар и песню выпустить не выйдет, они также получат уведомление об этом.</p>
<p>Все счастливы! Вы счастливы, потому что вас больше не донимают фанаты, а фанаты могут больше не беспокоиться, что пропустят новый сингл.</p>
<p>Это аналогия из реальной жизни для ситуаций, с которыми мы часто сталкиваемся в программировании:</p>
<ol>
<li>Есть «создающий» код, который делает что-то, что занимает время. Например, загружает данные по сети. В нашей аналогии это – «певец».</li>
<li>Есть «потребляющий» код, который хочет получить результат «создающего» кода, когда он будет готов. Он может быть необходим более чем одной функции. Это – «фанаты».</li>
<li><code>Promise</code> (по англ. <code>promise</code>, будем называть такой объект «промис») – это специальный объект в JavaScript, который связывает «создающий» и «потребляющий» коды вместе. В терминах нашей аналогии – это «список для подписки». «Создающий» код может выполняться сколько потребуется, чтобы получить результат, а <em>промис</em> делает результат доступным для кода, который подписан на него, когда результат готов.</li>
</ol>
<p>Аналогия не совсем точна, потому что объект <code>Promise</code> в JavaScript гораздо сложнее простого списка подписок: он обладает дополнительными возможностями и ограничениями. Но для начала и такая аналогия хороша.</p>
<p>Синтаксис создания <code>Promise</code>:</p>
<div id="xm9un77zuv" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  // функция-исполнитель (executor)
  // &quot;певец&quot;
});</code></pre>
        </div>
      </div>
      
      </div><p>Функция, переданная в конструкцию <code>new Promise</code>, называется <em>исполнитель</em> (executor). Когда <code>Promise</code> создаётся, она запускается автоматически. Она должна содержать «создающий» код, который когда-нибудь создаст результат. В терминах нашей аналогии: <em>исполнитель</em> – это «певец».</p>
<p>Её аргументы <code>resolve</code> и <code>reject</code> – это колбэки, которые предоставляет сам JavaScript. Наш код – только внутри исполнителя.</p>
<p>Когда он получает результат, сейчас или позже – не важно, он должен вызвать один из этих колбэков:</p>
<ul>
<li><code>resolve(value)</code> — если работа завершилась успешно, с результатом <code>value</code>.</li>
<li><code>reject(error)</code> — если произошла ошибка, <code>error</code> – объект ошибки.</li>
</ul>
<p>Итак, исполнитель запускается автоматически, он должен выполнить работу, а затем вызвать <code>resolve</code> или <code>reject</code>.</p>
<p>У объекта <code>promise</code>, возвращаемого конструктором <code>new Promise</code>, есть внутренние свойства:</p>
<ul>
<li><code>state</code> («состояние») — вначале <code>&quot;pending&quot;</code> («ожидание»), потом меняется на  <code>&quot;fulfilled&quot;</code> («выполнено успешно») при вызове <code>resolve</code> или на <code>&quot;rejected&quot;</code> («выполнено с ошибкой») при вызове <code>reject</code>.</li>
<li><code>result</code> («результат») — вначале <code>undefined</code>, далее изменяется на <code>value</code> при вызове <code>resolve(value)</code> или на <code>error</code> при вызове <code>reject(error)</code>.</li>
</ul>
<p>Так что исполнитель по итогу переводит <code>promise</code> в одно из двух состояний:</p>
<figure><div class="image" style="width:512px">
      <div class="image__ratio" style="padding-top:48.046875%"></div>
      <object type="image/svg+xml" data="https://learn.javascript.ru/article/promise-basics/promise-resolve-reject.svg" width="512" height="246" class="image__image" data-use-theme>
        <img src="https://learn.javascript.ru/article/promise-basics/promise-resolve-reject.svg" alt="" width="512" height="246">
      </object>
      </div></figure><p>Позже мы рассмотрим, как «фанаты» узнают об этих изменениях.</p>
<p>Ниже пример конструктора <code>Promise</code> и простого исполнителя с кодом, дающим результат с задержкой (через <code>setTimeout</code>):</p>
<div id="i5jabkeu7r" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:4,&quot;cols&quot;:[{&quot;start&quot;:19,&quot;end&quot;:34}]}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  // эта функция выполнится автоматически, при вызове new Promise

  // через 1 секунду сигнализировать, что задача выполнена с результатом &quot;done&quot;
  setTimeout(() =&gt; resolve(&quot;done&quot;), 1000);
});</code></pre>
        </div>
      </div>
      
      </div><p>Мы можем наблюдать две вещи, запустив код выше:</p>
<ol>
<li>Функция-исполнитель запускается сразу же при вызове <code>new Promise</code>.</li>
<li>Исполнитель получает два аргумента: <code>resolve</code> и <code>reject</code> — это функции, встроенные в JavaScript, поэтому нам не нужно их писать. Нам нужно лишь позаботиться, чтобы исполнитель вызвал одну из них по готовности.</li>
</ol>
<p>Спустя одну секунду «обработки» исполнитель вызовет <code>resolve(&quot;done&quot;)</code>, чтобы передать результат:</p>
<figure><div class="image" style="width:538px">
      <div class="image__ratio" style="padding-top:19.702602230483272%"></div>
      <object type="image/svg+xml" data="https://learn.javascript.ru/article/promise-basics/promise-resolve-1.svg" width="538" height="106" class="image__image" data-use-theme>
        <img src="https://learn.javascript.ru/article/promise-basics/promise-resolve-1.svg" alt="" width="538" height="106">
      </object>
      </div></figure><p>Это был пример успешно выполненной задачи, в результате мы получили «успешно выполненный» промис.</p>
<p>А теперь пример, в котором исполнитель сообщит, что задача выполнена с ошибкой:</p>
<div id="4q4bbx9hdx" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:2,&quot;cols&quot;:[{&quot;start&quot;:19,&quot;end&quot;:47}]}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  // спустя одну секунду будет сообщено, что задача выполнена с ошибкой
  setTimeout(() =&gt; reject(new Error(&quot;Whoops!&quot;)), 1000);
});</code></pre>
        </div>
      </div>
      
      </div><figure><div class="image" style="width:535px">
      <div class="image__ratio" style="padding-top:19.813084112149532%"></div>
      <object type="image/svg+xml" data="https://learn.javascript.ru/article/promise-basics/promise-reject-1.svg" width="535" height="106" class="image__image" data-use-theme>
        <img src="https://learn.javascript.ru/article/promise-basics/promise-reject-1.svg" alt="" width="535" height="106">
      </object>
      </div></figure><p>Подведём промежуточные итоги: исполнитель выполняет задачу (что-то, что обычно требует времени), затем вызывает <code>resolve</code> или <code>reject</code>, чтобы изменить состояние соответствующего <code>Promise</code>.</p>
<p>Промис – и успешный, и отклонённый будем называть «завершённым», в отличие от изначального промиса «в ожидании».</p>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Может быть что-то одно: либо результат, либо ошибка</span></div>
            <div class="important__content"><p>Исполнитель должен вызвать что-то одно: <code>resolve</code> или <code>reject</code>. Состояние промиса может быть изменено только один раз.</p>
<p>Все последующие вызовы <code>resolve</code> и <code>reject</code> будут проигнорированы:</p>
<div id="l4637bqrxn" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:1,&quot;end&quot;:1}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  resolve(&quot;done&quot;);

  reject(new Error(&quot;…&quot;)); // игнорируется
  setTimeout(() =&gt; resolve(&quot;…&quot;)); // игнорируется
});</code></pre>
        </div>
      </div>
      
      </div><p>Идея в том, что задача, выполняемая исполнителем, может иметь только один итог: результат или ошибку.</p>
<p>Также заметим, что функция <code>resolve</code>/<code>reject</code> ожидает только один аргумент (или ни одного). Все дополнительные аргументы будут проигнорированы.</p>
</div></div>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Вызывайте <code>reject</code> с объектом <code>Error</code></span></div>
            <div class="important__content"><p>В случае, если что-то пошло не так, мы должны вызвать <code>reject</code>. Это можно сделать с аргументом любого типа (как и <code>resolve</code>), но рекомендуется использовать объект <code>Error</code> (или унаследованный от него). Почему так? Скоро нам станет понятно.</p>
</div></div>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Вызов <code>resolve</code>/<code>reject</code> сразу</span></div>
            <div class="important__content"><p>Обычно исполнитель делает что-то асинхронное и после этого вызывает <code>resolve</code>/<code>reject</code>, то есть через какое-то время. Но это не обязательно, <code>resolve</code> или <code>reject</code> могут быть вызваны сразу:</p>
<div id="52m2ugx7rw" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  // задача, не требующая времени
  resolve(123); // мгновенно выдаст результат: 123
});</code></pre>
        </div>
      </div>
      
      </div><p>Это может случиться, например, когда мы начали выполнять какую-то задачу, но тут же увидели, что ранее её уже выполняли, и результат закеширован.</p>
<p>Такая ситуация нормальна. Мы сразу получим успешно завершённый <code>Promise</code>.</p>
</div></div>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Свойства <code>state</code> и <code>result</code> – внутренние</span></div>
            <div class="important__content"><p>Свойства <code>state</code> и <code>result</code> – это внутренние свойства объекта <code>Promise</code> и мы не имеем к ним прямого доступа. Для обработки результата следует использовать методы <code>.then</code>/<code>.catch</code>/<code>.finally</code>, про них речь пойдёт дальше.</p>
</div></div>
<h2><a class="main__anchor" name="potrebiteli-then-catch-finally" href="promise-basics.1.html#potrebiteli-then-catch-finally">Потребители: then, catch, finally</a></h2><p>Объект <code>Promise</code> служит связующим звеном между исполнителем («создающим» кодом или «певцом») и функциями-потребителями («фанатами»), которые получат либо результат, либо ошибку. Функции-потребители могут быть зарегистрированы (подписаны) с помощью методов <code>.then</code>, <code>.catch</code> и <code>.finally</code>.</p>
<h3><a class="main__anchor" name="then" href="promise-basics.1.html#then">then</a></h3><p>Наиболее важный и фундаментальный метод – <code>.then</code>.</p>
<p>Синтаксис:</p>
<div id="rg17iwi1jg" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:2,&quot;cols&quot;:[{&quot;start&quot;:20,&quot;end&quot;:43}]},{&quot;start&quot;:1,&quot;cols&quot;:[{&quot;start&quot;:21,&quot;end&quot;:57}]}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>promise.then(
  function(result) { /* обработает успешное выполнение */ },
  function(error) { /* обработает ошибку */ }
);</code></pre>
        </div>
      </div>
      
      </div><p>Первый аргумент метода <code>.then</code> – функция, которая выполняется, когда промис переходит в состояние «выполнен успешно», и получает результат.</p>
<p>Второй аргумент <code>.then</code>  – функция, которая выполняется, когда промис переходит в состояние «выполнен с ошибкой», и получает ошибку.</p>
<p>Например, вот реакция на успешно выполненный промис:</p>
<div id="66y3g34ioq" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:6,&quot;end&quot;:6}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  setTimeout(() =&gt; resolve(&quot;done!&quot;), 1000);
});

// resolve запустит первую функцию, переданную в .then
promise.then(
  result =&gt; alert(result), // выведет &quot;done!&quot; через одну секунду
  error =&gt; alert(error) // не будет запущена
);</code></pre>
        </div>
      </div>
      
      </div><p>Выполнилась первая функция.</p>
<p>А в случае ошибки в промисе – выполнится вторая:</p>
<div id="lz7u8hemo6" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:7,&quot;end&quot;:7}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  setTimeout(() =&gt; reject(new Error(&quot;Whoops!&quot;)), 1000);
});

// reject запустит вторую функцию, переданную в .then
promise.then(
  result =&gt; alert(result), // не будет запущена
  error =&gt; alert(error) // выведет &quot;Error: Whoops!&quot; спустя одну секунду
);</code></pre>
        </div>
      </div>
      
      </div><p>Если мы заинтересованы только в результате успешного выполнения задачи, то в <code>then</code> можно передать только одну функцию:</p>
<div id="pao4jzo0k4" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:4,&quot;end&quot;:4}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(resolve =&gt; {
  setTimeout(() =&gt; resolve(&quot;done!&quot;), 1000);
});

promise.then(alert); // выведет &quot;done!&quot; спустя одну секунду</code></pre>
        </div>
      </div>
      
      </div><h3><a class="main__anchor" name="catch" href="promise-basics.1.html#catch">catch</a></h3><p>Если мы хотели бы только обработать ошибку, то можно использовать <code>null</code> в качестве первого аргумента: <code>.then(null, errorHandlingFunction)</code>. Или можно воспользоваться методом <code>.catch(errorHandlingFunction)</code>, который сделает то же самое:</p>
<div id="urqnlv83i6" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:4,&quot;end&quot;:5}]">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; reject(new Error(&quot;Ошибка!&quot;)), 1000);
});

// .catch(f) это то же самое, что promise.then(null, f)
promise.catch(alert); // выведет &quot;Error: Ошибка!&quot; спустя одну секунду</code></pre>
        </div>
      </div>
      
      </div><p>Вызов <code>.catch(f)</code> – это сокращённый, «укороченный» вариант  <code>.then(null, f)</code>.</p>
<h3><a class="main__anchor" name="finally" href="promise-basics.1.html#finally">finally</a></h3><p>По аналогии с блоком <code>finally</code> из обычного <code>try {...} catch {...}</code>, у промисов также есть метод <code>finally</code>.</p>
<p>Вызов <code>.finally(f)</code> похож на <code>.then(f, f)</code>, в том смысле, что <code>f</code> выполнится в любом случае, когда промис завершится: успешно или с ошибкой.</p>
<p><code>finally</code> хорошо подходит для очистки, например остановки индикатора загрузки, его ведь нужно остановить вне зависимости от результата.</p>
<p>Например:</p>
<div id="m1luzkf32p" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:3,&quot;end&quot;:4}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>new Promise((resolve, reject) =&gt; {
  /* сделать что-то, что займёт время, и после вызвать resolve/reject */
})
  // выполнится, когда промис завершится, независимо от того, успешно или нет
  .finally(() =&gt; остановить индикатор загрузки)
  .then(result =&gt; показать результат, err =&gt; показать ошибку)</code></pre>
        </div>
      </div>
      
      </div><p>Но это не совсем псевдоним <code>then(f,f)</code>, как можно было подумать. Существует несколько важных отличий:</p>
<ol>
<li>
<p>Обработчик, вызываемый из <code>finally</code>, не имеет аргументов. В <code>finally</code> мы не знаем, как был завершён промис. И это нормально, потому что обычно наша задача – выполнить «общие» завершающие процедуры.</p>
</li>
<li>
<p>Обработчик <code>finally</code> «пропускает» результат или ошибку дальше, к последующим обработчикам.</p>
<p>Например, здесь результат проходит через <code>finally</code> к <code>then</code>:</p>
<div id="vsrawsy4zr" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; resolve(&quot;result&quot;), 2000)
})
  .finally(() =&gt; alert(&quot;Промис завершён&quot;))
  .then(result =&gt; alert(result)); // &lt;-- .then обработает результат</code></pre>
        </div>
      </div>
      
      </div><p>А здесь ошибка из промиса проходит через <code>finally</code> к <code>catch</code>:</p>
<div id="6n1c9rta3z" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>new Promise((resolve, reject) =&gt; {
  throw new Error(&quot;error&quot;);
})
  .finally(() =&gt; alert(&quot;Промис завершён&quot;))
  .catch(err =&gt; alert(err));  // &lt;-- .catch обработает объект ошибки</code></pre>
        </div>
      </div>
      
      </div><p>Это очень удобно, потому что <code>finally</code> не предназначен для обработки результата промиса. Так что он просто пропускает его через себя дальше.</p>
<p>Мы более подробно поговорим о создании цепочек промисов и передаче результатов между обработчиками в следующей главе.</p>
</li>
<li>
<p>Последнее, но не менее значимое: вызов <code>.finally(f)</code> удобнее, чем <code>.then(f, f)</code> – не надо дублировать функции f.</p>
</li>
</ol>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">На завершённых промисах обработчики запускаются сразу</span></div>
            <div class="important__content"><p>Если промис в состоянии ожидания, обработчики в <code>.then/catch/finally</code> будут ждать его. Однако, если промис уже завершён, то обработчики выполнятся сразу:</p>
<div id="xbmq5tflb6" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>// при создании промиса он сразу переводится в состояние &quot;успешно завершён&quot;
let promise = new Promise(resolve =&gt; resolve(&quot;готово!&quot;));

promise.then(alert); // готово! (выведется сразу)</code></pre>
        </div>
      </div>
      
      </div></div></div>
<p>Теперь рассмотрим несколько практических примеров того, как промисы могут облегчить нам написание асинхронного кода.</p>
<h2><a class="main__anchor" name="loadscript" href="promise-basics.1.html#loadscript">Пример: loadScript</a></h2><p>У нас есть функция <code>loadScript</code> для загрузки скрипта из предыдущей главы.</p>
<p>Давайте вспомним, как выглядел вариант с колбэками:</p>
<div id="7ypbofy40p" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>function loadScript(src, callback) {
  let script = document.createElement('script');
  script.src = src;

  script.onload = () =&gt; callback(null, script);
  script.onerror = () =&gt; callback(new Error(`Ошибка загрузки скрипта ${src}`));

  document.head.append(script);
}</code></pre>
        </div>
      </div>
      
      </div><p>Теперь перепишем её, используя <code>Promise</code>.</p>
<p>Новой функции <code>loadScript</code> более не нужен аргумент <code>callback</code>. Вместо этого она будет создавать и возвращать объект <code>Promise</code>, который перейдет в состояние «успешно завершён», когда загрузка закончится. Внешний код может добавлять обработчики («подписчиков»), используя <code>.then</code>:</p>
<div id="eu4qax5cqh" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>function loadScript(src) {
  return new Promise(function(resolve, reject) {
    let script = document.createElement('script');
    script.src = src;

    script.onload = () =&gt; resolve(script);
    script.onerror = () =&gt; reject(new Error(`Ошибка загрузки скрипта ${src}`));

    document.head.append(script);
  });
}</code></pre>
        </div>
      </div>
      
      </div><p>Применение:</p>
<div id="twr6mlq2qr" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = loadScript(&quot;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.js&quot;);

promise.then(
  script =&gt; alert(`${script.src} загружен!`),
  error =&gt; alert(`Ошибка: ${error.message}`)
);

promise.then(script =&gt; alert('Ещё один обработчик...'));</code></pre>
        </div>
      </div>
      
      </div><p>Сразу заметно несколько преимуществ перед подходом с использованием колбэков:</p>
<table>
<thead>
<tr>
<th>Промисы</th>
<th>Колбэки</th>
</tr>
</thead>
<tbody>
<tr>
<td>Промисы позволяют делать вещи в естественном порядке. Сперва мы запускаем <code>loadScript(script)</code>, и затем (<code>.then</code>) мы пишем, что делать с результатом.</td>
<td>У нас должна быть функция<code>callback</code> на момент вызова <code>loadScript(script, callback)</code>. Другими словами, нам нужно знать что делать с результатом <em>до того</em>, как вызовется <code>loadScript</code>.</td>
</tr>
<tr>
<td>Мы можем вызывать <code>.then</code> у <code>Promise</code> столько раз, сколько захотим. Каждый раз мы добавляем нового «фаната», новую функцию-подписчика в «список подписок». Больше об этом в следующей главе: <a href="https://learn.javascript.ru/promise-chaining">Цепочка промисов</a>.</td>
<td>Колбэк может быть только один.</td>
</tr>
</tbody>
</table>
<p>Таким образом, промисы позволяют улучшить порядок кода и дают нам гибкость. Но это далеко не всё. Мы узнаем ещё много полезного в последующих главах.</p>
</div></article><div class="tasks formatted"><h2 class="tasks__title" id="tasks"><a class="tasks__title-anchor main__anchor main__anchor main__anchor_noicon" href="promise-basics.1.html#tasks">Задачи</a></h2><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a class="main__anchor" href="promise-basics.1.html#mozhno-li-perevypolnit-promis" name="mozhno-li-perevypolnit-promis">Можно ли &quot;перевыполнить&quot; промис?</a></h3><a class="task__open-link" href="https://learn.javascript.ru/task/re-resolve" target="_blank"></a></div><div class="task__header-note"></div><div class="task__content"><div class="task__formatted"><p>Что выведет код ниже?</p>
<div id="fbl8fs6u6l" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let promise = new Promise(function(resolve, reject) {
  resolve(1);

  setTimeout(() =&gt; resolve(2), 1000);
});

promise.then(alert);</code></pre>
        </div>
      </div>
      
      </div></div><button class="task__solution" type="button">решение</button><div class="task__answer"><div class="task__answer-content"><div class="formatted"><p>Вывод будет: <code>1</code>.</p>
<p>Второй вызов <code>resolve</code> будет проигнорирован, поскольку учитывается только первый вызов <code>reject/resolve</code>. Все последующие вызовы – игнорируются.</p>
</div></div><button class="close-button task__answer-close" type="button" title="закрыть"></button></div></div></div></div><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a class="main__anchor" href="promise-basics.1.html#zaderzhka-na-promisah" name="zaderzhka-na-promisah">Задержка на промисах</a></h3><a class="task__open-link" href="https://learn.javascript.ru/task/delay-promise" target="_blank"></a></div><div class="task__header-note"></div><div class="task__content"><div class="task__formatted"><p>Встроенная функция <code>setTimeout</code> использует колбэк-функции. Создайте альтернативу, использующую промисы.</p>
<p>Функция <code>delay(ms)</code> должна возвращать промис, который перейдёт в состояние «выполнен» через <code>ms</code> миллисекунд, так чтобы мы могли добавить к нему <code>.then</code>:</p>
<div id="8khr8j42t7" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>function delay(ms) {
  // ваш код
}

delay(3000).then(() =&gt; alert('выполнилось через 3 секунды'));</code></pre>
        </div>
      </div>
      
      </div></div><button class="task__solution" type="button">решение</button><div class="task__answer"><div class="task__answer-content"><div class="formatted"><div id="t6xp3vku8d" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="выполнить" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="promise-basics.1.html#" title="открыть в песочнице" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>function delay(ms) {
  return new Promise(resolve =&gt; setTimeout(resolve, ms));
}

delay(3000).then(() =&gt; alert('выполнилось через 3 секунды'));</code></pre>
        </div>
      </div>
      
      </div><p>Заметьте, что <code>resolve</code> вызывается без аргументов. Мы не возвращаем из <code>delay</code> ничего, просто гарантируем задержку.</p>
</div></div><button class="close-button task__answer-close" type="button" title="закрыть"></button></div></div></div></div><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a class="main__anchor" href="promise-basics.1.html#animatsiya-kruga-s-pomoschyu-promisa" name="animatsiya-kruga-s-pomoschyu-promisa">Анимация круга с помощью промиса</a></h3><a class="task__open-link" href="https://learn.javascript.ru/task/animate-circle-promise" target="_blank"></a></div><div class="task__header-note"></div><div class="task__content"><div class="task__formatted"><p>Перепишите функцию <code>showCircle</code>, написанную в задании <a href="https://learn.javascript.ru/task/animate-circle-callback">Анимация круга с помощью колбэка</a> таким образом, чтобы она возвращала промис, вместо того чтобы принимать в аргументы функцию-callback.</p>
<p>Новое использование:</p>
<div id="23835meh63" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>showCircle(150, 150, 100).then(div =&gt; {
  div.classList.add('message-ball');
  div.append(&quot;Hello, world!&quot;);
});</code></pre>
        </div>
      </div>
      
      </div><p>Возьмите решение из <a href="https://learn.javascript.ru/task/animate-circle-callback">Анимация круга с помощью колбэка</a> в качестве основы.</p>
</div><button class="task__solution" type="button">решение</button><div class="task__answer"><div class="task__answer-content"><div class="formatted"><p><a href="https://plnkr.co/edit/ORCVfFzWSpCUYYv1?p=preview" target="_blank" data-plunk-id="ORCVfFzWSpCUYYv1">Открыть решение в песочнице.</a></p></div></div><button class="close-button task__answer-close" type="button" title="закрыть"></button></div></div></div></div></div></div><div class="page__nav-wrap"><a class="page__nav page__nav_prev" href="https://learn.javascript.ru/callbacks" data-tooltip="Введение: колбэки"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Предыдущий урок</span></a><a class="page__nav page__nav_next" href="https://learn.javascript.ru/promise-chaining" data-tooltip="Цепочка промисов"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Следующий урок</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Поделиться</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a><a class="share share_vk" href="https://vkontakte.ru/share.php?url=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a></div><div class="article-tablet-foot__map"><a class="map" href="https://learn.javascript.ru/tutorial/map" data-action="tutorial-map"><span class="map__text">Карта учебника</span></a></div></div></div><div class="banner-bottom"><div class="banner-bottom__text">Проводим <a href="https://learn.javascript.ru/courses">курсы по JavaScript и фреймворкам</a>.</div><button class="banner-bottom__close" data-banner-close="Courses" data-banner-close-message="Эта информация больше не будет выводиться." title="не показывать"></button></div><script>!!1&&"hideBannerCourses"in localStorage||(document.querySelector(".banner-bottom").style.display="flex");</script><div class="comments formatted" id="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="promise-basics.1.html#comments" name="comments">Комментарии</a></h2><div class="comments__read-before"><span class="comments__read-before-link">перед тем как писать…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>Если вам кажется, что в статье что-то не так - вместо комментария напишите <a href="https://github.com/javascript-tutorial/ru.javascript.info/issues/new">на GitHub</a>.</li><li>Для одной строки кода используйте тег <code>&lt;code&gt;</code>, для нескольких строк кода&nbsp;&mdash; тег <code>&lt;pre&gt;</code>, если больше 10 строк&nbsp;&mdash; ссылку на песочницу (<a href='https://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='http://jsbin.com'>JSBin</a>, <a href='http://codepen.io'>codepen</a>…)</li><li>Если что-то непонятно в статье&nbsp;&mdash; пишите, что именно и с какого места.</li></ul></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/learn.javascript.ru\/promise-basics","identifier":"\/promise-basics"}); };</script><script>var disqus_shortname = "learnjavascriptru";</script><script>var disqus_enabled = true;</script></div></main></div><div class="sidebar page__sidebar sidebar sidebar_sticky-footer"><button class="sidebar__toggle" data-sidebar-toggle></button><a class="map" href="https://learn.javascript.ru/tutorial/map" data-action="tutorial-map" data-tooltip="Карта учебника"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Раздел</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="https://learn.javascript.ru/async">Промисы, async/await</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Навигация по уроку</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="promise-basics.1.html#potrebiteli-then-catch-finally">Потребители: then, catch, finally</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="promise-basics.1.html#loadscript">Пример: loadScript</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="promise-basics.1.html#tasks">Задачи (3)</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="promise-basics.1.html#comments">Комментарии</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Поделиться</div><a class="share share_tw sidebar__share" href="https://twitter.com/share?url=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a><a class="share share_fb sidebar__share" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Flearn.javascript.ru%2Fpromise-basics" rel="nofollow"></a></div><div class="sidebar__section"><a class="sidebar__link" href="https://github.com/javascript-tutorial/ru.javascript.info/blob/master/1-js/11-async/02-promise-basics" rel="nofollow">Редактировать на GitHub</a></div></div></div></div></div></div><div class="page-footer"><ul class="page-footer__list"><li class="page-footer__item page-footer__item_copy">©&nbsp;2007—2022&nbsp; Илья Кантор</li><li class="page-footer__item page-footer__item_about"><a class="page-footer__link" href="https://learn.javascript.ru/about">о проекте</a></li><li class="page-footer__item page-footer__item_contact"><a class="page-footer__link" href="https://learn.javascript.ru/about#contact-us">связаться с нами</a></li><li class="page-footer__item page-footer__item_terms"><a class="page-footer__link" href="https://learn.javascript.ru/terms">пользовательское соглашение</a></li><li class="page-footer__item page-footer__item_privacy"><a class="page-footer__link" href="https://learn.javascript.ru/privacy">политика конфиденциальности</a></li><li class="page-footer__item page-footer__item_slack"><a class="page-footer__slack" href="http://slack.javascript.ru">slack-чат</a></li></ul></div></body></html>